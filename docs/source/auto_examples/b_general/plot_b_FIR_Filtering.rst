
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/b_general/plot_b_FIR_Filtering.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_b_general_plot_b_FIR_Filtering.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_b_general_plot_b_FIR_Filtering.py:


===============================
Digital Estimator as FIR Filter
===============================

We demonstrate how to set up the FIR filter implementation.

.. GENERATED FROM PYTHON SOURCE LINES 10-17

---------------------------------------
Analog System and Digital Control Setup
---------------------------------------

To initialize a digital estimator, we need to specify which analog system and
digital control are used. Here we default to the chain-of-integrators
example.

.. GENERATED FROM PYTHON SOURCE LINES 17-50

.. code-block:: default
   :lineno-start: 18


    from cbadc.analog_system import AnalogSystem
    from cbadc.digital_control import DigitalControl
    from cbadc.digital_estimator import DigitalEstimator
    import numpy as np
    N = 6
    M = N
    beta = 6250.
    rho = - beta * 1e-2
    A = [[rho, 0, 0, 0, 0, 0],
         [beta, rho, 0, 0, 0, 0],
         [0, beta, rho, 0, 0, 0],
         [0, 0, beta, rho, 0, 0],
         [0, 0, 0, beta, rho, 0],
         [0, 0, 0, 0, beta, rho]]
    B = [[beta], [0], [0], [0], [0], [0]]
    CT = np.eye(N)
    Gamma = [[-beta, 0, 0, 0, 0, 0],
             [0, -beta, 0, 0, 0, 0],
             [0, 0, -beta, 0, 0, 0],
             [0, 0, 0, -beta, 0, 0],
             [0, 0, 0, 0, -beta, 0],
             [0, 0, 0, 0, 0, -beta]]
    Gamma_tildeT = CT
    T = 1.0/(2 * beta)

    analog_system = AnalogSystem(A, B, CT, Gamma, Gamma_tildeT)
    digital_control = DigitalControl(T, M)

    # Summarize the analog system, digital control, and digital estimator.
    print(analog_system, "\n")
    print(digital_control)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    The analog system is parameterized as:
    A =
    [[ -62.5    0.     0.     0.     0.     0. ]
     [6250.   -62.5    0.     0.     0.     0. ]
     [   0.  6250.   -62.5    0.     0.     0. ]
     [   0.     0.  6250.   -62.5    0.     0. ]
     [   0.     0.     0.  6250.   -62.5    0. ]
     [   0.     0.     0.     0.  6250.   -62.5]],
    B =
    [[6250.]
     [   0.]
     [   0.]
     [   0.]
     [   0.]
     [   0.]],
    CT = 
    [[1. 0. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0. 0.]
     [0. 0. 1. 0. 0. 0.]
     [0. 0. 0. 1. 0. 0.]
     [0. 0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 0. 1.]],
    Gamma =
    [[-6250.     0.     0.     0.     0.     0.]
     [    0. -6250.     0.     0.     0.     0.]
     [    0.     0. -6250.     0.     0.     0.]
     [    0.     0.     0. -6250.     0.     0.]
     [    0.     0.     0.     0. -6250.     0.]
     [    0.     0.     0.     0.     0. -6250.]],
    and Gamma_tildeT =
    [[1. 0. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0. 0.]
     [0. 0. 1. 0. 0. 0.]
     [0. 0. 0. 1. 0. 0.]
     [0. 0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 0. 1.]] 

    The Digital Control is parameterized as:
    T = 8e-05,
    M = 6, and next update at
    t = 8e-05




.. GENERATED FROM PYTHON SOURCE LINES 51-61

----------------
Impulse Response
----------------

Next we instantiate a :py:class:`cbadc.digital_estimator.FIRFilter` and
visualize its impulse responses.

Note that we will also use use the control signal sequence that we previously
simulated in
:doc:`../a_getting_started/plot_b_simulate_a_control_bounded_adc`.

.. GENERATED FROM PYTHON SOURCE LINES 61-102

.. code-block:: default
   :lineno-start: 61

    import matplotlib.pyplot as plt
    from cbadc.utilities import read_byte_stream_from_file, byte_stream_2_control_signal
    from cbadc.digital_estimator import FIRFilter

    # Choose an arbitrary eta2
    eta2 = 1e6

    # Load the control signal from previous simulation
    byte_stream = read_byte_stream_from_file('sinusodial_simulation.adc', M)
    control_signal_sequences = byte_stream_2_control_signal(byte_stream, M)


    # Instantiate digital estimator
    K1 = 250
    K2 = 250
    digital_estimator = FIRFilter(
        control_signal_sequences, analog_system, digital_control, eta2, K1, K2)

    # extract impulse response
    impulse_response = np.abs(np.array(digital_estimator.h[:, 0, :]))
    impulse_response_dB = 20 * np.log10(impulse_response)

    # Visualize the impulse response
    h_index = np.arange(-K1, K2)
    fig, ax = plt.subplots(2)
    for index in range(N):
        ax[0].plot(h_index, impulse_response[:, index],
                   label=f"$h_{index + 1}[k]$")
        ax[1].plot(h_index, impulse_response_dB[:, index],
                   label=f"$h_{index + 1}[k]$")
    ax[0].legend()
    fig.suptitle(f"For $\eta^2 = {10 * np.log10(eta2)}$ [dB]")
    ax[1].set_xlabel("filter tap k")
    ax[0].set_ylabel("$| h_\ell [k]|$")
    ax[1].set_ylabel("$| h_\ell [k]|$ [dB]")
    ax[0].set_xlim((-50, 50))
    ax[0].grid(which='both')
    ax[1].set_xlim((-K1, K2))
    ax[1].grid(which='both')





.. image:: /auto_examples/b_general/images/sphx_glr_plot_b_FIR_Filtering_001.png
    :alt: For $\eta^2 = 60.0$ [dB]
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [[-6.25623412e+01 -3.37174853e-01 -1.18147548e+00 -2.75833410e+00
      -3.96708529e+00 -2.53184071e+00]
     [ 6.24966283e+03 -6.50718700e+01 -1.06323006e+01 -2.78307802e+01
      -4.43415891e+01 -3.21356351e+01]
     [-1.18147548e+00  6.23936770e+03 -1.11670149e+02 -1.41503895e+02
      -2.48639508e+02 -2.05864972e+02]
     [-2.75833410e+00 -2.78307802e+01  6.10849610e+03 -5.09392662e+02
      -8.75264939e+02 -8.52249863e+02]
     [-3.96708529e+00 -4.43415891e+01 -2.48639508e+02  5.37473506e+03
      -2.03895274e+03 -2.44079853e+03]
     [-2.53184071e+00 -3.21356351e+01 -2.05864972e+02 -8.52249863e+02
       3.80920147e+03 -4.87715502e+03]] [[-6.24225627e+01 -4.47131524e-01  1.59128167e+00 -3.64856925e+00
       4.96916970e+00 -2.82831448e+00]
     [ 6.24955287e+03 -5.89914825e+01 -1.45159740e+01  3.70708340e+01
      -5.58194281e+01  3.62550731e+01]
     [ 1.59128167e+00  6.23548403e+03  4.22507011e+00 -1.86843665e+02
       3.10503091e+02 -2.31952804e+02]
     [-3.64856925e+00  3.70708340e+01  6.06315634e+03  5.11898007e+02
      -1.06838824e+03  9.48504586e+02]
     [ 4.96916970e+00 -5.58194281e+01  3.10503091e+02  5.18161176e+03
       2.25135211e+03 -2.65502670e+03]
     [-2.82831448e+00  3.62550731e+01 -2.31952804e+02  9.48504586e+02
       3.59497330e+03  5.01874364e+03]]




.. GENERATED FROM PYTHON SOURCE LINES 103-122

-----------------------------------
Impulse Response and :math:`\eta^2`
-----------------------------------

The rate at which the estimator's impulse response decays depends on our
bandwidth parameter :math:`\eta^2`. Specifically, as we increase
:math:`\eta^2` we typically seek a higher resolution at a smaller bandwidth.
As expected, a more narrowband filter requires a longer impulse responses,
or equivalently, has a slower decaying impulse response. Therefore,
we require more filter taps for a given precision as we increase
:math:`\eta^2`.

Note that we plot only the first and largest filter coefficient
:math:`h_1[k]`. The fact that :math:`h_1[k]` has the largest filter
coefficients follows from the choice of analog system and digital control
and does not necessarily generalize.

We additionally plot the corresponding digital estimator transfer functions
as a function of the bandwidth parameter :math:`\eta^2`.

.. GENERATED FROM PYTHON SOURCE LINES 122-181

.. code-block:: default
   :lineno-start: 123


    Eta2 = np.logspace(0, 7, 8)
    K1 = 1 << 8
    K2 = 1 << 8
    h_index = np.arange(-K1, K2)


    plt.figure()
    for eta2 in Eta2:
        digital_estimator = FIRFilter(
            control_signal_sequences, analog_system, digital_control, eta2, K1, K2)
        impulse_response = 20 * \
            np.log10(np.abs(np.array(digital_estimator.h[:, 0, 0])))
        plt.plot(np.arange(0, K2), impulse_response[K2:],
                 label=f"$\eta^2 = {10 * np.log10(eta2)}$ [dB]")
    plt.legend()
    plt.xlabel("filter tap k")
    plt.ylabel("$| h_1 [k] \|$ [dB]")
    plt.xlim((0, K2))
    plt.grid(which="both")


    # Plot corresponding transfer functions of estimator

    # Logspace frequencies
    frequencies = np.logspace(-3, 0, 100)
    omega = 4 * np.pi * beta * frequencies

    plt.figure()
    for eta2 in Eta2:
        # Compute NTF
        digital_estimator = FIRFilter(
            control_signal_sequences, analog_system, digital_control, eta2, K1, K2)

        ntf = digital_estimator.noise_transfer_function(omega)
        ntf_dB = 20 * np.log10(np.abs(ntf))

        # Compute STF
        stf = digital_estimator.signal_transfer_function(omega)
        stf_dB = 20 * np.log10(np.abs(stf.flatten()))

        plt.semilogx(frequencies, stf_dB, '--')
        color = plt.gca().lines[-1].get_color()
        plt.semilogx(
            frequencies,
            20 * np.log10(np.linalg.norm(ntf[0, :, :], axis=0)),
            color=color,
            label=f'$\eta^2 = {10 * np.log10(eta2)}$ [dB]')

    # Add labels and legends to figure
    plt.legend(loc=4)
    plt.grid(which='both')
    plt.title("Signal (dashed) and noise (solid) transfer functions")
    plt.xlabel("$\omega / (4 \pi \\beta ) $")
    plt.ylabel("dB")
    plt.xlim((1e-2, 0.5))
    plt.ylim((-150, 3))
    plt.gcf().tight_layout()




.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_examples/b_general/images/sphx_glr_plot_b_FIR_Filtering_002.png
          :alt: plot b FIR Filtering
          :class: sphx-glr-multi-img

    *

      .. image:: /auto_examples/b_general/images/sphx_glr_plot_b_FIR_Filtering_003.png
          :alt: Signal (dashed) and noise (solid) transfer functions
          :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [[-5.32746278e+03 -3.09329535e+03 -1.04847231e+03 -7.16116878e+00
       1.29310553e+02  1.94669810e+00]
     [ 3.15670465e+03 -4.26150583e+03 -3.08733422e+03 -1.18005342e+03
      -9.14943752e+00  1.30183234e+02]
     [-1.04847231e+03  3.16266578e+03 -4.12800447e+03 -3.08664965e+03
      -1.18185354e+03 -7.24477277e+00]
     [-7.16116878e+00 -1.18005342e+03  3.16335035e+03 -4.12614915e+03
      -3.08726370e+03 -1.05391625e+03]
     [ 1.29310553e+02 -9.14943752e+00 -1.18185354e+03  3.16273630e+03
      -4.25236148e+03 -3.09311242e+03]
     [ 1.94669810e+00  1.30183234e+02 -7.24477277e+00 -1.05391625e+03
       3.15688758e+03 -5.28892462e+03]] [[ 5.28892462e+03 -3.15688758e+03  1.05391625e+03  7.24477277e+00
      -1.30183234e+02 -1.94669810e+00]
     [ 3.09311242e+03  4.25236148e+03 -3.16273630e+03  1.18185354e+03
       9.14943752e+00 -1.29310553e+02]
     [ 1.05391625e+03  3.08726370e+03  4.12614915e+03 -3.16335035e+03
       1.18005342e+03  7.16116878e+00]
     [ 7.24477277e+00  1.18185354e+03  3.08664965e+03  4.12800447e+03
      -3.16266578e+03  1.04847231e+03]
     [-1.30183234e+02  9.14943752e+00  1.18005342e+03  3.08733422e+03
       4.26150583e+03 -3.15670465e+03]
     [-1.94669810e+00 -1.29310553e+02  7.16116878e+00  1.04847231e+03
       3.09329535e+03  5.32746278e+03]]
    [[-1215.84592363 -1276.0430678   -856.32028552  -249.91392637
         72.98940499    50.20133354]
     [ 4973.9569322  -2509.48391116 -2476.85370971 -1355.43246109
       -177.46244783   158.6026797 ]
     [ -856.32028552  3773.14629029 -3635.67672022 -3029.23092323
      -1304.25248748   -32.08020202]
     [ -249.91392637 -1355.43246109  3220.76907677 -4016.39553939
      -3080.67520429 -1082.31503447]
     [   72.98940499  -177.46244783 -1304.25248748  3169.32479571
      -4210.6178884  -3091.04976706]
     [   50.20133354   158.6026797    -32.08020202 -1082.31503447
       3158.95023294 -5280.8455496 ]] [[ 1132.02922326 -1333.26985531   884.84852031  -242.59001539
        -83.27235748    48.12977891]
     [ 4916.73014469  2507.1161283  -2582.36443973  1374.33512923
       -149.3776045   -163.77679255]
     [  884.84852031  3667.63556027  3661.54759487 -3120.71489874
       1298.44744463   -11.86203876]
     [ -242.59001539  1374.33512923  3129.28510126  4025.59894875
      -3156.89480463  1074.66382577]
     [  -83.27235748  -149.3776045   1298.44744463  3093.10519537
       4222.34300172 -3155.26739841]
     [   48.12977891  -163.77679255   -11.86203876  1074.66382577
       3094.73260159  5320.2306355 ]]
    [[ -260.76330063  -348.39436824  -381.80774712  -238.0527436
        -38.79235641    34.698758  ]
     [ 5901.60563176 -1003.32974696 -1348.18189599 -1117.12685109
       -399.75270065    73.60426845]
     [ -381.80774712  4901.81810401 -2475.94754161 -2571.12013743
      -1457.56779765  -165.31634761]
     [ -238.0527436  -1117.12685109  3678.87986257 -3675.65563301
      -3060.10515686 -1163.15080413]
     [  -38.79235641  -399.75270065 -1457.56779765  3189.89484314
      -4135.54789687 -3082.59789448]
     [   34.698758      73.60426845  -165.31634761 -1163.15080413
       3167.40210552 -5258.05090047]] [[  148.22768755  -376.27250065   409.6854177   -246.41805956
         31.57559664    37.65352637]
     [ 5873.72749935   960.07911371 -1453.90420424  1172.1180776
       -384.90756431   -90.15294088]
     [  409.6854177   4796.09579576  2526.70890591 -2708.13410062
       1469.7781249   -132.41332196]
     [ -246.41805956  1172.1180776   3541.86589938  3722.49339732
      -3148.46359126  1147.70617945]
     [   31.57559664  -384.90756431  1469.7781249   3101.53640874
       4151.75224147 -3146.49533495]
     [   37.65352637   -90.15294088  -132.41332196  1147.70617945
       3103.50466505  5300.03367358]]
    [[-9.16053353e+01 -7.29063737e+01 -1.15601234e+02 -1.13741639e+02
      -5.43179250e+01  3.26045134e+00]
     [ 6.17709363e+03 -3.29379158e+02 -5.22325509e+02 -6.16920130e+02
      -3.82770358e+02 -3.87610898e+01]
     [-1.15601234e+02  5.72767449e+03 -1.26528330e+03 -1.67486573e+03
      -1.31327503e+03 -3.40557200e+02]
     [-1.13741639e+02 -6.16920130e+02  4.57513427e+03 -2.85584642e+03
      -2.81439436e+03 -1.29009712e+03]
     [-5.43179250e+01 -3.82770358e+02 -1.31327503e+03  3.43560564e+03
      -3.97936151e+03 -3.09088131e+03]
     [ 3.26045134e+00 -3.87610898e+01 -3.40557200e+02 -1.29009712e+03
       3.15911869e+03 -5.22537391e+03]] [[-3.05900503e+01 -8.19869482e+01  1.29788970e+02 -1.24274984e+02
       5.46256595e+01  6.14231706e+00]
     [ 6.16801305e+03  2.40588911e+02 -5.89330049e+02  6.78325885e+02
      -3.95101199e+02  2.44407015e+01]
     [ 1.29788970e+02  5.66066995e+03  1.28508909e+03 -1.83597202e+03
       1.37357800e+03 -3.12110581e+02]
     [-1.24274984e+02  6.78325885e+02  4.41402798e+03  2.95737039e+03
      -2.95461887e+03  1.27725513e+03]
     [ 5.46256595e+01 -3.95101199e+02  1.37357800e+03  3.29538113e+03
       4.02584843e+03 -3.15493398e+03]
     [ 6.14231706e+00  2.44407015e+01 -3.12110581e+02  1.27725513e+03
       3.09506602e+03  5.26854286e+03]]
    [[  -66.41655325   -13.11776608   -28.07262075   -38.72463729
        -30.00951023    -6.40510691]
     [ 6236.88223392  -125.29352061  -161.60657648  -257.12138392
       -233.32616776   -73.06566684]
     [  -28.07262075  6088.39342352  -538.20568197  -857.73551521
       -906.05234301  -388.30050211]
     [  -38.72463729  -257.12138392  5392.26448479 -1826.74467594
      -2210.78309175 -1302.96622467]
     [  -30.00951023  -233.32616776  -906.05234301  4039.21690825
      -3545.14216442 -3050.70934909]
     [   -6.40510691   -73.06566684  -388.30050211 -1302.96622467
       3199.29065091 -5193.94529249]] [[-5.80496524e+01 -1.54624264e+01  3.32094575e+01 -4.47826875e+01
       3.26377792e+01 -5.48356006e+00]
     [ 6.23453757e+03  1.26214280e+01 -1.92475831e+02  2.98769798e+02
      -2.56370335e+02  6.89355234e+01]
     [ 3.32094575e+01  6.05752417e+03  4.99989106e+02 -9.90473943e+02
       9.96535091e+02 -3.84180169e+02]
     [-4.47826875e+01  2.98769798e+02  5.25952606e+03  1.93586765e+03
      -2.41120438e+03  1.32326601e+03]
     [ 3.26377792e+01 -2.56370335e+02  9.96535091e+02  3.83879562e+03
       3.66236121e+03 -3.13963241e+03]
     [-5.48356006e+00  6.89355234e+01 -3.84180169e+02  1.32326601e+03
       3.11036759e+03  5.24295815e+03]]
    [[-6.30016919e+01 -2.16152397e+00 -5.99363502e+00 -1.09328590e+01
      -1.19022779e+01 -5.08668278e+00]
     [ 6.24783848e+03 -7.56800513e+01 -4.33928778e+01 -8.96013936e+01
      -1.09976158e+02 -5.64539658e+01]
     [-5.99363502e+00  6.20660712e+03 -2.23557243e+02 -3.69530645e+02
      -5.09315390e+02 -3.13792053e+02]
     [-1.09328590e+01 -8.96013936e+01  5.88046935e+03 -1.00575965e+03
      -1.48094185e+03 -1.12853767e+03]
     [-1.19022779e+01 -1.09976158e+02 -5.09315390e+02  4.76905815e+03
      -2.82864951e+03 -2.83718063e+03]
     [-5.08668278e+00 -5.64539658e+01 -3.13792053e+02 -1.12853767e+03
       3.41281937e+03 -5.10331212e+03]] [[-6.19059531e+01 -2.69044520e+00  7.52967258e+00 -1.34640727e+01
       1.38705694e+01 -5.18840618e+00]
     [ 6.24730955e+03 -4.57472359e+01 -5.50470626e+01  1.10937996e+02
      -1.28937244e+02  5.89451947e+01]
     [ 7.52967258e+00  6.19495294e+03  1.40433196e+02 -4.53972895e+02
       5.94356545e+02 -3.31413765e+02]
     [-1.34640727e+01  1.10937996e+02  5.79602711e+03  1.06969780e+03
      -1.69993722e+03  1.19413047e+03]
     [ 1.38705694e+01 -1.28937244e+02  5.94356545e+02  4.55006278e+03
       3.01476014e+03 -2.98403742e+03]
     [-5.18840618e+00  5.89451947e+01 -3.31413765e+02  1.19413047e+03
       3.26596258e+03  5.18272231e+03]]
    [[-6.25623412e+01 -3.37174853e-01 -1.18147548e+00 -2.75833410e+00
      -3.96708529e+00 -2.53184071e+00]
     [ 6.24966283e+03 -6.50718700e+01 -1.06323006e+01 -2.78307802e+01
      -4.43415891e+01 -3.21356351e+01]
     [-1.18147548e+00  6.23936770e+03 -1.11670149e+02 -1.41503895e+02
      -2.48639508e+02 -2.05864972e+02]
     [-2.75833410e+00 -2.78307802e+01  6.10849610e+03 -5.09392662e+02
      -8.75264939e+02 -8.52249863e+02]
     [-3.96708529e+00 -4.43415891e+01 -2.48639508e+02  5.37473506e+03
      -2.03895274e+03 -2.44079853e+03]
     [-2.53184071e+00 -3.21356351e+01 -2.05864972e+02 -8.52249863e+02
       3.80920147e+03 -4.87715502e+03]] [[-6.24225627e+01 -4.47131524e-01  1.59128167e+00 -3.64856925e+00
       4.96916970e+00 -2.82831448e+00]
     [ 6.24955287e+03 -5.89914825e+01 -1.45159740e+01  3.70708340e+01
      -5.58194281e+01  3.62550731e+01]
     [ 1.59128167e+00  6.23548403e+03  4.22507011e+00 -1.86843665e+02
       3.10503091e+02 -2.31952804e+02]
     [-3.64856925e+00  3.70708340e+01  6.06315634e+03  5.11898007e+02
      -1.06838824e+03  9.48504586e+02]
     [ 4.96916970e+00 -5.58194281e+01  3.10503091e+02  5.18161176e+03
       2.25135211e+03 -2.65502670e+03]
     [-2.82831448e+00  3.62550731e+01 -2.31952804e+02  9.48504586e+02
       3.59497330e+03  5.01874364e+03]]
    [[-6.25075891e+01 -5.06967816e-02 -2.20920557e-01 -6.47392729e-01
      -1.19145707e+00 -1.03319640e+00]
     [ 6.24994930e+03 -6.29777476e+01 -2.44929894e+00 -8.00662111e+00
      -1.61756285e+01 -1.55564939e+01]
     [-2.20920557e-01  6.24755070e+03 -7.64890760e+01 -4.99793199e+01
      -1.10265270e+02 -1.18361725e+02]
     [-6.47392729e-01 -8.00662111e+00  6.20002068e+03 -2.56927058e+02
      -4.72264113e+02 -5.80551794e+02]
     [-1.19145707e+00 -1.61756285e+01 -1.10265270e+02  5.77773589e+03
      -1.36104767e+03 -1.95430346e+03]
     [-1.03319640e+00 -1.55564939e+01 -1.18361725e+02 -5.80551794e+02
       4.29569654e+03 -4.50134475e+03]] [[-6.24900286e+01 -7.24169535e-02  3.22769142e-01 -9.29977028e-01
       1.61675035e+00 -1.25076716e+00]
     [ 6.24992758e+03 -6.17918703e+01 -3.64426424e+00  1.16090463e+01
      -2.20644421e+01  1.89296387e+01]
     [ 3.22769142e-01  6.24635574e+03 -4.17953564e+01 -7.17778983e+01
       1.48822920e+02 -1.42825027e+02]
     [-9.29977028e-01  1.16090463e+01  6.17822210e+03  2.08178178e+02
      -6.19329801e+02  6.84788085e+02]
     [ 1.61675035e+00 -2.20644421e+01  1.48822920e+02  5.63067020e+03
       1.55370815e+03 -2.21930454e+03]
     [-1.25076716e+00  1.89296387e+01 -1.42825027e+02  6.84788085e+02
       4.03069546e+03  4.72548482e+03]]
    [[-5.32746278e+03 -3.09329535e+03 -1.04847231e+03 -7.16116878e+00
       1.29310553e+02  1.94669810e+00]
     [ 3.15670465e+03 -4.26150583e+03 -3.08733422e+03 -1.18005342e+03
      -9.14943752e+00  1.30183234e+02]
     [-1.04847231e+03  3.16266578e+03 -4.12800447e+03 -3.08664965e+03
      -1.18185354e+03 -7.24477277e+00]
     [-7.16116878e+00 -1.18005342e+03  3.16335035e+03 -4.12614915e+03
      -3.08726370e+03 -1.05391625e+03]
     [ 1.29310553e+02 -9.14943752e+00 -1.18185354e+03  3.16273630e+03
      -4.25236148e+03 -3.09311242e+03]
     [ 1.94669810e+00  1.30183234e+02 -7.24477277e+00 -1.05391625e+03
       3.15688758e+03 -5.28892462e+03]] [[ 5.28892462e+03 -3.15688758e+03  1.05391625e+03  7.24477277e+00
      -1.30183234e+02 -1.94669810e+00]
     [ 3.09311242e+03  4.25236148e+03 -3.16273630e+03  1.18185354e+03
       9.14943752e+00 -1.29310553e+02]
     [ 1.05391625e+03  3.08726370e+03  4.12614915e+03 -3.16335035e+03
       1.18005342e+03  7.16116878e+00]
     [ 7.24477277e+00  1.18185354e+03  3.08664965e+03  4.12800447e+03
      -3.16266578e+03  1.04847231e+03]
     [-1.30183234e+02  9.14943752e+00  1.18005342e+03  3.08733422e+03
       4.26150583e+03 -3.15670465e+03]
     [-1.94669810e+00 -1.29310553e+02  7.16116878e+00  1.04847231e+03
       3.09329535e+03  5.32746278e+03]]
    /nas/PhD/cbadc/docs/code_examples/b_general/plot_b_FIR_Filtering.py:157: RuntimeWarning: divide by zero encountered in log10
      ntf_dB = 20 * np.log10(np.abs(ntf))
    [[-1215.84592363 -1276.0430678   -856.32028552  -249.91392637
         72.98940499    50.20133354]
     [ 4973.9569322  -2509.48391116 -2476.85370971 -1355.43246109
       -177.46244783   158.6026797 ]
     [ -856.32028552  3773.14629029 -3635.67672022 -3029.23092323
      -1304.25248748   -32.08020202]
     [ -249.91392637 -1355.43246109  3220.76907677 -4016.39553939
      -3080.67520429 -1082.31503447]
     [   72.98940499  -177.46244783 -1304.25248748  3169.32479571
      -4210.6178884  -3091.04976706]
     [   50.20133354   158.6026797    -32.08020202 -1082.31503447
       3158.95023294 -5280.8455496 ]] [[ 1132.02922326 -1333.26985531   884.84852031  -242.59001539
        -83.27235748    48.12977891]
     [ 4916.73014469  2507.1161283  -2582.36443973  1374.33512923
       -149.3776045   -163.77679255]
     [  884.84852031  3667.63556027  3661.54759487 -3120.71489874
       1298.44744463   -11.86203876]
     [ -242.59001539  1374.33512923  3129.28510126  4025.59894875
      -3156.89480463  1074.66382577]
     [  -83.27235748  -149.3776045   1298.44744463  3093.10519537
       4222.34300172 -3155.26739841]
     [   48.12977891  -163.77679255   -11.86203876  1074.66382577
       3094.73260159  5320.2306355 ]]
    /nas/PhD/cbadc/docs/code_examples/b_general/plot_b_FIR_Filtering.py:157: RuntimeWarning: divide by zero encountered in log10
      ntf_dB = 20 * np.log10(np.abs(ntf))
    [[ -260.76330063  -348.39436824  -381.80774712  -238.0527436
        -38.79235641    34.698758  ]
     [ 5901.60563176 -1003.32974696 -1348.18189599 -1117.12685109
       -399.75270065    73.60426845]
     [ -381.80774712  4901.81810401 -2475.94754161 -2571.12013743
      -1457.56779765  -165.31634761]
     [ -238.0527436  -1117.12685109  3678.87986257 -3675.65563301
      -3060.10515686 -1163.15080413]
     [  -38.79235641  -399.75270065 -1457.56779765  3189.89484314
      -4135.54789687 -3082.59789448]
     [   34.698758      73.60426845  -165.31634761 -1163.15080413
       3167.40210552 -5258.05090047]] [[  148.22768755  -376.27250065   409.6854177   -246.41805956
         31.57559664    37.65352637]
     [ 5873.72749935   960.07911371 -1453.90420424  1172.1180776
       -384.90756431   -90.15294088]
     [  409.6854177   4796.09579576  2526.70890591 -2708.13410062
       1469.7781249   -132.41332196]
     [ -246.41805956  1172.1180776   3541.86589938  3722.49339732
      -3148.46359126  1147.70617945]
     [   31.57559664  -384.90756431  1469.7781249   3101.53640874
       4151.75224147 -3146.49533495]
     [   37.65352637   -90.15294088  -132.41332196  1147.70617945
       3103.50466505  5300.03367358]]
    /nas/PhD/cbadc/docs/code_examples/b_general/plot_b_FIR_Filtering.py:157: RuntimeWarning: divide by zero encountered in log10
      ntf_dB = 20 * np.log10(np.abs(ntf))
    [[-9.16053353e+01 -7.29063737e+01 -1.15601234e+02 -1.13741639e+02
      -5.43179250e+01  3.26045134e+00]
     [ 6.17709363e+03 -3.29379158e+02 -5.22325509e+02 -6.16920130e+02
      -3.82770358e+02 -3.87610898e+01]
     [-1.15601234e+02  5.72767449e+03 -1.26528330e+03 -1.67486573e+03
      -1.31327503e+03 -3.40557200e+02]
     [-1.13741639e+02 -6.16920130e+02  4.57513427e+03 -2.85584642e+03
      -2.81439436e+03 -1.29009712e+03]
     [-5.43179250e+01 -3.82770358e+02 -1.31327503e+03  3.43560564e+03
      -3.97936151e+03 -3.09088131e+03]
     [ 3.26045134e+00 -3.87610898e+01 -3.40557200e+02 -1.29009712e+03
       3.15911869e+03 -5.22537391e+03]] [[-3.05900503e+01 -8.19869482e+01  1.29788970e+02 -1.24274984e+02
       5.46256595e+01  6.14231706e+00]
     [ 6.16801305e+03  2.40588911e+02 -5.89330049e+02  6.78325885e+02
      -3.95101199e+02  2.44407015e+01]
     [ 1.29788970e+02  5.66066995e+03  1.28508909e+03 -1.83597202e+03
       1.37357800e+03 -3.12110581e+02]
     [-1.24274984e+02  6.78325885e+02  4.41402798e+03  2.95737039e+03
      -2.95461887e+03  1.27725513e+03]
     [ 5.46256595e+01 -3.95101199e+02  1.37357800e+03  3.29538113e+03
       4.02584843e+03 -3.15493398e+03]
     [ 6.14231706e+00  2.44407015e+01 -3.12110581e+02  1.27725513e+03
       3.09506602e+03  5.26854286e+03]]
    /nas/PhD/cbadc/docs/code_examples/b_general/plot_b_FIR_Filtering.py:157: RuntimeWarning: divide by zero encountered in log10
      ntf_dB = 20 * np.log10(np.abs(ntf))
    [[  -66.41655325   -13.11776608   -28.07262075   -38.72463729
        -30.00951023    -6.40510691]
     [ 6236.88223392  -125.29352061  -161.60657648  -257.12138392
       -233.32616776   -73.06566684]
     [  -28.07262075  6088.39342352  -538.20568197  -857.73551521
       -906.05234301  -388.30050211]
     [  -38.72463729  -257.12138392  5392.26448479 -1826.74467594
      -2210.78309175 -1302.96622467]
     [  -30.00951023  -233.32616776  -906.05234301  4039.21690825
      -3545.14216442 -3050.70934909]
     [   -6.40510691   -73.06566684  -388.30050211 -1302.96622467
       3199.29065091 -5193.94529249]] [[-5.80496524e+01 -1.54624264e+01  3.32094575e+01 -4.47826875e+01
       3.26377792e+01 -5.48356006e+00]
     [ 6.23453757e+03  1.26214280e+01 -1.92475831e+02  2.98769798e+02
      -2.56370335e+02  6.89355234e+01]
     [ 3.32094575e+01  6.05752417e+03  4.99989106e+02 -9.90473943e+02
       9.96535091e+02 -3.84180169e+02]
     [-4.47826875e+01  2.98769798e+02  5.25952606e+03  1.93586765e+03
      -2.41120438e+03  1.32326601e+03]
     [ 3.26377792e+01 -2.56370335e+02  9.96535091e+02  3.83879562e+03
       3.66236121e+03 -3.13963241e+03]
     [-5.48356006e+00  6.89355234e+01 -3.84180169e+02  1.32326601e+03
       3.11036759e+03  5.24295815e+03]]
    /nas/PhD/cbadc/docs/code_examples/b_general/plot_b_FIR_Filtering.py:157: RuntimeWarning: divide by zero encountered in log10
      ntf_dB = 20 * np.log10(np.abs(ntf))
    [[-6.30016919e+01 -2.16152397e+00 -5.99363502e+00 -1.09328590e+01
      -1.19022779e+01 -5.08668278e+00]
     [ 6.24783848e+03 -7.56800513e+01 -4.33928778e+01 -8.96013936e+01
      -1.09976158e+02 -5.64539658e+01]
     [-5.99363502e+00  6.20660712e+03 -2.23557243e+02 -3.69530645e+02
      -5.09315390e+02 -3.13792053e+02]
     [-1.09328590e+01 -8.96013936e+01  5.88046935e+03 -1.00575965e+03
      -1.48094185e+03 -1.12853767e+03]
     [-1.19022779e+01 -1.09976158e+02 -5.09315390e+02  4.76905815e+03
      -2.82864951e+03 -2.83718063e+03]
     [-5.08668278e+00 -5.64539658e+01 -3.13792053e+02 -1.12853767e+03
       3.41281937e+03 -5.10331212e+03]] [[-6.19059531e+01 -2.69044520e+00  7.52967258e+00 -1.34640727e+01
       1.38705694e+01 -5.18840618e+00]
     [ 6.24730955e+03 -4.57472359e+01 -5.50470626e+01  1.10937996e+02
      -1.28937244e+02  5.89451947e+01]
     [ 7.52967258e+00  6.19495294e+03  1.40433196e+02 -4.53972895e+02
       5.94356545e+02 -3.31413765e+02]
     [-1.34640727e+01  1.10937996e+02  5.79602711e+03  1.06969780e+03
      -1.69993722e+03  1.19413047e+03]
     [ 1.38705694e+01 -1.28937244e+02  5.94356545e+02  4.55006278e+03
       3.01476014e+03 -2.98403742e+03]
     [-5.18840618e+00  5.89451947e+01 -3.31413765e+02  1.19413047e+03
       3.26596258e+03  5.18272231e+03]]
    /nas/PhD/cbadc/docs/code_examples/b_general/plot_b_FIR_Filtering.py:157: RuntimeWarning: divide by zero encountered in log10
      ntf_dB = 20 * np.log10(np.abs(ntf))
    [[-6.25623412e+01 -3.37174853e-01 -1.18147548e+00 -2.75833410e+00
      -3.96708529e+00 -2.53184071e+00]
     [ 6.24966283e+03 -6.50718700e+01 -1.06323006e+01 -2.78307802e+01
      -4.43415891e+01 -3.21356351e+01]
     [-1.18147548e+00  6.23936770e+03 -1.11670149e+02 -1.41503895e+02
      -2.48639508e+02 -2.05864972e+02]
     [-2.75833410e+00 -2.78307802e+01  6.10849610e+03 -5.09392662e+02
      -8.75264939e+02 -8.52249863e+02]
     [-3.96708529e+00 -4.43415891e+01 -2.48639508e+02  5.37473506e+03
      -2.03895274e+03 -2.44079853e+03]
     [-2.53184071e+00 -3.21356351e+01 -2.05864972e+02 -8.52249863e+02
       3.80920147e+03 -4.87715502e+03]] [[-6.24225627e+01 -4.47131524e-01  1.59128167e+00 -3.64856925e+00
       4.96916970e+00 -2.82831448e+00]
     [ 6.24955287e+03 -5.89914825e+01 -1.45159740e+01  3.70708340e+01
      -5.58194281e+01  3.62550731e+01]
     [ 1.59128167e+00  6.23548403e+03  4.22507011e+00 -1.86843665e+02
       3.10503091e+02 -2.31952804e+02]
     [-3.64856925e+00  3.70708340e+01  6.06315634e+03  5.11898007e+02
      -1.06838824e+03  9.48504586e+02]
     [ 4.96916970e+00 -5.58194281e+01  3.10503091e+02  5.18161176e+03
       2.25135211e+03 -2.65502670e+03]
     [-2.82831448e+00  3.62550731e+01 -2.31952804e+02  9.48504586e+02
       3.59497330e+03  5.01874364e+03]]
    [[-6.25075891e+01 -5.06967816e-02 -2.20920557e-01 -6.47392729e-01
      -1.19145707e+00 -1.03319640e+00]
     [ 6.24994930e+03 -6.29777476e+01 -2.44929894e+00 -8.00662111e+00
      -1.61756285e+01 -1.55564939e+01]
     [-2.20920557e-01  6.24755070e+03 -7.64890760e+01 -4.99793199e+01
      -1.10265270e+02 -1.18361725e+02]
     [-6.47392729e-01 -8.00662111e+00  6.20002068e+03 -2.56927058e+02
      -4.72264113e+02 -5.80551794e+02]
     [-1.19145707e+00 -1.61756285e+01 -1.10265270e+02  5.77773589e+03
      -1.36104767e+03 -1.95430346e+03]
     [-1.03319640e+00 -1.55564939e+01 -1.18361725e+02 -5.80551794e+02
       4.29569654e+03 -4.50134475e+03]] [[-6.24900286e+01 -7.24169535e-02  3.22769142e-01 -9.29977028e-01
       1.61675035e+00 -1.25076716e+00]
     [ 6.24992758e+03 -6.17918703e+01 -3.64426424e+00  1.16090463e+01
      -2.20644421e+01  1.89296387e+01]
     [ 3.22769142e-01  6.24635574e+03 -4.17953564e+01 -7.17778983e+01
       1.48822920e+02 -1.42825027e+02]
     [-9.29977028e-01  1.16090463e+01  6.17822210e+03  2.08178178e+02
      -6.19329801e+02  6.84788085e+02]
     [ 1.61675035e+00 -2.20644421e+01  1.48822920e+02  5.63067020e+03
       1.55370815e+03 -2.21930454e+03]
     [-1.25076716e+00  1.89296387e+01 -1.42825027e+02  6.84788085e+02
       4.03069546e+03  4.72548482e+03]]




.. GENERATED FROM PYTHON SOURCE LINES 182-204

Filter length
-------------

We can confirm the intuition from the previous section by considering
different number of filter taps for a given control signal sequence. Firstly,
we once more plot the decay of the filter coefficients and recognize
that an SNR of around 100 dB (normalized spectrum), would need around
K1=K2=180 filter taps or more. This is confirmed by simulation as the
harmonics in the estimated spectrum disappear for larger number of
filter taps. Note also the reference used in the spectral plots which
corresponds to the default implementation
:py:class:`cbadc.digital_estimator.DigitalEstimator` using a much
longer lookahead than corresponding FIR filters implementations.

The simulation is often a robust way of determining a minimum
number of filter taps for a specific analog system, digital control,
and :math:`\eta^2` combination.

As is clear from the filter coefficient the different dimensions of the
control signals :math:`\mathbf{s}[k]` can be filtered with FIR filters
of different lengths as their decay varies.


.. GENERATED FROM PYTHON SOURCE LINES 204-308

.. code-block:: default
   :lineno-start: 204

    from cbadc.utilities import compute_power_spectral_density

    filter_lengths = [10, 20, 40, 80, 120, 160, 180, 200, 220]

    eta2 = 1e6

    control_signal_sequences = [byte_stream_2_control_signal(read_byte_stream_from_file(
        '../a_getting_started/sinusodial_simulation.adc', M), M) for _ in filter_lengths]

    stop_after_number_of_iterations = 1 << 16
    u_hat = np.zeros(stop_after_number_of_iterations)


    digital_estimators = [FIRFilter(
        cs,
        analog_system,
        digital_control,
        eta2,
        filter_lengths[index],
        filter_lengths[index],
        stop_after_number_of_iterations=stop_after_number_of_iterations
    ) for index, cs in enumerate(control_signal_sequences)]


    impulse_response_dB = 20 * \
        np.log10(np.abs(np.array(digital_estimators[-1].h[:, 0, :])))
    plt.figure()
    for index in range(N):
        plt.plot(
            np.arange(0, filter_lengths[-1]),
            impulse_response_dB[filter_lengths[-1]:, index],
            label=f"$h_{index + 1}[k]$")
    plt.legend()
    plt.xlabel("filter tap k")
    plt.ylabel("$| h_\ell [k]|$ [dB]")
    plt.xlim((0, filter_lengths[-1]))
    plt.grid(which='both')

    digital_estimators_ref = DigitalEstimator(
        byte_stream_2_control_signal(read_byte_stream_from_file(
        '../a_getting_started/sinusodial_simulation.adc', M), M),
        analog_system,
        digital_control,
        eta2,
        stop_after_number_of_iterations >> 2,
        1 << 14,
        stop_after_number_of_iterations=stop_after_number_of_iterations
    )

    for index, estimate in enumerate(digital_estimators_ref):
        u_hat[index] = estimate
    f_ref, psd_ref = compute_power_spectral_density(u_hat)

    u_hats = []
    plt.rcParams['figure.figsize'] = [6.40, 6.40 * 4]
    fig, ax = plt.subplots(len(filter_lengths), 1)
    for index_de in range(len(filter_lengths)):
        # Compute estimates for each estimator
        for index, estimate in enumerate(digital_estimators[index_de]):
            u_hat[index] = estimate
        u_hats.append(np.copy(u_hat))

        # Compute power spectral density
        f, psd = compute_power_spectral_density(
            u_hat[filter_lengths[index_de]:])

        # Plot the FIR filters
        color = next(ax[index_de]._get_lines.prop_cycler)['color']

        ax[index_de].grid(b=True, which='major',
                          color='gray', alpha=0.6, lw=1.5)
        ax[index_de].grid(b=True, which='major',
                          color='gray', alpha=0.6, lw=1.5)

        ax[index_de].semilogx(f_ref, 10 * np.log10(psd_ref),
                              label=f'Reference', color='k')

        ax[index_de].semilogx(f, 10 * np.log10(psd),
                              label=f'K1=K2={filter_lengths[index_de]}',
                              color=color)

        ax[index_de].set_ylabel('$ \mathrm{V}^2 \, / \, \mathrm{Hz}$')

        ax[index_de].legend()
        ax[index_de].set_xlim((0.0002, 0.5))

    ax[-1].set_xlabel('frequency [Hz]')
    fig.tight_layout()

    # Plot snapshot in time domain
    plt.rcParams['figure.figsize'] = [6.40, 6.40]
    plt.figure()
    plt.title("Estimates in time domain")
    for index in range(len(filter_lengths)):
        t_fir = np.arange(-filter_lengths[index] + 1,
                          stop_after_number_of_iterations - filter_lengths[index] + 1)
        plt.plot(t_fir, u_hats[index],
                 label=f'K1=K2={filter_lengths[index]}')
    plt.ylabel('$\hat{u}(t)$')
    plt.xlim((64000, 64600))
    plt.ylim((-0.6, 0.6))
    plt.xlabel("$t / T$")
    _ = plt.legend()




.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /auto_examples/b_general/images/sphx_glr_plot_b_FIR_Filtering_004.png
          :alt: plot b FIR Filtering
          :class: sphx-glr-multi-img

    *

      .. image:: /auto_examples/b_general/images/sphx_glr_plot_b_FIR_Filtering_005.png
          :alt: plot b FIR Filtering
          :class: sphx-glr-multi-img

    *

      .. image:: /auto_examples/b_general/images/sphx_glr_plot_b_FIR_Filtering_006.png
          :alt: Estimates in time domain
          :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [[-6.25623412e+01 -3.37174853e-01 -1.18147548e+00 -2.75833410e+00
      -3.96708529e+00 -2.53184071e+00]
     [ 6.24966283e+03 -6.50718700e+01 -1.06323006e+01 -2.78307802e+01
      -4.43415891e+01 -3.21356351e+01]
     [-1.18147548e+00  6.23936770e+03 -1.11670149e+02 -1.41503895e+02
      -2.48639508e+02 -2.05864972e+02]
     [-2.75833410e+00 -2.78307802e+01  6.10849610e+03 -5.09392662e+02
      -8.75264939e+02 -8.52249863e+02]
     [-3.96708529e+00 -4.43415891e+01 -2.48639508e+02  5.37473506e+03
      -2.03895274e+03 -2.44079853e+03]
     [-2.53184071e+00 -3.21356351e+01 -2.05864972e+02 -8.52249863e+02
       3.80920147e+03 -4.87715502e+03]] [[-6.24225627e+01 -4.47131524e-01  1.59128167e+00 -3.64856925e+00
       4.96916970e+00 -2.82831448e+00]
     [ 6.24955287e+03 -5.89914825e+01 -1.45159740e+01  3.70708340e+01
      -5.58194281e+01  3.62550731e+01]
     [ 1.59128167e+00  6.23548403e+03  4.22507011e+00 -1.86843665e+02
       3.10503091e+02 -2.31952804e+02]
     [-3.64856925e+00  3.70708340e+01  6.06315634e+03  5.11898007e+02
      -1.06838824e+03  9.48504586e+02]
     [ 4.96916970e+00 -5.58194281e+01  3.10503091e+02  5.18161176e+03
       2.25135211e+03 -2.65502670e+03]
     [-2.82831448e+00  3.62550731e+01 -2.31952804e+02  9.48504586e+02
       3.59497330e+03  5.01874364e+03]]
    [[-6.25623412e+01 -3.37174853e-01 -1.18147548e+00 -2.75833410e+00
      -3.96708529e+00 -2.53184071e+00]
     [ 6.24966283e+03 -6.50718700e+01 -1.06323006e+01 -2.78307802e+01
      -4.43415891e+01 -3.21356351e+01]
     [-1.18147548e+00  6.23936770e+03 -1.11670149e+02 -1.41503895e+02
      -2.48639508e+02 -2.05864972e+02]
     [-2.75833410e+00 -2.78307802e+01  6.10849610e+03 -5.09392662e+02
      -8.75264939e+02 -8.52249863e+02]
     [-3.96708529e+00 -4.43415891e+01 -2.48639508e+02  5.37473506e+03
      -2.03895274e+03 -2.44079853e+03]
     [-2.53184071e+00 -3.21356351e+01 -2.05864972e+02 -8.52249863e+02
       3.80920147e+03 -4.87715502e+03]] [[-6.24225627e+01 -4.47131524e-01  1.59128167e+00 -3.64856925e+00
       4.96916970e+00 -2.82831448e+00]
     [ 6.24955287e+03 -5.89914825e+01 -1.45159740e+01  3.70708340e+01
      -5.58194281e+01  3.62550731e+01]
     [ 1.59128167e+00  6.23548403e+03  4.22507011e+00 -1.86843665e+02
       3.10503091e+02 -2.31952804e+02]
     [-3.64856925e+00  3.70708340e+01  6.06315634e+03  5.11898007e+02
      -1.06838824e+03  9.48504586e+02]
     [ 4.96916970e+00 -5.58194281e+01  3.10503091e+02  5.18161176e+03
       2.25135211e+03 -2.65502670e+03]
     [-2.82831448e+00  3.62550731e+01 -2.31952804e+02  9.48504586e+02
       3.59497330e+03  5.01874364e+03]]
    [[-6.25623412e+01 -3.37174853e-01 -1.18147548e+00 -2.75833410e+00
      -3.96708529e+00 -2.53184071e+00]
     [ 6.24966283e+03 -6.50718700e+01 -1.06323006e+01 -2.78307802e+01
      -4.43415891e+01 -3.21356351e+01]
     [-1.18147548e+00  6.23936770e+03 -1.11670149e+02 -1.41503895e+02
      -2.48639508e+02 -2.05864972e+02]
     [-2.75833410e+00 -2.78307802e+01  6.10849610e+03 -5.09392662e+02
      -8.75264939e+02 -8.52249863e+02]
     [-3.96708529e+00 -4.43415891e+01 -2.48639508e+02  5.37473506e+03
      -2.03895274e+03 -2.44079853e+03]
     [-2.53184071e+00 -3.21356351e+01 -2.05864972e+02 -8.52249863e+02
       3.80920147e+03 -4.87715502e+03]] [[-6.24225627e+01 -4.47131524e-01  1.59128167e+00 -3.64856925e+00
       4.96916970e+00 -2.82831448e+00]
     [ 6.24955287e+03 -5.89914825e+01 -1.45159740e+01  3.70708340e+01
      -5.58194281e+01  3.62550731e+01]
     [ 1.59128167e+00  6.23548403e+03  4.22507011e+00 -1.86843665e+02
       3.10503091e+02 -2.31952804e+02]
     [-3.64856925e+00  3.70708340e+01  6.06315634e+03  5.11898007e+02
      -1.06838824e+03  9.48504586e+02]
     [ 4.96916970e+00 -5.58194281e+01  3.10503091e+02  5.18161176e+03
       2.25135211e+03 -2.65502670e+03]
     [-2.82831448e+00  3.62550731e+01 -2.31952804e+02  9.48504586e+02
       3.59497330e+03  5.01874364e+03]]
    [[-6.25623412e+01 -3.37174853e-01 -1.18147548e+00 -2.75833410e+00
      -3.96708529e+00 -2.53184071e+00]
     [ 6.24966283e+03 -6.50718700e+01 -1.06323006e+01 -2.78307802e+01
      -4.43415891e+01 -3.21356351e+01]
     [-1.18147548e+00  6.23936770e+03 -1.11670149e+02 -1.41503895e+02
      -2.48639508e+02 -2.05864972e+02]
     [-2.75833410e+00 -2.78307802e+01  6.10849610e+03 -5.09392662e+02
      -8.75264939e+02 -8.52249863e+02]
     [-3.96708529e+00 -4.43415891e+01 -2.48639508e+02  5.37473506e+03
      -2.03895274e+03 -2.44079853e+03]
     [-2.53184071e+00 -3.21356351e+01 -2.05864972e+02 -8.52249863e+02
       3.80920147e+03 -4.87715502e+03]] [[-6.24225627e+01 -4.47131524e-01  1.59128167e+00 -3.64856925e+00
       4.96916970e+00 -2.82831448e+00]
     [ 6.24955287e+03 -5.89914825e+01 -1.45159740e+01  3.70708340e+01
      -5.58194281e+01  3.62550731e+01]
     [ 1.59128167e+00  6.23548403e+03  4.22507011e+00 -1.86843665e+02
       3.10503091e+02 -2.31952804e+02]
     [-3.64856925e+00  3.70708340e+01  6.06315634e+03  5.11898007e+02
      -1.06838824e+03  9.48504586e+02]
     [ 4.96916970e+00 -5.58194281e+01  3.10503091e+02  5.18161176e+03
       2.25135211e+03 -2.65502670e+03]
     [-2.82831448e+00  3.62550731e+01 -2.31952804e+02  9.48504586e+02
       3.59497330e+03  5.01874364e+03]]
    [[-6.25623412e+01 -3.37174853e-01 -1.18147548e+00 -2.75833410e+00
      -3.96708529e+00 -2.53184071e+00]
     [ 6.24966283e+03 -6.50718700e+01 -1.06323006e+01 -2.78307802e+01
      -4.43415891e+01 -3.21356351e+01]
     [-1.18147548e+00  6.23936770e+03 -1.11670149e+02 -1.41503895e+02
      -2.48639508e+02 -2.05864972e+02]
     [-2.75833410e+00 -2.78307802e+01  6.10849610e+03 -5.09392662e+02
      -8.75264939e+02 -8.52249863e+02]
     [-3.96708529e+00 -4.43415891e+01 -2.48639508e+02  5.37473506e+03
      -2.03895274e+03 -2.44079853e+03]
     [-2.53184071e+00 -3.21356351e+01 -2.05864972e+02 -8.52249863e+02
       3.80920147e+03 -4.87715502e+03]] [[-6.24225627e+01 -4.47131524e-01  1.59128167e+00 -3.64856925e+00
       4.96916970e+00 -2.82831448e+00]
     [ 6.24955287e+03 -5.89914825e+01 -1.45159740e+01  3.70708340e+01
      -5.58194281e+01  3.62550731e+01]
     [ 1.59128167e+00  6.23548403e+03  4.22507011e+00 -1.86843665e+02
       3.10503091e+02 -2.31952804e+02]
     [-3.64856925e+00  3.70708340e+01  6.06315634e+03  5.11898007e+02
      -1.06838824e+03  9.48504586e+02]
     [ 4.96916970e+00 -5.58194281e+01  3.10503091e+02  5.18161176e+03
       2.25135211e+03 -2.65502670e+03]
     [-2.82831448e+00  3.62550731e+01 -2.31952804e+02  9.48504586e+02
       3.59497330e+03  5.01874364e+03]]
    [[-6.25623412e+01 -3.37174853e-01 -1.18147548e+00 -2.75833410e+00
      -3.96708529e+00 -2.53184071e+00]
     [ 6.24966283e+03 -6.50718700e+01 -1.06323006e+01 -2.78307802e+01
      -4.43415891e+01 -3.21356351e+01]
     [-1.18147548e+00  6.23936770e+03 -1.11670149e+02 -1.41503895e+02
      -2.48639508e+02 -2.05864972e+02]
     [-2.75833410e+00 -2.78307802e+01  6.10849610e+03 -5.09392662e+02
      -8.75264939e+02 -8.52249863e+02]
     [-3.96708529e+00 -4.43415891e+01 -2.48639508e+02  5.37473506e+03
      -2.03895274e+03 -2.44079853e+03]
     [-2.53184071e+00 -3.21356351e+01 -2.05864972e+02 -8.52249863e+02
       3.80920147e+03 -4.87715502e+03]] [[-6.24225627e+01 -4.47131524e-01  1.59128167e+00 -3.64856925e+00
       4.96916970e+00 -2.82831448e+00]
     [ 6.24955287e+03 -5.89914825e+01 -1.45159740e+01  3.70708340e+01
      -5.58194281e+01  3.62550731e+01]
     [ 1.59128167e+00  6.23548403e+03  4.22507011e+00 -1.86843665e+02
       3.10503091e+02 -2.31952804e+02]
     [-3.64856925e+00  3.70708340e+01  6.06315634e+03  5.11898007e+02
      -1.06838824e+03  9.48504586e+02]
     [ 4.96916970e+00 -5.58194281e+01  3.10503091e+02  5.18161176e+03
       2.25135211e+03 -2.65502670e+03]
     [-2.82831448e+00  3.62550731e+01 -2.31952804e+02  9.48504586e+02
       3.59497330e+03  5.01874364e+03]]
    [[-6.25623412e+01 -3.37174853e-01 -1.18147548e+00 -2.75833410e+00
      -3.96708529e+00 -2.53184071e+00]
     [ 6.24966283e+03 -6.50718700e+01 -1.06323006e+01 -2.78307802e+01
      -4.43415891e+01 -3.21356351e+01]
     [-1.18147548e+00  6.23936770e+03 -1.11670149e+02 -1.41503895e+02
      -2.48639508e+02 -2.05864972e+02]
     [-2.75833410e+00 -2.78307802e+01  6.10849610e+03 -5.09392662e+02
      -8.75264939e+02 -8.52249863e+02]
     [-3.96708529e+00 -4.43415891e+01 -2.48639508e+02  5.37473506e+03
      -2.03895274e+03 -2.44079853e+03]
     [-2.53184071e+00 -3.21356351e+01 -2.05864972e+02 -8.52249863e+02
       3.80920147e+03 -4.87715502e+03]] [[-6.24225627e+01 -4.47131524e-01  1.59128167e+00 -3.64856925e+00
       4.96916970e+00 -2.82831448e+00]
     [ 6.24955287e+03 -5.89914825e+01 -1.45159740e+01  3.70708340e+01
      -5.58194281e+01  3.62550731e+01]
     [ 1.59128167e+00  6.23548403e+03  4.22507011e+00 -1.86843665e+02
       3.10503091e+02 -2.31952804e+02]
     [-3.64856925e+00  3.70708340e+01  6.06315634e+03  5.11898007e+02
      -1.06838824e+03  9.48504586e+02]
     [ 4.96916970e+00 -5.58194281e+01  3.10503091e+02  5.18161176e+03
       2.25135211e+03 -2.65502670e+03]
     [-2.82831448e+00  3.62550731e+01 -2.31952804e+02  9.48504586e+02
       3.59497330e+03  5.01874364e+03]]
    [[-6.25623412e+01 -3.37174853e-01 -1.18147548e+00 -2.75833410e+00
      -3.96708529e+00 -2.53184071e+00]
     [ 6.24966283e+03 -6.50718700e+01 -1.06323006e+01 -2.78307802e+01
      -4.43415891e+01 -3.21356351e+01]
     [-1.18147548e+00  6.23936770e+03 -1.11670149e+02 -1.41503895e+02
      -2.48639508e+02 -2.05864972e+02]
     [-2.75833410e+00 -2.78307802e+01  6.10849610e+03 -5.09392662e+02
      -8.75264939e+02 -8.52249863e+02]
     [-3.96708529e+00 -4.43415891e+01 -2.48639508e+02  5.37473506e+03
      -2.03895274e+03 -2.44079853e+03]
     [-2.53184071e+00 -3.21356351e+01 -2.05864972e+02 -8.52249863e+02
       3.80920147e+03 -4.87715502e+03]] [[-6.24225627e+01 -4.47131524e-01  1.59128167e+00 -3.64856925e+00
       4.96916970e+00 -2.82831448e+00]
     [ 6.24955287e+03 -5.89914825e+01 -1.45159740e+01  3.70708340e+01
      -5.58194281e+01  3.62550731e+01]
     [ 1.59128167e+00  6.23548403e+03  4.22507011e+00 -1.86843665e+02
       3.10503091e+02 -2.31952804e+02]
     [-3.64856925e+00  3.70708340e+01  6.06315634e+03  5.11898007e+02
      -1.06838824e+03  9.48504586e+02]
     [ 4.96916970e+00 -5.58194281e+01  3.10503091e+02  5.18161176e+03
       2.25135211e+03 -2.65502670e+03]
     [-2.82831448e+00  3.62550731e+01 -2.31952804e+02  9.48504586e+02
       3.59497330e+03  5.01874364e+03]]
    [[-6.25623412e+01 -3.37174853e-01 -1.18147548e+00 -2.75833410e+00
      -3.96708529e+00 -2.53184071e+00]
     [ 6.24966283e+03 -6.50718700e+01 -1.06323006e+01 -2.78307802e+01
      -4.43415891e+01 -3.21356351e+01]
     [-1.18147548e+00  6.23936770e+03 -1.11670149e+02 -1.41503895e+02
      -2.48639508e+02 -2.05864972e+02]
     [-2.75833410e+00 -2.78307802e+01  6.10849610e+03 -5.09392662e+02
      -8.75264939e+02 -8.52249863e+02]
     [-3.96708529e+00 -4.43415891e+01 -2.48639508e+02  5.37473506e+03
      -2.03895274e+03 -2.44079853e+03]
     [-2.53184071e+00 -3.21356351e+01 -2.05864972e+02 -8.52249863e+02
       3.80920147e+03 -4.87715502e+03]] [[-6.24225627e+01 -4.47131524e-01  1.59128167e+00 -3.64856925e+00
       4.96916970e+00 -2.82831448e+00]
     [ 6.24955287e+03 -5.89914825e+01 -1.45159740e+01  3.70708340e+01
      -5.58194281e+01  3.62550731e+01]
     [ 1.59128167e+00  6.23548403e+03  4.22507011e+00 -1.86843665e+02
       3.10503091e+02 -2.31952804e+02]
     [-3.64856925e+00  3.70708340e+01  6.06315634e+03  5.11898007e+02
      -1.06838824e+03  9.48504586e+02]
     [ 4.96916970e+00 -5.58194281e+01  3.10503091e+02  5.18161176e+03
       2.25135211e+03 -2.65502670e+03]
     [-2.82831448e+00  3.62550731e+01 -2.31952804e+02  9.48504586e+02
       3.59497330e+03  5.01874364e+03]]
    [[-6.25623412e+01 -3.37174853e-01 -1.18147548e+00 -2.75833410e+00
      -3.96708529e+00 -2.53184071e+00]
     [ 6.24966283e+03 -6.50718700e+01 -1.06323006e+01 -2.78307802e+01
      -4.43415891e+01 -3.21356351e+01]
     [-1.18147548e+00  6.23936770e+03 -1.11670149e+02 -1.41503895e+02
      -2.48639508e+02 -2.05864972e+02]
     [-2.75833410e+00 -2.78307802e+01  6.10849610e+03 -5.09392662e+02
      -8.75264939e+02 -8.52249863e+02]
     [-3.96708529e+00 -4.43415891e+01 -2.48639508e+02  5.37473506e+03
      -2.03895274e+03 -2.44079853e+03]
     [-2.53184071e+00 -3.21356351e+01 -2.05864972e+02 -8.52249863e+02
       3.80920147e+03 -4.87715502e+03]] [[-6.24225627e+01 -4.47131524e-01  1.59128167e+00 -3.64856925e+00
       4.96916970e+00 -2.82831448e+00]
     [ 6.24955287e+03 -5.89914825e+01 -1.45159740e+01  3.70708340e+01
      -5.58194281e+01  3.62550731e+01]
     [ 1.59128167e+00  6.23548403e+03  4.22507011e+00 -1.86843665e+02
       3.10503091e+02 -2.31952804e+02]
     [-3.64856925e+00  3.70708340e+01  6.06315634e+03  5.11898007e+02
      -1.06838824e+03  9.48504586e+02]
     [ 4.96916970e+00 -5.58194281e+01  3.10503091e+02  5.18161176e+03
       2.25135211e+03 -2.65502670e+03]
     [-2.82831448e+00  3.62550731e+01 -2.31952804e+02  9.48504586e+02
       3.59497330e+03  5.01874364e+03]]





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  40.713 seconds)


.. _sphx_glr_download_auto_examples_b_general_plot_b_FIR_Filtering.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_b_FIR_Filtering.py <plot_b_FIR_Filtering.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_b_FIR_Filtering.ipynb <plot_b_FIR_Filtering.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
