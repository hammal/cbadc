
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "tutorials/a_getting_started/plot_b_simulate_a_control_bounded_adc.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_tutorials_a_getting_started_plot_b_simulate_a_control_bounded_adc.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_tutorials_a_getting_started_plot_b_simulate_a_control_bounded_adc.py:


Simulating a Control-Bounded ADC
================================

This example shows how to simulate the interactions between an analog system
and a digital control while the former is excited by an analog signal.

.. GENERATED FROM PYTHON SOURCE LINES 8-12

.. code-block:: default

    import matplotlib.pyplot as plt
    import cbadc
    import numpy as np








.. GENERATED FROM PYTHON SOURCE LINES 13-25

The Analog System
-----------------

.. image:: /images/chainOfIntegratorsGeneral.svg
   :width: 500
   :align: center
   :alt: The chain of integrators ADC.

First, we have to decide on an analog system. For this tutorial, we will
commit to a chain-of-integrators ADC,
see :py:class:`cbadc.analog_system.ChainOfIntegrators`, as our analog
system.

.. GENERATED FROM PYTHON SOURCE LINES 25-43

.. code-block:: default


    # We fix the number of analog states.
    N = 6
    # Set the amplification factor.
    beta = 6250.0
    rho = -1e-2
    kappa = -1.0
    # In this example, each nodes amplification and local feedback will be set
    # identically.
    betaVec = beta * np.ones(N)
    rhoVec = betaVec * rho
    kappaVec = kappa * beta * np.eye(N)

    # Instantiate a chain-of-integrators analog system.
    analog_system = cbadc.analog_system.ChainOfIntegrators(betaVec, rhoVec, kappaVec)
    # print the analog system such that we can very it being correctly initalized.
    print(analog_system)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    The analog system is parameterized as:
    A =
    [[ -62.5    0.     0.     0.     0.     0. ]
     [6250.   -62.5    0.     0.     0.     0. ]
     [   0.  6250.   -62.5    0.     0.     0. ]
     [   0.     0.  6250.   -62.5    0.     0. ]
     [   0.     0.     0.  6250.   -62.5    0. ]
     [   0.     0.     0.     0.  6250.   -62.5]],
    B =
    [[6250.]
     [   0.]
     [   0.]
     [   0.]
     [   0.]
     [   0.]],
    CT =
    [[1. 0. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0. 0.]
     [0. 0. 1. 0. 0. 0.]
     [0. 0. 0. 1. 0. 0.]
     [0. 0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 0. 1.]],
    Gamma =
    [[-6250.    -0.    -0.    -0.    -0.    -0.]
     [   -0. -6250.    -0.    -0.    -0.    -0.]
     [   -0.    -0. -6250.    -0.    -0.    -0.]
     [   -0.    -0.    -0. -6250.    -0.    -0.]
     [   -0.    -0.    -0.    -0. -6250.    -0.]
     [   -0.    -0.    -0.    -0.    -0. -6250.]],
    Gamma_tildeT =
    [[1. 0. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0. 0.]
     [0. 0. 1. 0. 0. 0.]
     [0. 0. 0. 1. 0. 0.]
     [0. 0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 0. 1.]], and D=[[0.]
     [0.]
     [0.]
     [0.]
     [0.]
     [0.]]




.. GENERATED FROM PYTHON SOURCE LINES 44-50

The Digital Control
-------------------

In addition to the analog system, our simulation will require us to specify a
digital control. For this tutorial, we will use
:py:class:`cbadc.digital_control.DigitalControl`.

.. GENERATED FROM PYTHON SOURCE LINES 50-63

.. code-block:: default


    # Set the time period which determines how often the digital control updates.
    T = 1.0 / (2 * beta)
    # Instantiate a corresponding clock.
    clock = cbadc.analog_signal.Clock(T)
    # Set the number of digital controls to be same as analog states.
    M = N
    # Initialize the digital control.
    digital_control = cbadc.digital_control.DigitalControl(clock, M)
    # print the digital control to verify proper initialization.
    print(digital_control)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    ================================================================================

    The Digital Control is parameterized as:

    --------------------------------------------------------------------------------

    clock:
    Analog signal returns constant 0, i.e., maps t |-> 0.

    M:
    6
    ================================================================================





.. GENERATED FROM PYTHON SOURCE LINES 64-71

The Analog Signal
-----------------

The final and third component of the simulation is an analog signal.
For this tutorial, we will choose a
:py:class:`cbadc.analog_signal.Sinusoidal`. Again, this is one of several
possible choices.

.. GENERATED FROM PYTHON SOURCE LINES 71-87

.. code-block:: default


    # Set the peak amplitude.
    amplitude = 0.5
    # Choose the sinusoidal frequency via an oversampling ratio (OSR).
    OSR = 1 << 9
    frequency = 1.0 / (T * OSR)

    # We also specify a phase an offset these are hovewer optional.
    phase = np.pi / 3
    offset = 0.0

    # Instantiate the analog signal
    analog_signal = cbadc.analog_signal.Sinusoidal(amplitude, frequency, phase, offset)
    # print to ensure correct parametrization.
    print(analog_signal)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    Sinusoidal parameterized as:
    amplitude = 0.5,
    frequency = 24.414062499999996,
    phase = 1.0471975511965976,
    and
    offset = 0.0





.. GENERATED FROM PYTHON SOURCE LINES 88-96

Simulating
-------------

Next, we set up the simulator. Here we use the
:py:class:`cbadc.simulator.StateSpaceSimulator` for simulating the
involved differential equations as outlined in
:py:class:`cbadc.analog_system.AnalogSystem`.


.. GENERATED FROM PYTHON SOURCE LINES 96-122

.. code-block:: default


    # Simulate for 2^18 control cycles.
    size = 1 << 18
    end_time = T * size

    # Instantiate the simulator.
    simulator = cbadc.simulator.get_simulator(
        analog_system,
        digital_control,
        [analog_signal],
        t_stop=end_time,
    )
    # Depending on your analog system the step above might take some time to
    # compute as it involves precomputing solutions to initial value problems.

    # Let's print the first 20 control decisions.
    index = 0
    for s in cbadc.utilities.show_status(simulator):
        if index > 19:
            break
        print(f"step:{index} -> s:{np.array(s)}")
        index += 1

    # To verify the simulation parametrization we can
    print(simulator)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    0it [00:00, ?it/s]step:0 -> s:[False False False False False False]
    step:1 -> s:[ True False False False False False]
    step:2 -> s:[ True  True  True  True  True False]
    step:3 -> s:[False  True  True False False  True]
    step:4 -> s:[ True False False  True False False]
    step:5 -> s:[ True  True  True False  True  True]
    step:6 -> s:[ True  True False False False False]
    step:7 -> s:[False False  True  True  True  True]
    step:8 -> s:[ True  True False False False False]
    step:9 -> s:[ True False False  True  True  True]
    step:10 -> s:[False  True  True False False False]
    step:11 -> s:[ True False  True  True  True  True]
    step:12 -> s:[ True  True False False False  True]
    step:13 -> s:[ True  True  True  True  True False]
    step:14 -> s:[False False  True  True  True  True]
    step:15 -> s:[ True  True False False False False]
    step:16 -> s:[ True  True  True  True False False]
    step:17 -> s:[ True False False False  True  True]
    step:18 -> s:[False  True  True  True False False]
    step:19 -> s:[ True False  True False  True  True]
    20it [00:00, 1668.08it/s]
    ================================================================================

    The Simulator is parameterized by the:

    --------------------------------------------------------------------------------

    Analog System:
    The analog system is parameterized as:
    A =
    [[ -62.5    0.     0.     0.     0.     0. ]
     [6250.   -62.5    0.     0.     0.     0. ]
     [   0.  6250.   -62.5    0.     0.     0. ]
     [   0.     0.  6250.   -62.5    0.     0. ]
     [   0.     0.     0.  6250.   -62.5    0. ]
     [   0.     0.     0.     0.  6250.   -62.5]],
    B =
    [[6250.]
     [   0.]
     [   0.]
     [   0.]
     [   0.]
     [   0.]],
    CT =
    [[1. 0. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0. 0.]
     [0. 0. 1. 0. 0. 0.]
     [0. 0. 0. 1. 0. 0.]
     [0. 0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 0. 1.]],
    Gamma =
    [[-6250.    -0.    -0.    -0.    -0.    -0.]
     [   -0. -6250.    -0.    -0.    -0.    -0.]
     [   -0.    -0. -6250.    -0.    -0.    -0.]
     [   -0.    -0.    -0. -6250.    -0.    -0.]
     [   -0.    -0.    -0.    -0. -6250.    -0.]
     [   -0.    -0.    -0.    -0.    -0. -6250.]],
    Gamma_tildeT =
    [[1. 0. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0. 0.]
     [0. 0. 1. 0. 0. 0.]
     [0. 0. 0. 1. 0. 0.]
     [0. 0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 0. 1.]], and D=[[0.]
     [0.]
     [0.]
     [0.]
     [0.]
     [0.]]

    Digital Control:
    ================================================================================

    The Digital Control is parameterized as:

    --------------------------------------------------------------------------------

    clock:
    Analog signal returns constant 0, i.e., maps t |-> 0.

    M:
    6
    ================================================================================


    Input signals:

    Sinusoidal parameterized as:
    amplitude = 0.5,
    frequency = 24.414062499999996,
    phase = 1.0471975511965976,
    and
    offset = 0.0


    Clock:
    Analog signal returns constant 0, i.e., maps t |-> 0.

    t_stop:
    20.97152

    --------------------------------------------------------------------------------

    Currently the

    state vector is:
    [ 0.31088358  0.68412769 -0.26065674  0.30000479 -0.25529448 -0.18194049]

    t:
    0.00168

    --------------------------------------------------------------------------------


            ================================================================================

    atol, rtol:
    1e-09, 1e-06

    Pre computed transition matrix:
    [[9.95012479e-01 0.00000000e+00 0.00000000e+00 0.00000000e+00
      0.00000000e+00 0.00000000e+00]
     [4.97506240e-01 9.95012479e-01 0.00000000e+00 0.00000000e+00
      0.00000000e+00 0.00000000e+00]
     [1.24376560e-01 4.97506240e-01 9.95012479e-01 0.00000000e+00
      0.00000000e+00 0.00000000e+00]
     [2.07294266e-02 1.24376560e-01 4.97506240e-01 9.95012479e-01
      0.00000000e+00 0.00000000e+00]
     [2.59117833e-03 2.07294266e-02 1.24376560e-01 4.97506240e-01
      9.95012479e-01 0.00000000e+00]
     [2.59117833e-04 2.59117833e-03 2.07294266e-02 1.24376560e-01
      4.97506240e-01 9.95012479e-01]]

    Pre-computed control matrix
    [[-4.98752081e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00
       0.00000000e+00  0.00000000e+00]
     [-1.24584114e-01 -4.98752081e-01  0.00000000e+00  0.00000000e+00
       0.00000000e+00  0.00000000e+00]
     [-2.07553644e-02 -1.24584114e-01 -4.98752081e-01  0.00000000e+00
       0.00000000e+00  0.00000000e+00]
     [-2.59377167e-03 -2.07553644e-02 -1.24584114e-01 -4.98752081e-01
       0.00000000e+00  0.00000000e+00]
     [-2.59333919e-04 -2.59377167e-03 -2.07553644e-02 -1.24584114e-01
      -4.98752081e-01  0.00000000e+00]
     [-2.16085865e-05 -2.59333919e-04 -2.59377167e-03 -2.07553644e-02
      -1.24584114e-01 -4.98752081e-01]]






.. GENERATED FROM PYTHON SOURCE LINES 123-156

Tracking the Analog State Vector
--------------------------------

Clearly the output type of the generator simulator above is the sequence of
control signals s[k]. Sometimes we are interested in also monitoring the
internal states of analog system during simulation.

To this end we use the
:func:`cbadc.simulator.StateSpaceSimulator.state_vector` and an
:func:`cbadc.simulator.extended_simulation_result`.

Note that the :func:`cbadc.simulator.extended_simulation_result` is
defined like this

.. code-block:: python

  def extended_simulation_result(simulator):
      for control_signal in simulator:
          analog_state = simulator.state_vector()
          yield {
              'control_signal': np.array(control_signal),
              'analog_state': np.array(analog_state)
          }

So, in essence, we are creating a new generator from the old with an extended
output.

.. note:: The convenience function extended_simulation_result is one of many
          such convenience functions found in the
          :py:mod:`cbadc.simulator` module.

We can achieve this by appending yet another generator to the control signal
stream as:

.. GENERATED FROM PYTHON SOURCE LINES 156-167

.. code-block:: default


    # Repeating the steps above we now get for the following
    # ten control cycles.

    ext_simulator = cbadc.simulator.extended_simulation_result(simulator)
    for res in cbadc.utilities.show_status(ext_simulator):
        if index > 29:
            break
        print(f"step:{index} -> s:{res['control_signal']}, x:{res['analog_state']}")
        index += 1





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    0it [00:00, ?it/s]step:20 -> s:[ True  True  True False  True  True], x:[ 0.05159004  0.27221522  0.48310161 -0.13590092  0.26999601  0.33062399]
    step:21 -> s:[False False False  True False False], x:[-0.20564243 -0.26644966 -0.01150043  0.4921246  -0.13074995 -0.14831513]
    step:22 -> s:[ True  True  True  True  True  True], x:[0.53664362 0.31645391 0.48459546 0.09698686 0.50515305 0.45306839]
    step:23 -> s:[ True  True  True False False  True], x:[ 0.27841825  0.01924489  0.0723844  -0.25734544 -0.0277104   0.07823707]
    step:24 -> s:[ True False False  True  True False], x:[ 0.02213905 -0.40478456 -0.5177235   0.14020087  0.45437455 -0.32260124]
    step:25 -> s:[False  True False False False  True], x:[-0.2322404   0.04346129 -0.10102201 -0.52269172 -0.15098648  0.26697905]
    step:26 -> s:[ True False  True  True  True False], x:[ 0.51273777 -0.3852722   0.29733466  0.03669568  0.21934301 -0.22756746]
    step:27 -> s:[ True  True False False False  True], x:[ 0.257044    0.30723824 -0.21675873 -0.45674966 -0.37480055  0.24362145]
    step:28 -> s:[ True False  True  True  True False], x:[ 0.00313634 -0.1282895   0.33279546  0.08249745  0.02127452 -0.35558787]
    step:29 -> s:[False  True False False False  True], x:[-0.24903117  0.30965837 -0.11696502 -0.37213025 -0.54067685  0.02466487]
    10it [00:00, 1748.28it/s]




.. GENERATED FROM PYTHON SOURCE LINES 168-182

.. _default_simulation:

--------------------------------
Saving to File
--------------------------------

In general, simulating the analog system and digital control interaction
is a computationally much more intense procedure compared to the digital
estimation step. This is one reason, and there are more, why
you would want to store the intermediate control signal sequence to a file.

For this purpose use the
:func:`cbadc.utilities.control_signal_2_byte_stream` and
:func:`cbadc.utilities.write_byte_stream_to_file` functions.

.. GENERATED FROM PYTHON SOURCE LINES 182-208

.. code-block:: default


    # Instantiate a new simulator and control.
    simulator = cbadc.simulator.get_simulator(
        analog_system,
        digital_control,
        [analog_signal],
        t_stop=end_time,
    )

    # Construct byte stream.
    byte_stream = cbadc.utilities.control_signal_2_byte_stream(simulator, M)


    def print_next_10_bytes(stream):
        global index
        for byte in cbadc.utilities.show_status(stream, size):
            if index < 40:
                print(f"{index} -> {byte}")
                index += 1
            yield byte


    cbadc.utilities.write_byte_stream_to_file(
        "sinusoidal_simulation.dat", print_next_10_bytes(byte_stream)
    )





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    0it [00:00, ?it/s]30 -> b'\r'
    31 -> b'\r'
    32 -> b'\r'
    33 -> b'\r'
    34 -> b'\r'
    35 -> b'\r'
    36 -> b'\r'
    37 -> b'\r'
    38 -> b'\r'
    39 -> b'\r'
      0%|          | 244/262144 [00:00<01:47, 2433.98it/s]      0%|          | 491/262144 [00:00<01:46, 2452.68it/s]      0%|          | 740/262144 [00:00<01:45, 2466.14it/s]      0%|          | 988/262144 [00:00<01:45, 2468.17it/s]      0%|          | 1235/262144 [00:00<01:46, 2451.81it/s]      1%|          | 1484/262144 [00:00<01:45, 2464.49it/s]      1%|          | 1745/262144 [00:00<01:43, 2509.13it/s]      1%|          | 1997/262144 [00:00<01:43, 2511.57it/s]      1%|          | 2249/262144 [00:00<01:43, 2503.44it/s]      1%|          | 2502/262144 [00:01<01:43, 2510.32it/s]      1%|1         | 2754/262144 [00:01<01:43, 2503.14it/s]      1%|1         | 3008/262144 [00:01<01:43, 2512.80it/s]      1%|1         | 3261/262144 [00:01<01:42, 2515.46it/s]      1%|1         | 3516/262144 [00:01<01:42, 2523.39it/s]      1%|1         | 3770/262144 [00:01<01:42, 2527.26it/s]      2%|1         | 4024/262144 [00:01<01:42, 2528.95it/s]      2%|1         | 4277/262144 [00:01<01:42, 2520.88it/s]      2%|1         | 4530/262144 [00:01<01:42, 2519.44it/s]      2%|1         | 4794/262144 [00:01<01:40, 2554.39it/s]      2%|1         | 5064/262144 [00:02<01:39, 2596.11it/s]      2%|2         | 5332/262144 [00:02<01:38, 2620.44it/s]      2%|2         | 5595/262144 [00:02<01:38, 2609.99it/s]      2%|2         | 5864/262144 [00:02<01:37, 2630.72it/s]      2%|2         | 6131/262144 [00:02<01:36, 2641.68it/s]      2%|2         | 6400/262144 [00:02<01:36, 2653.20it/s]      3%|2         | 6670/262144 [00:02<01:35, 2664.25it/s]      3%|2         | 6938/262144 [00:02<01:35, 2666.65it/s]      3%|2         | 7205/262144 [00:02<01:36, 2630.99it/s]      3%|2         | 7469/262144 [00:02<01:36, 2629.94it/s]      3%|2         | 7734/262144 [00:03<01:36, 2633.99it/s]      3%|3         | 7998/262144 [00:03<01:36, 2632.41it/s]      3%|3         | 8262/262144 [00:03<01:37, 2606.45it/s]      3%|3         | 8523/262144 [00:03<01:37, 2599.77it/s]      3%|3         | 8790/262144 [00:03<01:36, 2619.28it/s]      3%|3         | 9060/262144 [00:03<01:35, 2641.65it/s]      4%|3         | 9330/262144 [00:03<01:35, 2658.18it/s]      4%|3         | 9602/262144 [00:03<01:34, 2674.22it/s]      4%|3         | 9871/262144 [00:03<01:34, 2677.15it/s]      4%|3         | 10144/262144 [00:03<01:33, 2692.22it/s]      4%|3         | 10420/262144 [00:04<01:32, 2711.99it/s]      4%|4         | 10695/262144 [00:04<01:32, 2721.04it/s]      4%|4         | 10968/262144 [00:04<01:32, 2719.22it/s]      4%|4         | 11240/262144 [00:04<01:32, 2715.89it/s]      4%|4         | 11512/262144 [00:04<01:32, 2711.97it/s]      4%|4         | 11784/262144 [00:04<01:32, 2708.25it/s]      5%|4         | 12055/262144 [00:04<01:32, 2699.32it/s]      5%|4         | 12325/262144 [00:04<01:32, 2695.35it/s]      5%|4         | 12595/262144 [00:04<01:32, 2691.61it/s]      5%|4         | 12865/262144 [00:04<01:32, 2689.61it/s]      5%|5         | 13134/262144 [00:05<01:32, 2679.87it/s]      5%|5         | 13402/262144 [00:05<01:32, 2677.70it/s]      5%|5         | 13670/262144 [00:05<01:33, 2669.99it/s]      5%|5         | 13938/262144 [00:05<01:32, 2671.09it/s]      5%|5         | 14207/262144 [00:05<01:32, 2674.94it/s]      6%|5         | 14476/262144 [00:05<01:32, 2677.65it/s]      6%|5         | 14747/262144 [00:05<01:32, 2686.50it/s]      6%|5         | 15018/262144 [00:05<01:31, 2692.26it/s]      6%|5         | 15290/262144 [00:05<01:31, 2699.77it/s]      6%|5         | 15561/262144 [00:05<01:31, 2701.40it/s]      6%|6         | 15832/262144 [00:06<01:31, 2697.41it/s]      6%|6         | 16102/262144 [00:06<01:31, 2693.66it/s]      6%|6         | 16372/262144 [00:06<01:31, 2687.35it/s]      6%|6         | 16641/262144 [00:06<01:31, 2685.90it/s]      6%|6         | 16910/262144 [00:06<01:31, 2679.69it/s]      7%|6         | 17178/262144 [00:06<01:31, 2676.84it/s]      7%|6         | 17446/262144 [00:06<01:31, 2672.11it/s]      7%|6         | 17714/262144 [00:06<01:32, 2630.86it/s]      7%|6         | 17978/262144 [00:06<01:32, 2627.18it/s]      7%|6         | 18241/262144 [00:06<01:32, 2623.60it/s]      7%|7         | 18505/262144 [00:07<01:32, 2625.85it/s]      7%|7         | 18768/262144 [00:07<01:32, 2622.17it/s]      7%|7         | 19031/262144 [00:07<01:32, 2622.14it/s]      7%|7         | 19294/262144 [00:07<01:33, 2604.02it/s]      7%|7         | 19558/262144 [00:07<01:32, 2612.22it/s]      8%|7         | 19826/262144 [00:07<01:32, 2629.86it/s]      8%|7         | 20095/262144 [00:07<01:31, 2646.37it/s]      8%|7         | 20364/262144 [00:07<01:30, 2658.63it/s]      8%|7         | 20636/262144 [00:07<01:30, 2674.95it/s]      8%|7         | 20909/262144 [00:07<01:29, 2690.51it/s]      8%|8         | 21179/262144 [00:08<01:30, 2670.13it/s]      8%|8         | 21450/262144 [00:08<01:29, 2680.79it/s]      8%|8         | 21719/262144 [00:08<01:29, 2683.06it/s]      8%|8         | 21988/262144 [00:08<01:29, 2683.42it/s]      8%|8         | 22257/262144 [00:08<01:29, 2682.10it/s]      9%|8         | 22526/262144 [00:08<01:29, 2679.59it/s]      9%|8         | 22795/262144 [00:08<01:29, 2679.50it/s]      9%|8         | 23063/262144 [00:08<01:29, 2674.70it/s]      9%|8         | 23331/262144 [00:08<01:29, 2672.07it/s]      9%|9         | 23599/262144 [00:08<01:29, 2669.81it/s]      9%|9         | 23867/262144 [00:09<01:29, 2670.16it/s]      9%|9         | 24135/262144 [00:09<01:29, 2668.15it/s]      9%|9         | 24402/262144 [00:09<01:29, 2668.47it/s]      9%|9         | 24670/262144 [00:09<01:28, 2671.75it/s]     10%|9         | 24938/262144 [00:09<01:29, 2663.12it/s]     10%|9         | 25205/262144 [00:09<01:29, 2654.11it/s]     10%|9         | 25471/262144 [00:09<01:29, 2651.69it/s]     10%|9         | 25737/262144 [00:09<01:29, 2650.91it/s]     10%|9         | 26003/262144 [00:09<01:29, 2652.49it/s]     10%|#         | 26269/262144 [00:09<01:28, 2653.73it/s]     10%|#         | 26541/262144 [00:10<01:28, 2672.98it/s]     10%|#         | 26815/262144 [00:10<01:27, 2691.50it/s]     10%|#         | 27085/262144 [00:10<01:27, 2684.58it/s]     10%|#         | 27354/262144 [00:10<01:27, 2671.87it/s]     11%|#         | 27622/262144 [00:10<01:28, 2662.62it/s]     11%|#         | 27889/262144 [00:10<01:28, 2653.52it/s]     11%|#         | 28155/262144 [00:10<01:28, 2647.03it/s]     11%|#         | 28420/262144 [00:10<01:28, 2643.43it/s]     11%|#         | 28685/262144 [00:10<01:28, 2636.04it/s]     11%|#1        | 28949/262144 [00:10<01:28, 2634.03it/s]     11%|#1        | 29213/262144 [00:11<01:28, 2632.84it/s]     11%|#1        | 29477/262144 [00:11<01:28, 2633.47it/s]     11%|#1        | 29741/262144 [00:11<01:28, 2630.50it/s]     11%|#1        | 30005/262144 [00:11<01:28, 2630.37it/s]     12%|#1        | 30269/262144 [00:11<01:28, 2630.61it/s]     12%|#1        | 30533/262144 [00:11<01:28, 2628.96it/s]     12%|#1        | 30797/262144 [00:11<01:27, 2629.88it/s]     12%|#1        | 31060/262144 [00:11<01:27, 2629.65it/s]     12%|#1        | 31324/262144 [00:11<01:27, 2632.30it/s]     12%|#2        | 31588/262144 [00:11<01:27, 2633.26it/s]     12%|#2        | 31852/262144 [00:12<01:27, 2635.01it/s]     12%|#2        | 32117/262144 [00:12<01:27, 2636.44it/s]     12%|#2        | 32383/262144 [00:12<01:26, 2642.28it/s]     12%|#2        | 32654/262144 [00:12<01:26, 2660.35it/s]     13%|#2        | 32927/262144 [00:12<01:25, 2679.86it/s]     13%|#2        | 33202/262144 [00:12<01:24, 2699.60it/s]     13%|#2        | 33476/262144 [00:12<01:24, 2711.35it/s]     13%|#2        | 33748/262144 [00:12<01:24, 2712.42it/s]     13%|#2        | 34020/262144 [00:12<01:24, 2696.74it/s]     13%|#3        | 34290/262144 [00:12<01:24, 2694.37it/s]     13%|#3        | 34560/262144 [00:13<01:24, 2693.49it/s]     13%|#3        | 34830/262144 [00:13<01:24, 2683.03it/s]     13%|#3        | 35099/262144 [00:13<01:25, 2667.15it/s]     13%|#3        | 35367/262144 [00:13<01:24, 2668.65it/s]     14%|#3        | 35636/262144 [00:13<01:24, 2672.57it/s]     14%|#3        | 35904/262144 [00:13<01:24, 2674.16it/s]     14%|#3        | 36172/262144 [00:13<01:24, 2675.10it/s]     14%|#3        | 36441/262144 [00:13<01:24, 2678.64it/s]     14%|#4        | 36711/262144 [00:13<01:24, 2683.20it/s]     14%|#4        | 36981/262144 [00:13<01:23, 2685.78it/s]     14%|#4        | 37250/262144 [00:14<01:23, 2681.26it/s]     14%|#4        | 37521/262144 [00:14<01:23, 2689.11it/s]     14%|#4        | 37794/262144 [00:14<01:23, 2700.39it/s]     15%|#4        | 38070/262144 [00:14<01:22, 2716.13it/s]     15%|#4        | 38343/262144 [00:14<01:22, 2718.99it/s]     15%|#4        | 38615/262144 [00:14<01:22, 2714.66it/s]     15%|#4        | 38887/262144 [00:14<01:22, 2710.23it/s]     15%|#4        | 39159/262144 [00:14<01:22, 2703.93it/s]     15%|#5        | 39430/262144 [00:14<01:22, 2699.68it/s]     15%|#5        | 39700/262144 [00:14<01:22, 2688.94it/s]     15%|#5        | 39969/262144 [00:15<01:23, 2667.31it/s]     15%|#5        | 40236/262144 [00:15<01:23, 2652.43it/s]     15%|#5        | 40502/262144 [00:15<01:24, 2636.46it/s]     16%|#5        | 40766/262144 [00:15<01:24, 2631.68it/s]     16%|#5        | 41030/262144 [00:15<01:24, 2630.01it/s]     16%|#5        | 41294/262144 [00:15<01:24, 2628.68it/s]     16%|#5        | 41558/262144 [00:15<01:23, 2629.87it/s]     16%|#5        | 41823/262144 [00:15<01:23, 2633.12it/s]     16%|#6        | 42087/262144 [00:15<01:23, 2633.85it/s]     16%|#6        | 42351/262144 [00:15<01:23, 2635.65it/s]     16%|#6        | 42615/262144 [00:16<01:23, 2636.36it/s]     16%|#6        | 42879/262144 [00:16<01:23, 2634.56it/s]     16%|#6        | 43143/262144 [00:16<01:23, 2635.61it/s]     17%|#6        | 43408/262144 [00:16<01:22, 2638.93it/s]     17%|#6        | 43674/262144 [00:16<01:22, 2643.07it/s]     17%|#6        | 43940/262144 [00:16<01:22, 2647.90it/s]     17%|#6        | 44208/262144 [00:16<01:22, 2655.91it/s]     17%|#6        | 44475/262144 [00:16<01:21, 2658.10it/s]     17%|#7        | 44741/262144 [00:16<01:21, 2658.32it/s]     17%|#7        | 45007/262144 [00:17<01:21, 2654.59it/s]     17%|#7        | 45273/262144 [00:17<01:21, 2651.21it/s]     17%|#7        | 45539/262144 [00:17<01:21, 2648.67it/s]     17%|#7        | 45806/262144 [00:17<01:21, 2652.58it/s]     18%|#7        | 46075/262144 [00:17<01:21, 2662.69it/s]     18%|#7        | 46344/262144 [00:17<01:20, 2670.40it/s]     18%|#7        | 46612/262144 [00:17<01:20, 2672.29it/s]     18%|#7        | 46881/262144 [00:17<01:20, 2674.35it/s]     18%|#7        | 47149/262144 [00:17<01:20, 2675.19it/s]     18%|#8        | 47418/262144 [00:17<01:20, 2676.59it/s]     18%|#8        | 47686/262144 [00:18<01:20, 2677.53it/s]     18%|#8        | 47955/262144 [00:18<01:19, 2678.94it/s]     18%|#8        | 48225/262144 [00:18<01:19, 2684.50it/s]     18%|#8        | 48494/262144 [00:18<01:19, 2677.62it/s]     19%|#8        | 48762/262144 [00:18<01:20, 2664.58it/s]     19%|#8        | 49029/262144 [00:18<01:20, 2659.85it/s]     19%|#8        | 49295/262144 [00:18<01:20, 2656.54it/s]     19%|#8        | 49562/262144 [00:18<01:19, 2658.72it/s]     19%|#9        | 49829/262144 [00:18<01:19, 2660.26it/s]     19%|#9        | 50098/262144 [00:18<01:19, 2667.23it/s]     19%|#9        | 50365/262144 [00:19<01:19, 2666.45it/s]     19%|#9        | 50632/262144 [00:19<01:19, 2664.00it/s]     19%|#9        | 50899/262144 [00:19<01:19, 2659.07it/s]     20%|#9        | 51165/262144 [00:19<01:19, 2653.80it/s]     20%|#9        | 51431/262144 [00:19<01:19, 2649.45it/s]     20%|#9        | 51696/262144 [00:19<01:19, 2642.69it/s]     20%|#9        | 51961/262144 [00:19<01:19, 2641.53it/s]     20%|#9        | 52226/262144 [00:19<01:19, 2639.56it/s]     20%|##        | 52490/262144 [00:19<01:19, 2637.58it/s]     20%|##        | 52754/262144 [00:19<01:19, 2634.72it/s]     20%|##        | 53018/262144 [00:20<01:19, 2633.50it/s]     20%|##        | 53286/262144 [00:20<01:18, 2645.91it/s]     20%|##        | 53554/262144 [00:20<01:18, 2654.83it/s]     21%|##        | 53820/262144 [00:20<01:18, 2649.26it/s]     21%|##        | 54085/262144 [00:20<01:18, 2642.13it/s]     21%|##        | 54350/262144 [00:20<01:18, 2638.87it/s]     21%|##        | 54614/262144 [00:20<01:18, 2637.98it/s]     21%|##        | 54878/262144 [00:20<01:18, 2638.44it/s]     21%|##1       | 55142/262144 [00:20<01:18, 2638.50it/s]     21%|##1       | 55406/262144 [00:20<01:18, 2638.12it/s]     21%|##1       | 55671/262144 [00:21<01:18, 2638.75it/s]     21%|##1       | 55936/262144 [00:21<01:18, 2641.01it/s]     21%|##1       | 56202/262144 [00:21<01:17, 2644.10it/s]     22%|##1       | 56467/262144 [00:21<01:17, 2645.12it/s]     22%|##1       | 56735/262144 [00:21<01:17, 2653.14it/s]     22%|##1       | 57004/262144 [00:21<01:17, 2662.80it/s]     22%|##1       | 57272/262144 [00:21<01:16, 2667.94it/s]     22%|##1       | 57539/262144 [00:21<01:16, 2665.99it/s]     22%|##2       | 57806/262144 [00:21<01:16, 2664.13it/s]     22%|##2       | 58073/262144 [00:21<01:16, 2660.80it/s]     22%|##2       | 58340/262144 [00:22<01:16, 2656.78it/s]     22%|##2       | 58606/262144 [00:22<01:16, 2653.18it/s]     22%|##2       | 58872/262144 [00:22<01:16, 2650.23it/s]     23%|##2       | 59139/262144 [00:22<01:16, 2654.65it/s]     23%|##2       | 59408/262144 [00:22<01:16, 2663.17it/s]     23%|##2       | 59677/262144 [00:22<01:15, 2669.14it/s]     23%|##2       | 59946/262144 [00:22<01:15, 2673.28it/s]     23%|##2       | 60215/262144 [00:22<01:15, 2677.19it/s]     23%|##3       | 60484/262144 [00:22<01:15, 2678.18it/s]     23%|##3       | 60753/262144 [00:22<01:15, 2681.42it/s]     23%|##3       | 61023/262144 [00:23<01:14, 2685.03it/s]     23%|##3       | 61292/262144 [00:23<01:14, 2686.25it/s]     23%|##3       | 61563/262144 [00:23<01:14, 2690.92it/s]     24%|##3       | 61835/262144 [00:23<01:14, 2698.93it/s]     24%|##3       | 62109/262144 [00:23<01:13, 2709.20it/s]     24%|##3       | 62386/262144 [00:23<01:13, 2725.94it/s]     24%|##3       | 62661/262144 [00:23<01:13, 2731.29it/s]     24%|##4       | 62935/262144 [00:23<01:13, 2724.90it/s]     24%|##4       | 63208/262144 [00:23<01:13, 2717.02it/s]     24%|##4       | 63480/262144 [00:23<01:13, 2702.98it/s]     24%|##4       | 63751/262144 [00:24<01:13, 2690.39it/s]     24%|##4       | 64021/262144 [00:24<01:14, 2667.56it/s]     25%|##4       | 64288/262144 [00:24<01:14, 2651.59it/s]     25%|##4       | 64554/262144 [00:24<01:14, 2636.51it/s]     25%|##4       | 64819/262144 [00:24<01:14, 2640.07it/s]     25%|##4       | 65084/262144 [00:24<01:14, 2633.64it/s]     25%|##4       | 65348/262144 [00:24<01:14, 2627.00it/s]     25%|##5       | 65611/262144 [00:24<01:14, 2621.38it/s]     25%|##5       | 65874/262144 [00:24<01:14, 2619.36it/s]     25%|##5       | 66136/262144 [00:24<01:15, 2600.43it/s]     25%|##5       | 66400/262144 [00:25<01:14, 2611.41it/s]     25%|##5       | 66662/262144 [00:25<01:15, 2597.01it/s]     26%|##5       | 66926/262144 [00:25<01:14, 2607.88it/s]     26%|##5       | 67189/262144 [00:25<01:14, 2612.40it/s]     26%|##5       | 67452/262144 [00:25<01:14, 2616.59it/s]     26%|##5       | 67715/262144 [00:25<01:14, 2618.95it/s]     26%|##5       | 67978/262144 [00:25<01:14, 2621.48it/s]     26%|##6       | 68246/262144 [00:25<01:13, 2636.58it/s]     26%|##6       | 68516/262144 [00:25<01:12, 2655.34it/s]     26%|##6       | 68789/262144 [00:25<01:12, 2676.25it/s]     26%|##6       | 69058/262144 [00:26<01:12, 2679.73it/s]     26%|##6       | 69328/262144 [00:26<01:11, 2683.24it/s]     27%|##6       | 69597/262144 [00:26<01:11, 2679.11it/s]     27%|##6       | 69865/262144 [00:26<01:11, 2675.43it/s]     27%|##6       | 70133/262144 [00:26<01:11, 2675.13it/s]     27%|##6       | 70401/262144 [00:26<01:11, 2675.17it/s]     27%|##6       | 70669/262144 [00:26<01:11, 2670.00it/s]     27%|##7       | 70937/262144 [00:26<01:11, 2666.01it/s]     27%|##7       | 71204/262144 [00:26<01:11, 2661.19it/s]     27%|##7       | 71472/262144 [00:26<01:11, 2663.44it/s]     27%|##7       | 71740/262144 [00:27<01:11, 2668.38it/s]     27%|##7       | 72007/262144 [00:27<01:11, 2651.83it/s]     28%|##7       | 72273/262144 [00:27<01:11, 2641.61it/s]     28%|##7       | 72543/262144 [00:27<01:11, 2656.19it/s]     28%|##7       | 72814/262144 [00:27<01:10, 2669.69it/s]     28%|##7       | 73083/262144 [00:27<01:10, 2674.04it/s]     28%|##7       | 73352/262144 [00:27<01:10, 2676.48it/s]     28%|##8       | 73620/262144 [00:27<01:10, 2672.27it/s]     28%|##8       | 73888/262144 [00:27<01:10, 2666.45it/s]     28%|##8       | 74157/262144 [00:27<01:10, 2672.03it/s]     28%|##8       | 74425/262144 [00:28<01:10, 2669.99it/s]     28%|##8       | 74693/262144 [00:28<01:10, 2659.35it/s]     29%|##8       | 74959/262144 [00:28<01:10, 2648.06it/s]     29%|##8       | 75224/262144 [00:28<01:10, 2642.45it/s]     29%|##8       | 75489/262144 [00:28<01:10, 2637.24it/s]     29%|##8       | 75753/262144 [00:28<01:10, 2627.21it/s]     29%|##8       | 76016/262144 [00:28<01:11, 2596.38it/s]     29%|##9       | 76276/262144 [00:28<01:12, 2576.50it/s]     29%|##9       | 76534/262144 [00:28<01:12, 2577.21it/s]     29%|##9       | 76793/262144 [00:28<01:11, 2580.17it/s]     29%|##9       | 77057/262144 [00:29<01:11, 2597.20it/s]     29%|##9       | 77317/262144 [00:29<01:11, 2589.66it/s]     30%|##9       | 77576/262144 [00:29<01:11, 2584.65it/s]     30%|##9       | 77840/262144 [00:29<01:10, 2598.71it/s]     30%|##9       | 78104/262144 [00:29<01:10, 2608.23it/s]     30%|##9       | 78369/262144 [00:29<01:10, 2620.38it/s]     30%|##9       | 78635/262144 [00:29<01:09, 2628.85it/s]     30%|###       | 78901/262144 [00:29<01:09, 2635.61it/s]     30%|###       | 79167/262144 [00:29<01:09, 2642.31it/s]     30%|###       | 79434/262144 [00:29<01:08, 2649.32it/s]     30%|###       | 79699/262144 [00:30<01:08, 2645.21it/s]     31%|###       | 79964/262144 [00:30<01:08, 2646.45it/s]     31%|###       | 80233/262144 [00:30<01:08, 2658.67it/s]     31%|###       | 80499/262144 [00:30<01:08, 2653.67it/s]     31%|###       | 80765/262144 [00:30<01:08, 2645.66it/s]     31%|###       | 81030/262144 [00:30<01:08, 2645.26it/s]     31%|###1      | 81295/262144 [00:30<01:08, 2641.21it/s]     31%|###1      | 81560/262144 [00:30<01:08, 2638.78it/s]     31%|###1      | 81824/262144 [00:30<01:08, 2637.98it/s]     31%|###1      | 82089/262144 [00:30<01:08, 2640.54it/s]     31%|###1      | 82354/262144 [00:31<01:08, 2641.09it/s]     32%|###1      | 82619/262144 [00:31<01:08, 2639.41it/s]     32%|###1      | 82883/262144 [00:31<01:08, 2634.23it/s]     32%|###1      | 83147/262144 [00:31<01:07, 2632.94it/s]     32%|###1      | 83413/262144 [00:31<01:07, 2638.43it/s]     32%|###1      | 83677/262144 [00:31<01:07, 2635.95it/s]     32%|###2      | 83941/262144 [00:31<01:07, 2627.70it/s]     32%|###2      | 84204/262144 [00:31<01:07, 2621.87it/s]     32%|###2      | 84467/262144 [00:31<01:07, 2619.96it/s]     32%|###2      | 84729/262144 [00:31<01:07, 2619.84it/s]     32%|###2      | 84993/262144 [00:32<01:07, 2625.44it/s]     33%|###2      | 85256/262144 [00:32<01:09, 2559.43it/s]     33%|###2      | 85513/262144 [00:32<01:09, 2527.48it/s]     33%|###2      | 85767/262144 [00:32<01:09, 2529.37it/s]     33%|###2      | 86021/262144 [00:32<01:09, 2523.88it/s]     33%|###2      | 86274/262144 [00:32<01:10, 2496.63it/s]     33%|###3      | 86524/262144 [00:32<01:10, 2480.73it/s]     33%|###3      | 86773/262144 [00:32<01:10, 2473.00it/s]     33%|###3      | 87028/262144 [00:32<01:10, 2494.17it/s]     33%|###3      | 87284/262144 [00:33<01:09, 2512.11it/s]     33%|###3      | 87546/262144 [00:33<01:08, 2541.26it/s]     33%|###3      | 87809/262144 [00:33<01:07, 2567.01it/s]     34%|###3      | 88073/262144 [00:33<01:07, 2585.41it/s]     34%|###3      | 88338/262144 [00:33<01:06, 2603.82it/s]     34%|###3      | 88603/262144 [00:33<01:06, 2616.99it/s]     34%|###3      | 88866/262144 [00:33<01:06, 2620.73it/s]     34%|###4      | 89129/262144 [00:33<01:06, 2614.65it/s]     34%|###4      | 89398/262144 [00:33<01:05, 2634.09it/s]     34%|###4      | 89665/262144 [00:33<01:05, 2642.20it/s]     34%|###4      | 89930/262144 [00:34<01:05, 2627.35it/s]     34%|###4      | 90193/262144 [00:34<01:05, 2613.07it/s]     35%|###4      | 90455/262144 [00:34<01:05, 2606.78it/s]     35%|###4      | 90716/262144 [00:34<01:05, 2601.68it/s]     35%|###4      | 90978/262144 [00:34<01:05, 2606.46it/s]     35%|###4      | 91242/262144 [00:34<01:05, 2615.01it/s]     35%|###4      | 91504/262144 [00:34<01:05, 2610.76it/s]     35%|###5      | 91767/262144 [00:34<01:05, 2615.40it/s]     35%|###5      | 92030/262144 [00:34<01:04, 2618.91it/s]     35%|###5      | 92293/262144 [00:34<01:04, 2621.94it/s]     35%|###5      | 92556/262144 [00:35<01:04, 2624.11it/s]     35%|###5      | 92820/262144 [00:35<01:04, 2626.54it/s]     36%|###5      | 93086/262144 [00:35<01:04, 2634.23it/s]     36%|###5      | 93353/262144 [00:35<01:03, 2643.17it/s]     36%|###5      | 93626/262144 [00:35<01:03, 2667.98it/s]     36%|###5      | 93899/262144 [00:35<01:02, 2685.50it/s]     36%|###5      | 94169/262144 [00:35<01:02, 2687.17it/s]     36%|###6      | 94438/262144 [00:35<01:02, 2670.25it/s]     36%|###6      | 94706/262144 [00:35<01:02, 2659.64it/s]     36%|###6      | 94974/262144 [00:35<01:02, 2663.42it/s]     36%|###6      | 95242/262144 [00:36<01:02, 2668.11it/s]     36%|###6      | 95509/262144 [00:36<01:02, 2666.98it/s]     37%|###6      | 95776/262144 [00:36<01:02, 2658.17it/s]     37%|###6      | 96042/262144 [00:36<01:02, 2644.07it/s]     37%|###6      | 96307/262144 [00:36<01:02, 2641.74it/s]     37%|###6      | 96572/262144 [00:36<01:02, 2638.94it/s]     37%|###6      | 96837/262144 [00:36<01:02, 2642.12it/s]     37%|###7      | 97103/262144 [00:36<01:02, 2646.36it/s]     37%|###7      | 97371/262144 [00:36<01:02, 2654.01it/s]     37%|###7      | 97637/262144 [00:36<01:02, 2651.15it/s]     37%|###7      | 97905/262144 [00:37<01:01, 2659.50it/s]     37%|###7      | 98173/262144 [00:37<01:01, 2664.47it/s]     38%|###7      | 98440/262144 [00:37<01:01, 2654.83it/s]     38%|###7      | 98706/262144 [00:37<01:02, 2619.65it/s]     38%|###7      | 98969/262144 [00:37<01:03, 2587.21it/s]     38%|###7      | 99228/262144 [00:37<01:03, 2585.94it/s]     38%|###7      | 99495/262144 [00:37<01:02, 2609.03it/s]     38%|###8      | 99760/262144 [00:37<01:01, 2619.80it/s]     38%|###8      | 100026/262144 [00:37<01:01, 2630.26it/s]     38%|###8      | 100294/262144 [00:37<01:01, 2644.81it/s]     38%|###8      | 100563/262144 [00:38<01:00, 2657.92it/s]     38%|###8      | 100833/262144 [00:38<01:00, 2668.91it/s]     39%|###8      | 101100/262144 [00:38<01:00, 2659.28it/s]     39%|###8      | 101366/262144 [00:38<01:00, 2649.49it/s]     39%|###8      | 101631/262144 [00:38<01:00, 2644.32it/s]     39%|###8      | 101898/262144 [00:38<01:00, 2651.95it/s]     39%|###8      | 102165/262144 [00:38<01:00, 2657.31it/s]     39%|###9      | 102431/262144 [00:38<01:00, 2652.45it/s]     39%|###9      | 102697/262144 [00:38<01:00, 2640.92it/s]     39%|###9      | 102963/262144 [00:38<01:00, 2644.95it/s]     39%|###9      | 103230/262144 [00:39<00:59, 2651.73it/s]     39%|###9      | 103497/262144 [00:39<00:59, 2656.58it/s]     40%|###9      | 103765/262144 [00:39<00:59, 2660.56it/s]     40%|###9      | 104033/262144 [00:39<00:59, 2665.98it/s]     40%|###9      | 104301/262144 [00:39<00:59, 2668.99it/s]     40%|###9      | 104568/262144 [00:39<00:59, 2662.10it/s]     40%|###9      | 104838/262144 [00:39<00:58, 2670.71it/s]     40%|####      | 105106/262144 [00:39<00:58, 2666.60it/s]     40%|####      | 105377/262144 [00:39<00:58, 2677.81it/s]     40%|####      | 105650/262144 [00:39<00:58, 2692.63it/s]     40%|####      | 105922/262144 [00:40<00:57, 2700.74it/s]     41%|####      | 106193/262144 [00:40<00:57, 2693.08it/s]     41%|####      | 106463/262144 [00:40<00:58, 2675.24it/s]     41%|####      | 106731/262144 [00:40<00:58, 2664.55it/s]     41%|####      | 106999/262144 [00:40<00:58, 2667.12it/s]     41%|####      | 107267/262144 [00:40<00:58, 2669.69it/s]     41%|####1     | 107534/262144 [00:40<00:57, 2669.36it/s]     41%|####1     | 107801/262144 [00:40<00:57, 2668.33it/s]     41%|####1     | 108068/262144 [00:40<00:57, 2666.48it/s]     41%|####1     | 108335/262144 [00:40<00:57, 2664.44it/s]     41%|####1     | 108602/262144 [00:41<00:57, 2663.53it/s]     42%|####1     | 108869/262144 [00:41<00:57, 2665.18it/s]     42%|####1     | 109136/262144 [00:41<00:57, 2664.64it/s]     42%|####1     | 109403/262144 [00:41<00:57, 2648.98it/s]     42%|####1     | 109669/262144 [00:41<00:57, 2650.17it/s]     42%|####1     | 109936/262144 [00:41<00:57, 2654.42it/s]     42%|####2     | 110202/262144 [00:41<00:57, 2654.26it/s]     42%|####2     | 110469/262144 [00:41<00:57, 2656.35it/s]     42%|####2     | 110736/262144 [00:41<00:56, 2660.18it/s]     42%|####2     | 111003/262144 [00:41<00:56, 2661.95it/s]     42%|####2     | 111271/262144 [00:42<00:56, 2665.70it/s]     43%|####2     | 111543/262144 [00:42<00:56, 2679.99it/s]     43%|####2     | 111813/262144 [00:42<00:56, 2684.38it/s]     43%|####2     | 112082/262144 [00:42<00:55, 2681.33it/s]     43%|####2     | 112351/262144 [00:42<00:56, 2670.84it/s]     43%|####2     | 112619/262144 [00:42<00:56, 2651.27it/s]     43%|####3     | 112885/262144 [00:42<00:56, 2648.56it/s]     43%|####3     | 113150/262144 [00:42<00:56, 2636.48it/s]     43%|####3     | 113414/262144 [00:42<00:56, 2625.62it/s]     43%|####3     | 113677/262144 [00:42<00:56, 2624.23it/s]     43%|####3     | 113943/262144 [00:43<00:56, 2631.79it/s]     44%|####3     | 114207/262144 [00:43<00:56, 2628.55it/s]     44%|####3     | 114475/262144 [00:43<00:55, 2643.55it/s]     44%|####3     | 114743/262144 [00:43<00:55, 2650.97it/s]     44%|####3     | 115009/262144 [00:43<00:55, 2643.92it/s]     44%|####3     | 115274/262144 [00:43<00:55, 2632.38it/s]     44%|####4     | 115538/262144 [00:43<00:55, 2627.39it/s]     44%|####4     | 115801/262144 [00:43<00:55, 2625.79it/s]     44%|####4     | 116064/262144 [00:43<00:55, 2617.38it/s]     44%|####4     | 116326/262144 [00:43<00:55, 2615.12it/s]     44%|####4     | 116588/262144 [00:44<00:55, 2610.42it/s]     45%|####4     | 116850/262144 [00:44<00:55, 2606.07it/s]     45%|####4     | 117111/262144 [00:44<00:55, 2597.32it/s]     45%|####4     | 117372/262144 [00:44<00:55, 2599.64it/s]     45%|####4     | 117638/262144 [00:44<00:55, 2617.36it/s]     45%|####4     | 117903/262144 [00:44<00:54, 2625.22it/s]     45%|####5     | 118175/262144 [00:44<00:54, 2653.41it/s]     45%|####5     | 118450/262144 [00:44<00:53, 2682.07it/s]     45%|####5     | 118724/262144 [00:44<00:53, 2698.07it/s]     45%|####5     | 118995/262144 [00:44<00:52, 2701.35it/s]     45%|####5     | 119266/262144 [00:45<00:52, 2703.49it/s]     46%|####5     | 119537/262144 [00:45<00:53, 2689.54it/s]     46%|####5     | 119806/262144 [00:45<00:53, 2666.13it/s]     46%|####5     | 120073/262144 [00:45<00:54, 2624.16it/s]     46%|####5     | 120336/262144 [00:45<00:54, 2601.21it/s]     46%|####6     | 120597/262144 [00:45<00:54, 2591.57it/s]     46%|####6     | 120857/262144 [00:45<00:54, 2575.22it/s]     46%|####6     | 121115/262144 [00:45<00:55, 2544.73it/s]     46%|####6     | 121376/262144 [00:45<00:54, 2563.32it/s]     46%|####6     | 121639/262144 [00:46<00:54, 2582.94it/s]     47%|####6     | 121903/262144 [00:46<00:53, 2597.65it/s]     47%|####6     | 122167/262144 [00:46<00:53, 2608.86it/s]     47%|####6     | 122431/262144 [00:46<00:53, 2616.75it/s]     47%|####6     | 122693/262144 [00:46<00:53, 2615.38it/s]     47%|####6     | 122955/262144 [00:46<00:53, 2601.47it/s]     47%|####7     | 123220/262144 [00:46<00:53, 2613.03it/s]     47%|####7     | 123485/262144 [00:46<00:52, 2622.57it/s]     47%|####7     | 123748/262144 [00:46<00:52, 2624.39it/s]     47%|####7     | 124012/262144 [00:46<00:52, 2628.46it/s]     47%|####7     | 124275/262144 [00:47<00:52, 2626.27it/s]     48%|####7     | 124538/262144 [00:47<00:52, 2625.81it/s]     48%|####7     | 124801/262144 [00:47<00:52, 2627.02it/s]     48%|####7     | 125066/262144 [00:47<00:52, 2631.46it/s]     48%|####7     | 125330/262144 [00:47<00:52, 2630.50it/s]     48%|####7     | 125594/262144 [00:47<00:52, 2606.12it/s]     48%|####8     | 125855/262144 [00:47<00:52, 2596.78it/s]     48%|####8     | 126115/262144 [00:47<00:52, 2592.86it/s]     48%|####8     | 126381/262144 [00:47<00:51, 2611.42it/s]     48%|####8     | 126644/262144 [00:47<00:51, 2616.79it/s]     48%|####8     | 126913/262144 [00:48<00:51, 2636.47it/s]     49%|####8     | 127179/262144 [00:48<00:51, 2641.96it/s]     49%|####8     | 127445/262144 [00:48<00:50, 2645.07it/s]     49%|####8     | 127710/262144 [00:48<00:50, 2642.68it/s]     49%|####8     | 127975/262144 [00:48<00:50, 2635.57it/s]     49%|####8     | 128241/262144 [00:48<00:50, 2641.77it/s]     49%|####9     | 128506/262144 [00:48<00:50, 2640.84it/s]     49%|####9     | 128771/262144 [00:48<00:50, 2634.49it/s]     49%|####9     | 129035/262144 [00:48<00:50, 2630.31it/s]     49%|####9     | 129299/262144 [00:48<00:50, 2625.83it/s]     49%|####9     | 129564/262144 [00:49<00:50, 2630.53it/s]     50%|####9     | 129828/262144 [00:49<00:50, 2625.82it/s]     50%|####9     | 130091/262144 [00:49<00:50, 2624.01it/s]     50%|####9     | 130354/262144 [00:49<00:50, 2623.71it/s]     50%|####9     | 130617/262144 [00:49<00:50, 2621.74it/s]     50%|####9     | 130882/262144 [00:49<00:49, 2629.61it/s]     50%|#####     | 131145/262144 [00:49<00:49, 2626.40it/s]     50%|#####     | 131408/262144 [00:49<00:49, 2625.15it/s]     50%|#####     | 131671/262144 [00:49<00:49, 2626.10it/s]     50%|#####     | 131934/262144 [00:49<00:49, 2626.34it/s]     50%|#####     | 132198/262144 [00:50<00:49, 2628.24it/s]     51%|#####     | 132463/262144 [00:50<00:49, 2633.54it/s]     51%|#####     | 132727/262144 [00:50<00:49, 2631.67it/s]     51%|#####     | 132992/262144 [00:50<00:49, 2634.66it/s]     51%|#####     | 133256/262144 [00:50<00:48, 2635.89it/s]     51%|#####     | 133520/262144 [00:50<00:48, 2632.82it/s]     51%|#####1    | 133785/262144 [00:50<00:48, 2636.15it/s]     51%|#####1    | 134056/262144 [00:50<00:48, 2657.47it/s]     51%|#####1    | 134322/262144 [00:50<00:48, 2658.13it/s]     51%|#####1    | 134588/262144 [00:50<00:48, 2654.05it/s]     51%|#####1    | 134854/262144 [00:51<00:47, 2655.67it/s]     52%|#####1    | 135120/262144 [00:51<00:47, 2650.23it/s]     52%|#####1    | 135386/262144 [00:51<00:47, 2643.15it/s]     52%|#####1    | 135651/262144 [00:51<00:47, 2638.51it/s]     52%|#####1    | 135915/262144 [00:51<00:47, 2636.08it/s]     52%|#####1    | 136180/262144 [00:51<00:47, 2637.25it/s]     52%|#####2    | 136444/262144 [00:51<00:47, 2638.05it/s]     52%|#####2    | 136709/262144 [00:51<00:47, 2638.84it/s]     52%|#####2    | 136973/262144 [00:51<00:47, 2637.76it/s]     52%|#####2    | 137237/262144 [00:51<00:47, 2635.26it/s]     52%|#####2    | 137501/262144 [00:52<00:47, 2634.22it/s]     53%|#####2    | 137765/262144 [00:52<00:47, 2633.05it/s]     53%|#####2    | 138029/262144 [00:52<00:47, 2631.50it/s]     53%|#####2    | 138293/262144 [00:52<00:47, 2630.19it/s]     53%|#####2    | 138557/262144 [00:52<00:46, 2630.49it/s]     53%|#####2    | 138821/262144 [00:52<00:46, 2630.98it/s]     53%|#####3    | 139085/262144 [00:52<00:46, 2629.69it/s]     53%|#####3    | 139349/262144 [00:52<00:46, 2630.71it/s]     53%|#####3    | 139613/262144 [00:52<00:46, 2632.10it/s]     53%|#####3    | 139878/262144 [00:52<00:46, 2634.92it/s]     53%|#####3    | 140142/262144 [00:53<00:46, 2636.07it/s]     54%|#####3    | 140406/262144 [00:53<00:46, 2636.99it/s]     54%|#####3    | 140672/262144 [00:53<00:45, 2641.35it/s]     54%|#####3    | 140938/262144 [00:53<00:45, 2644.41it/s]     54%|#####3    | 141204/262144 [00:53<00:45, 2647.99it/s]     54%|#####3    | 141470/262144 [00:53<00:45, 2650.03it/s]     54%|#####4    | 141738/262144 [00:53<00:45, 2658.13it/s]     54%|#####4    | 142006/262144 [00:53<00:45, 2664.46it/s]     54%|#####4    | 142273/262144 [00:53<00:44, 2664.10it/s]     54%|#####4    | 142540/262144 [00:53<00:44, 2662.30it/s]     54%|#####4    | 142807/262144 [00:54<00:44, 2660.43it/s]     55%|#####4    | 143074/262144 [00:54<00:44, 2656.88it/s]     55%|#####4    | 143340/262144 [00:54<00:44, 2651.10it/s]     55%|#####4    | 143606/262144 [00:54<00:44, 2647.14it/s]     55%|#####4    | 143871/262144 [00:54<00:44, 2647.15it/s]     55%|#####4    | 144136/262144 [00:54<00:44, 2644.50it/s]     55%|#####5    | 144401/262144 [00:54<00:44, 2639.37it/s]     55%|#####5    | 144665/262144 [00:54<00:44, 2637.91it/s]     55%|#####5    | 144929/262144 [00:54<00:44, 2634.94it/s]     55%|#####5    | 145193/262144 [00:54<00:44, 2634.48it/s]     55%|#####5    | 145461/262144 [00:55<00:44, 2646.55it/s]     56%|#####5    | 145729/262144 [00:55<00:43, 2654.50it/s]     56%|#####5    | 145997/262144 [00:55<00:43, 2660.29it/s]     56%|#####5    | 146264/262144 [00:55<00:43, 2660.68it/s]     56%|#####5    | 146531/262144 [00:55<00:43, 2651.15it/s]     56%|#####5    | 146797/262144 [00:55<00:43, 2646.21it/s]     56%|#####6    | 147062/262144 [00:55<00:43, 2641.34it/s]     56%|#####6    | 147327/262144 [00:55<00:43, 2642.01it/s]     56%|#####6    | 147592/262144 [00:55<00:43, 2642.04it/s]     56%|#####6    | 147857/262144 [00:55<00:43, 2643.09it/s]     57%|#####6    | 148123/262144 [00:56<00:43, 2647.39it/s]     57%|#####6    | 148389/262144 [00:56<00:42, 2649.92it/s]     57%|#####6    | 148657/262144 [00:56<00:42, 2657.34it/s]     57%|#####6    | 148923/262144 [00:56<00:42, 2656.85it/s]     57%|#####6    | 149190/262144 [00:56<00:42, 2659.55it/s]     57%|#####7    | 149456/262144 [00:56<00:42, 2652.97it/s]     57%|#####7    | 149722/262144 [00:56<00:42, 2649.22it/s]     57%|#####7    | 149987/262144 [00:56<00:42, 2647.52it/s]     57%|#####7    | 150252/262144 [00:56<00:42, 2641.92it/s]     57%|#####7    | 150517/262144 [00:56<00:42, 2641.22it/s]     58%|#####7    | 150782/262144 [00:57<00:42, 2639.92it/s]     58%|#####7    | 151046/262144 [00:57<00:42, 2638.71it/s]     58%|#####7    | 151310/262144 [00:57<00:42, 2634.60it/s]     58%|#####7    | 151574/262144 [00:57<00:41, 2633.76it/s]     58%|#####7    | 151842/262144 [00:57<00:41, 2644.92it/s]     58%|#####8    | 152107/262144 [00:57<00:41, 2640.30it/s]     58%|#####8    | 152372/262144 [00:57<00:41, 2638.02it/s]     58%|#####8    | 152636/262144 [00:57<00:41, 2636.60it/s]     58%|#####8    | 152900/262144 [00:57<00:41, 2635.76it/s]     58%|#####8    | 153164/262144 [00:57<00:41, 2634.24it/s]     59%|#####8    | 153428/262144 [00:58<00:41, 2635.07it/s]     59%|#####8    | 153693/262144 [00:58<00:41, 2636.81it/s]     59%|#####8    | 153960/262144 [00:58<00:40, 2645.57it/s]     59%|#####8    | 154226/262144 [00:58<00:40, 2647.46it/s]     59%|#####8    | 154491/262144 [00:58<00:40, 2648.13it/s]     59%|#####9    | 154763/262144 [00:58<00:40, 2668.35it/s]     59%|#####9    | 155036/262144 [00:58<00:39, 2685.77it/s]     59%|#####9    | 155309/262144 [00:58<00:39, 2698.51it/s]     59%|#####9    | 155579/262144 [00:58<00:39, 2696.02it/s]     59%|#####9    | 155849/262144 [00:58<00:39, 2687.74it/s]     60%|#####9    | 156118/262144 [00:59<00:39, 2678.97it/s]     60%|#####9    | 156386/262144 [00:59<00:39, 2670.22it/s]     60%|#####9    | 156654/262144 [00:59<00:39, 2663.23it/s]     60%|#####9    | 156921/262144 [00:59<00:39, 2664.98it/s]     60%|#####9    | 157188/262144 [00:59<00:39, 2658.94it/s]     60%|######    | 157454/262144 [00:59<00:39, 2649.89it/s]     60%|######    | 157719/262144 [00:59<00:39, 2645.37it/s]     60%|######    | 157984/262144 [00:59<00:39, 2643.10it/s]     60%|######    | 158249/262144 [00:59<00:39, 2640.27it/s]     60%|######    | 158514/262144 [00:59<00:39, 2639.70it/s]     61%|######    | 158779/262144 [01:00<00:39, 2642.33it/s]     61%|######    | 159047/262144 [01:00<00:38, 2652.94it/s]     61%|######    | 159315/262144 [01:00<00:38, 2660.51it/s]     61%|######    | 159582/262144 [01:00<00:38, 2662.73it/s]     61%|######    | 159849/262144 [01:00<00:38, 2657.04it/s]     61%|######1   | 160115/262144 [01:00<00:38, 2655.27it/s]     61%|######1   | 160386/262144 [01:00<00:38, 2669.96it/s]     61%|######1   | 160654/262144 [01:00<00:38, 2670.73it/s]     61%|######1   | 160922/262144 [01:00<00:37, 2671.87it/s]     61%|######1   | 161190/262144 [01:00<00:37, 2673.47it/s]     62%|######1   | 161460/262144 [01:01<00:37, 2679.51it/s]     62%|######1   | 161728/262144 [01:01<00:37, 2677.28it/s]     62%|######1   | 161996/262144 [01:01<00:37, 2674.76it/s]     62%|######1   | 162264/262144 [01:01<00:37, 2668.76it/s]     62%|######2   | 162531/262144 [01:01<00:37, 2665.65it/s]     62%|######2   | 162798/262144 [01:01<00:37, 2659.69it/s]     62%|######2   | 163064/262144 [01:01<00:37, 2657.42it/s]     62%|######2   | 163330/262144 [01:01<00:37, 2652.93it/s]     62%|######2   | 163596/262144 [01:01<00:37, 2648.74it/s]     63%|######2   | 163861/262144 [01:01<00:37, 2648.05it/s]     63%|######2   | 164126/262144 [01:02<00:37, 2645.00it/s]     63%|######2   | 164391/262144 [01:02<00:36, 2642.97it/s]     63%|######2   | 164656/262144 [01:02<00:37, 2632.91it/s]     63%|######2   | 164921/262144 [01:02<00:36, 2635.46it/s]     63%|######3   | 165185/262144 [01:02<00:36, 2630.71it/s]     63%|######3   | 165449/262144 [01:02<00:36, 2628.59it/s]     63%|######3   | 165712/262144 [01:02<00:36, 2627.74it/s]     63%|######3   | 165976/262144 [01:02<00:36, 2629.95it/s]     63%|######3   | 166240/262144 [01:02<00:36, 2630.13it/s]     64%|######3   | 166504/262144 [01:02<00:36, 2630.83it/s]     64%|######3   | 166768/262144 [01:03<00:36, 2633.40it/s]     64%|######3   | 167032/262144 [01:03<00:36, 2634.38it/s]     64%|######3   | 167297/262144 [01:03<00:35, 2638.50it/s]     64%|######3   | 167562/262144 [01:03<00:35, 2639.71it/s]     64%|######4   | 167828/262144 [01:03<00:35, 2643.89it/s]     64%|######4   | 168093/262144 [01:03<00:35, 2645.31it/s]     64%|######4   | 168360/262144 [01:03<00:35, 2651.77it/s]     64%|######4   | 168627/262144 [01:03<00:35, 2657.08it/s]     64%|######4   | 168894/262144 [01:03<00:35, 2658.99it/s]     65%|######4   | 169160/262144 [01:03<00:34, 2658.59it/s]     65%|######4   | 169426/262144 [01:04<00:34, 2655.29it/s]     65%|######4   | 169692/262144 [01:04<00:34, 2653.24it/s]     65%|######4   | 169958/262144 [01:04<00:34, 2647.86it/s]     65%|######4   | 170223/262144 [01:04<00:34, 2644.22it/s]     65%|######5   | 170488/262144 [01:04<00:34, 2641.83it/s]     65%|######5   | 170753/262144 [01:04<00:34, 2639.13it/s]     65%|######5   | 171017/262144 [01:04<00:34, 2637.01it/s]     65%|######5   | 171281/262144 [01:04<00:34, 2633.80it/s]     65%|######5   | 171545/262144 [01:04<00:34, 2630.73it/s]     66%|######5   | 171810/262144 [01:04<00:34, 2635.31it/s]     66%|######5   | 172076/262144 [01:05<00:34, 2640.68it/s]     66%|######5   | 172341/262144 [01:05<00:34, 2640.43it/s]     66%|######5   | 172606/262144 [01:05<00:33, 2638.48it/s]     66%|######5   | 172870/262144 [01:05<00:33, 2634.97it/s]     66%|######6   | 173135/262144 [01:05<00:33, 2636.51it/s]     66%|######6   | 173400/262144 [01:05<00:33, 2638.13it/s]     66%|######6   | 173665/262144 [01:05<00:33, 2640.80it/s]     66%|######6   | 173930/262144 [01:05<00:33, 2643.04it/s]     66%|######6   | 174195/262144 [01:05<00:33, 2643.56it/s]     67%|######6   | 174461/262144 [01:05<00:33, 2646.01it/s]     67%|######6   | 174727/262144 [01:06<00:33, 2648.79it/s]     67%|######6   | 174994/262144 [01:06<00:32, 2653.03it/s]     67%|######6   | 175261/262144 [01:06<00:32, 2656.68it/s]     67%|######6   | 175530/262144 [01:06<00:32, 2664.55it/s]     67%|######7   | 175799/262144 [01:06<00:32, 2671.31it/s]     67%|######7   | 176067/262144 [01:06<00:32, 2671.21it/s]     67%|######7   | 176335/262144 [01:06<00:32, 2668.30it/s]     67%|######7   | 176602/262144 [01:06<00:32, 2666.05it/s]     67%|######7   | 176869/262144 [01:06<00:32, 2660.80it/s]     68%|######7   | 177136/262144 [01:06<00:32, 2655.98it/s]     68%|######7   | 177402/262144 [01:07<00:31, 2652.31it/s]     68%|######7   | 177668/262144 [01:07<00:31, 2651.25it/s]     68%|######7   | 177934/262144 [01:07<00:31, 2643.63it/s]     68%|######7   | 178199/262144 [01:07<00:31, 2638.01it/s]     68%|######8   | 178463/262144 [01:07<00:31, 2631.93it/s]     68%|######8   | 178727/262144 [01:07<00:31, 2619.14it/s]     68%|######8   | 178989/262144 [01:07<00:31, 2608.39it/s]     68%|######8   | 179250/262144 [01:07<00:31, 2600.22it/s]     68%|######8   | 179516/262144 [01:07<00:31, 2615.74it/s]     69%|######8   | 179781/262144 [01:08<00:31, 2625.21it/s]     69%|######8   | 180044/262144 [01:08<00:31, 2619.25it/s]     69%|######8   | 180308/262144 [01:08<00:31, 2622.69it/s]     69%|######8   | 180577/262144 [01:08<00:30, 2641.15it/s]     69%|######8   | 180847/262144 [01:08<00:30, 2656.62it/s]     69%|######9   | 181118/262144 [01:08<00:30, 2671.62it/s]     69%|######9   | 181386/262144 [01:08<00:30, 2673.94it/s]     69%|######9   | 181659/262144 [01:08<00:29, 2690.20it/s]     69%|######9   | 181934/262144 [01:08<00:29, 2707.87it/s]     70%|######9   | 182209/262144 [01:08<00:29, 2718.71it/s]     70%|######9   | 182482/262144 [01:09<00:29, 2720.27it/s]     70%|######9   | 182755/262144 [01:09<00:29, 2715.18it/s]     70%|######9   | 183027/262144 [01:09<00:29, 2702.97it/s]     70%|######9   | 183298/262144 [01:09<00:29, 2695.49it/s]     70%|#######   | 183568/262144 [01:09<00:29, 2685.28it/s]     70%|#######   | 183837/262144 [01:09<00:29, 2677.42it/s]     70%|#######   | 184105/262144 [01:09<00:29, 2671.98it/s]     70%|#######   | 184373/262144 [01:09<00:29, 2667.62it/s]     70%|#######   | 184640/262144 [01:09<00:29, 2665.39it/s]     71%|#######   | 184907/262144 [01:09<00:28, 2665.98it/s]     71%|#######   | 185174/262144 [01:10<00:28, 2662.00it/s]     71%|#######   | 185442/262144 [01:10<00:28, 2665.70it/s]     71%|#######   | 185710/262144 [01:10<00:28, 2668.38it/s]     71%|#######   | 185979/262144 [01:10<00:28, 2672.44it/s]     71%|#######1  | 186247/262144 [01:10<00:28, 2672.92it/s]     71%|#######1  | 186515/262144 [01:10<00:28, 2660.49it/s]     71%|#######1  | 186782/262144 [01:10<00:28, 2652.42it/s]     71%|#######1  | 187048/262144 [01:10<00:28, 2650.16it/s]     71%|#######1  | 187314/262144 [01:10<00:28, 2650.05it/s]     72%|#######1  | 187580/262144 [01:10<00:28, 2645.94it/s]     72%|#######1  | 187845/262144 [01:11<00:28, 2644.17it/s]     72%|#######1  | 188110/262144 [01:11<00:28, 2640.05it/s]     72%|#######1  | 188375/262144 [01:11<00:27, 2635.55it/s]     72%|#######1  | 188639/262144 [01:11<00:27, 2632.54it/s]     72%|#######2  | 188903/262144 [01:11<00:27, 2627.48it/s]     72%|#######2  | 189166/262144 [01:11<00:27, 2627.55it/s]     72%|#######2  | 189429/262144 [01:11<00:27, 2623.96it/s]     72%|#######2  | 189692/262144 [01:11<00:27, 2621.49it/s]     72%|#######2  | 189955/262144 [01:11<00:27, 2622.38it/s]     73%|#######2  | 190218/262144 [01:11<00:27, 2618.80it/s]     73%|#######2  | 190480/262144 [01:12<00:27, 2616.48it/s]     73%|#######2  | 190742/262144 [01:12<00:27, 2614.48it/s]     73%|#######2  | 191004/262144 [01:12<00:27, 2612.72it/s]     73%|#######2  | 191266/262144 [01:12<00:27, 2610.57it/s]     73%|#######3  | 191529/262144 [01:12<00:27, 2615.36it/s]     73%|#######3  | 191796/262144 [01:12<00:26, 2629.55it/s]     73%|#######3  | 192063/262144 [01:12<00:26, 2638.85it/s]     73%|#######3  | 192331/262144 [01:12<00:26, 2650.70it/s]     73%|#######3  | 192597/262144 [01:12<00:26, 2650.35it/s]     74%|#######3  | 192865/262144 [01:12<00:26, 2656.58it/s]     74%|#######3  | 193133/262144 [01:13<00:25, 2662.04it/s]     74%|#######3  | 193402/262144 [01:13<00:25, 2668.07it/s]     74%|#######3  | 193671/262144 [01:13<00:25, 2674.20it/s]     74%|#######3  | 193941/262144 [01:13<00:25, 2681.37it/s]     74%|#######4  | 194212/262144 [01:13<00:25, 2689.88it/s]     74%|#######4  | 194486/262144 [01:13<00:25, 2702.94it/s]     74%|#######4  | 194757/262144 [01:13<00:24, 2703.01it/s]     74%|#######4  | 195028/262144 [01:13<00:24, 2699.88it/s]     75%|#######4  | 195298/262144 [01:13<00:24, 2694.42it/s]     75%|#######4  | 195568/262144 [01:13<00:24, 2687.85it/s]     75%|#######4  | 195837/262144 [01:14<00:24, 2683.45it/s]     75%|#######4  | 196106/262144 [01:14<00:24, 2679.98it/s]     75%|#######4  | 196375/262144 [01:14<00:24, 2675.03it/s]     75%|#######5  | 196643/262144 [01:14<00:24, 2671.69it/s]     75%|#######5  | 196911/262144 [01:14<00:24, 2672.54it/s]     75%|#######5  | 197180/262144 [01:14<00:24, 2675.94it/s]     75%|#######5  | 197448/262144 [01:14<00:24, 2674.95it/s]     75%|#######5  | 197716/262144 [01:14<00:24, 2673.43it/s]     76%|#######5  | 197984/262144 [01:14<00:24, 2657.15it/s]     76%|#######5  | 198250/262144 [01:14<00:24, 2597.85it/s]     76%|#######5  | 198511/262144 [01:15<00:24, 2572.55it/s]     76%|#######5  | 198772/262144 [01:15<00:24, 2581.26it/s]     76%|#######5  | 199031/262144 [01:15<00:24, 2570.79it/s]     76%|#######6  | 199294/262144 [01:15<00:24, 2588.18it/s]     76%|#######6  | 199554/262144 [01:15<00:24, 2591.52it/s]     76%|#######6  | 199818/262144 [01:15<00:23, 2603.43it/s]     76%|#######6  | 200081/262144 [01:15<00:23, 2611.23it/s]     76%|#######6  | 200343/262144 [01:15<00:23, 2607.95it/s]     77%|#######6  | 200609/262144 [01:15<00:23, 2621.27it/s]     77%|#######6  | 200875/262144 [01:15<00:23, 2631.62it/s]     77%|#######6  | 201142/262144 [01:16<00:23, 2641.73it/s]     77%|#######6  | 201407/262144 [01:16<00:22, 2643.97it/s]     77%|#######6  | 201672/262144 [01:16<00:22, 2631.70it/s]     77%|#######7  | 201937/262144 [01:16<00:22, 2634.81it/s]     77%|#######7  | 202203/262144 [01:16<00:22, 2640.99it/s]     77%|#######7  | 202468/262144 [01:16<00:22, 2642.52it/s]     77%|#######7  | 202733/262144 [01:16<00:22, 2640.17it/s]     77%|#######7  | 202998/262144 [01:16<00:22, 2638.47it/s]     78%|#######7  | 203262/262144 [01:16<00:22, 2630.30it/s]     78%|#######7  | 203526/262144 [01:16<00:22, 2625.71it/s]     78%|#######7  | 203790/262144 [01:17<00:22, 2627.00it/s]     78%|#######7  | 204057/262144 [01:17<00:22, 2636.88it/s]     78%|#######7  | 204324/262144 [01:17<00:21, 2643.89it/s]     78%|#######8  | 204590/262144 [01:17<00:21, 2648.24it/s]     78%|#######8  | 204856/262144 [01:17<00:21, 2651.20it/s]     78%|#######8  | 205123/262144 [01:17<00:21, 2653.38it/s]     78%|#######8  | 205390/262144 [01:17<00:21, 2655.03it/s]     78%|#######8  | 205657/262144 [01:17<00:21, 2657.75it/s]     79%|#######8  | 205925/262144 [01:17<00:21, 2661.68it/s]     79%|#######8  | 206192/262144 [01:17<00:21, 2660.62it/s]     79%|#######8  | 206461/262144 [01:18<00:20, 2666.92it/s]     79%|#######8  | 206732/262144 [01:18<00:20, 2678.46it/s]     79%|#######8  | 207001/262144 [01:18<00:20, 2680.79it/s]     79%|#######9  | 207272/262144 [01:18<00:20, 2688.72it/s]     79%|#######9  | 207545/262144 [01:18<00:20, 2700.09it/s]     79%|#######9  | 207816/262144 [01:18<00:20, 2700.78it/s]     79%|#######9  | 208087/262144 [01:18<00:20, 2693.34it/s]     79%|#######9  | 208357/262144 [01:18<00:19, 2690.46it/s]     80%|#######9  | 208627/262144 [01:18<00:19, 2684.05it/s]     80%|#######9  | 208896/262144 [01:18<00:19, 2680.33it/s]     80%|#######9  | 209165/262144 [01:19<00:19, 2677.01it/s]     80%|#######9  | 209433/262144 [01:19<00:19, 2671.92it/s]     80%|#######9  | 209701/262144 [01:19<00:19, 2668.08it/s]     80%|########  | 209968/262144 [01:19<00:19, 2665.55it/s]     80%|########  | 210235/262144 [01:19<00:19, 2665.20it/s]     80%|########  | 210502/262144 [01:19<00:19, 2659.10it/s]     80%|########  | 210768/262144 [01:19<00:19, 2657.75it/s]     81%|########  | 211035/262144 [01:19<00:19, 2661.12it/s]     81%|########  | 211303/262144 [01:19<00:19, 2665.46it/s]     81%|########  | 211570/262144 [01:19<00:18, 2665.04it/s]     81%|########  | 211837/262144 [01:20<00:18, 2665.91it/s]     81%|########  | 212106/262144 [01:20<00:18, 2671.00it/s]     81%|########1 | 212376/262144 [01:20<00:18, 2677.59it/s]     81%|########1 | 212647/262144 [01:20<00:18, 2685.27it/s]     81%|########1 | 212919/262144 [01:20<00:18, 2694.31it/s]     81%|########1 | 213190/262144 [01:20<00:18, 2698.08it/s]     81%|########1 | 213460/262144 [01:20<00:18, 2695.14it/s]     82%|########1 | 213730/262144 [01:20<00:17, 2692.03it/s]     82%|########1 | 214000/262144 [01:20<00:17, 2683.43it/s]     82%|########1 | 214269/262144 [01:20<00:17, 2678.70it/s]     82%|########1 | 214537/262144 [01:21<00:17, 2675.67it/s]     82%|########1 | 214805/262144 [01:21<00:17, 2670.50it/s]     82%|########2 | 215073/262144 [01:21<00:17, 2668.40it/s]     82%|########2 | 215340/262144 [01:21<00:17, 2665.59it/s]     82%|########2 | 215607/262144 [01:21<00:17, 2664.47it/s]     82%|########2 | 215874/262144 [01:21<00:17, 2663.13it/s]     82%|########2 | 216141/262144 [01:21<00:17, 2613.03it/s]     83%|########2 | 216403/262144 [01:21<00:17, 2579.32it/s]     83%|########2 | 216662/262144 [01:21<00:17, 2581.17it/s]     83%|########2 | 216923/262144 [01:21<00:17, 2586.96it/s]     83%|########2 | 217186/262144 [01:22<00:17, 2598.42it/s]     83%|########2 | 217449/262144 [01:22<00:17, 2606.20it/s]     83%|########3 | 217713/262144 [01:22<00:16, 2615.61it/s]     83%|########3 | 217975/262144 [01:22<00:16, 2611.47it/s]     83%|########3 | 218238/262144 [01:22<00:16, 2615.85it/s]     83%|########3 | 218500/262144 [01:22<00:16, 2616.99it/s]     83%|########3 | 218764/262144 [01:22<00:16, 2623.49it/s]     84%|########3 | 219027/262144 [01:22<00:16, 2623.63it/s]     84%|########3 | 219291/262144 [01:22<00:16, 2627.96it/s]     84%|########3 | 219556/262144 [01:22<00:16, 2633.07it/s]     84%|########3 | 219820/262144 [01:23<00:16, 2626.72it/s]     84%|########3 | 220083/262144 [01:23<00:16, 2612.71it/s]     84%|########4 | 220345/262144 [01:23<00:16, 2607.35it/s]     84%|########4 | 220606/262144 [01:23<00:16, 2595.69it/s]     84%|########4 | 220868/262144 [01:23<00:15, 2601.53it/s]     84%|########4 | 221134/262144 [01:23<00:15, 2616.65it/s]     84%|########4 | 221396/262144 [01:23<00:15, 2610.28it/s]     85%|########4 | 221658/262144 [01:23<00:15, 2601.00it/s]     85%|########4 | 221919/262144 [01:23<00:15, 2600.91it/s]     85%|########4 | 222183/262144 [01:24<00:15, 2611.28it/s]     85%|########4 | 222445/262144 [01:24<00:15, 2598.29it/s]     85%|########4 | 222705/262144 [01:24<00:15, 2574.84it/s]     85%|########5 | 222967/262144 [01:24<00:15, 2586.61it/s]     85%|########5 | 223234/262144 [01:24<00:14, 2609.01it/s]     85%|########5 | 223502/262144 [01:24<00:14, 2627.10it/s]     85%|########5 | 223765/262144 [01:24<00:14, 2601.22it/s]     85%|########5 | 224026/262144 [01:24<00:14, 2585.96it/s]     86%|########5 | 224287/262144 [01:24<00:14, 2591.47it/s]     86%|########5 | 224547/262144 [01:24<00:14, 2568.69it/s]     86%|########5 | 224813/262144 [01:25<00:14, 2593.76it/s]     86%|########5 | 225077/262144 [01:25<00:14, 2607.02it/s]     86%|########5 | 225341/262144 [01:25<00:14, 2614.28it/s]     86%|########6 | 225603/262144 [01:25<00:14, 2606.04it/s]     86%|########6 | 225864/262144 [01:25<00:13, 2603.45it/s]     86%|########6 | 226128/262144 [01:25<00:13, 2610.92it/s]     86%|########6 | 226392/262144 [01:25<00:13, 2617.09it/s]     86%|########6 | 226655/262144 [01:25<00:13, 2618.78it/s]     87%|########6 | 226917/262144 [01:25<00:13, 2611.40it/s]     87%|########6 | 227179/262144 [01:25<00:13, 2612.76it/s]     87%|########6 | 227441/262144 [01:26<00:13, 2610.26it/s]     87%|########6 | 227704/262144 [01:26<00:13, 2615.93it/s]     87%|########6 | 227972/262144 [01:26<00:12, 2634.69it/s]     87%|########7 | 228240/262144 [01:26<00:12, 2647.22it/s]     87%|########7 | 228511/262144 [01:26<00:12, 2665.33it/s]     87%|########7 | 228784/262144 [01:26<00:12, 2683.43it/s]     87%|########7 | 229053/262144 [01:26<00:12, 2684.77it/s]     87%|########7 | 229323/262144 [01:26<00:12, 2688.62it/s]     88%|########7 | 229592/262144 [01:26<00:12, 2685.74it/s]     88%|########7 | 229861/262144 [01:26<00:12, 2682.17it/s]     88%|########7 | 230130/262144 [01:27<00:11, 2679.78it/s]     88%|########7 | 230398/262144 [01:27<00:11, 2671.81it/s]     88%|########7 | 230666/262144 [01:27<00:11, 2667.46it/s]     88%|########8 | 230933/262144 [01:27<00:11, 2665.12it/s]     88%|########8 | 231200/262144 [01:27<00:11, 2664.25it/s]     88%|########8 | 231467/262144 [01:27<00:11, 2661.45it/s]     88%|########8 | 231734/262144 [01:27<00:11, 2656.80it/s]     89%|########8 | 232000/262144 [01:27<00:11, 2654.88it/s]     89%|########8 | 232266/262144 [01:27<00:11, 2652.91it/s]     89%|########8 | 232532/262144 [01:27<00:11, 2642.40it/s]     89%|########8 | 232797/262144 [01:28<00:11, 2633.93it/s]     89%|########8 | 233061/262144 [01:28<00:11, 2628.33it/s]     89%|########9 | 233329/262144 [01:28<00:10, 2641.64it/s]     89%|########9 | 233596/262144 [01:28<00:10, 2648.30it/s]     89%|########9 | 233865/262144 [01:28<00:10, 2660.59it/s]     89%|########9 | 234137/262144 [01:28<00:10, 2678.11it/s]     89%|########9 | 234408/262144 [01:28<00:10, 2686.01it/s]     90%|########9 | 234677/262144 [01:28<00:10, 2670.14it/s]     90%|########9 | 234946/262144 [01:28<00:10, 2675.35it/s]     90%|########9 | 235215/262144 [01:28<00:10, 2679.63it/s]     90%|########9 | 235484/262144 [01:29<00:09, 2681.84it/s]     90%|########9 | 235753/262144 [01:29<00:09, 2677.09it/s]     90%|######### | 236021/262144 [01:29<00:09, 2676.67it/s]     90%|######### | 236289/262144 [01:29<00:09, 2675.10it/s]     90%|######### | 236557/262144 [01:29<00:09, 2670.97it/s]     90%|######### | 236825/262144 [01:29<00:09, 2666.98it/s]     90%|######### | 237092/262144 [01:29<00:09, 2659.22it/s]     91%|######### | 237358/262144 [01:29<00:09, 2648.01it/s]     91%|######### | 237623/262144 [01:29<00:09, 2632.65it/s]     91%|######### | 237887/262144 [01:29<00:09, 2625.57it/s]     91%|######### | 238151/262144 [01:30<00:09, 2628.88it/s]     91%|######### | 238416/262144 [01:30<00:09, 2633.45it/s]     91%|#########1| 238680/262144 [01:30<00:08, 2627.04it/s]     91%|#########1| 238943/262144 [01:30<00:08, 2623.49it/s]     91%|#########1| 239207/262144 [01:30<00:08, 2626.22it/s]     91%|#########1| 239474/262144 [01:30<00:08, 2638.84it/s]     91%|#########1| 239741/262144 [01:30<00:08, 2645.75it/s]     92%|#########1| 240010/262144 [01:30<00:08, 2656.40it/s]     92%|#########1| 240280/262144 [01:30<00:08, 2668.90it/s]     92%|#########1| 240551/262144 [01:30<00:08, 2679.60it/s]     92%|#########1| 240824/262144 [01:31<00:07, 2693.87it/s]     92%|#########1| 241094/262144 [01:31<00:07, 2683.48it/s]     92%|#########2| 241363/262144 [01:31<00:07, 2666.41it/s]     92%|#########2| 241630/262144 [01:31<00:07, 2653.81it/s]     92%|#########2| 241896/262144 [01:31<00:07, 2643.99it/s]     92%|#########2| 242161/262144 [01:31<00:07, 2635.28it/s]     92%|#########2| 242426/262144 [01:31<00:07, 2638.83it/s]     93%|#########2| 242694/262144 [01:31<00:07, 2648.85it/s]     93%|#########2| 242961/262144 [01:31<00:07, 2653.60it/s]     93%|#########2| 243228/262144 [01:31<00:07, 2655.57it/s]     93%|#########2| 243496/262144 [01:32<00:07, 2660.21it/s]     93%|#########2| 243763/262144 [01:32<00:06, 2651.80it/s]     93%|#########3| 244029/262144 [01:32<00:06, 2640.19it/s]     93%|#########3| 244294/262144 [01:32<00:06, 2635.44it/s]     93%|#########3| 244560/262144 [01:32<00:06, 2640.87it/s]     93%|#########3| 244828/262144 [01:32<00:06, 2650.60it/s]     93%|#########3| 245094/262144 [01:32<00:06, 2652.08it/s]     94%|#########3| 245362/262144 [01:32<00:06, 2659.57it/s]     94%|#########3| 245631/262144 [01:32<00:06, 2666.41it/s]     94%|#########3| 245900/262144 [01:32<00:06, 2671.99it/s]     94%|#########3| 246171/262144 [01:33<00:05, 2682.09it/s]     94%|#########4| 246440/262144 [01:33<00:05, 2675.09it/s]     94%|#########4| 246708/262144 [01:33<00:05, 2668.04it/s]     94%|#########4| 246975/262144 [01:33<00:05, 2660.47it/s]     94%|#########4| 247242/262144 [01:33<00:05, 2654.41it/s]     94%|#########4| 247508/262144 [01:33<00:05, 2648.39it/s]     95%|#########4| 247775/262144 [01:33<00:05, 2652.91it/s]     95%|#########4| 248043/262144 [01:33<00:05, 2659.56it/s]     95%|#########4| 248311/262144 [01:33<00:05, 2664.17it/s]     95%|#########4| 248579/262144 [01:33<00:05, 2668.03it/s]     95%|#########4| 248846/262144 [01:34<00:04, 2666.36it/s]     95%|#########5| 249113/262144 [01:34<00:04, 2656.51it/s]     95%|#########5| 249379/262144 [01:34<00:04, 2642.81it/s]     95%|#########5| 249644/262144 [01:34<00:04, 2631.41it/s]     95%|#########5| 249908/262144 [01:34<00:04, 2624.98it/s]     95%|#########5| 250171/262144 [01:34<00:04, 2623.60it/s]     96%|#########5| 250435/262144 [01:34<00:04, 2625.14it/s]     96%|#########5| 250698/262144 [01:34<00:04, 2620.18it/s]     96%|#########5| 250961/262144 [01:34<00:04, 2617.70it/s]     96%|#########5| 251225/262144 [01:34<00:04, 2622.16it/s]     96%|#########5| 251491/262144 [01:35<00:04, 2633.18it/s]     96%|#########6| 251758/262144 [01:35<00:03, 2642.45it/s]     96%|#########6| 252027/262144 [01:35<00:03, 2654.34it/s]     96%|#########6| 252294/262144 [01:35<00:03, 2656.37it/s]     96%|#########6| 252560/262144 [01:35<00:03, 2648.30it/s]     96%|#########6| 252825/262144 [01:35<00:03, 2642.82it/s]     97%|#########6| 253090/262144 [01:35<00:03, 2637.92it/s]     97%|#########6| 253356/262144 [01:35<00:03, 2643.59it/s]     97%|#########6| 253621/262144 [01:35<00:03, 2643.63it/s]     97%|#########6| 253886/262144 [01:35<00:03, 2641.66it/s]     97%|#########6| 254151/262144 [01:36<00:03, 2640.17it/s]     97%|#########7| 254416/262144 [01:36<00:02, 2639.49it/s]     97%|#########7| 254680/262144 [01:36<00:02, 2635.39it/s]     97%|#########7| 254944/262144 [01:36<00:02, 2632.36it/s]     97%|#########7| 255208/262144 [01:36<00:02, 2628.46it/s]     97%|#########7| 255471/262144 [01:36<00:02, 2622.53it/s]     98%|#########7| 255735/262144 [01:36<00:02, 2624.95it/s]     98%|#########7| 256001/262144 [01:36<00:02, 2632.52it/s]     98%|#########7| 256265/262144 [01:36<00:02, 2626.37it/s]     98%|#########7| 256528/262144 [01:36<00:02, 2625.08it/s]     98%|#########7| 256791/262144 [01:37<00:02, 2622.90it/s]     98%|#########8| 257054/262144 [01:37<00:01, 2619.97it/s]     98%|#########8| 257316/262144 [01:37<00:01, 2617.70it/s]     98%|#########8| 257579/262144 [01:37<00:01, 2620.76it/s]     98%|#########8| 257843/262144 [01:37<00:01, 2626.34it/s]     98%|#########8| 258109/262144 [01:37<00:01, 2634.65it/s]     99%|#########8| 258376/262144 [01:37<00:01, 2643.13it/s]     99%|#########8| 258643/262144 [01:37<00:01, 2650.37it/s]     99%|#########8| 258912/262144 [01:37<00:01, 2659.84it/s]     99%|#########8| 259180/262144 [01:37<00:01, 2664.68it/s]     99%|#########8| 259447/262144 [01:38<00:01, 2661.66it/s]     99%|#########9| 259716/262144 [01:38<00:00, 2667.42it/s]     99%|#########9| 259986/262144 [01:38<00:00, 2674.97it/s]     99%|#########9| 260257/262144 [01:38<00:00, 2683.88it/s]     99%|#########9| 260530/262144 [01:38<00:00, 2697.22it/s]     99%|#########9| 260800/262144 [01:38<00:00, 2696.07it/s]    100%|#########9| 261070/262144 [01:38<00:00, 2695.58it/s]    100%|#########9| 261340/262144 [01:38<00:00, 2680.32it/s]    100%|#########9| 261609/262144 [01:38<00:00, 2669.45it/s]    100%|#########9| 261876/262144 [01:39<00:00, 2651.86it/s]    100%|#########9| 262142/262144 [01:39<00:00, 2641.49it/s]    100%|#########9| 262143/262144 [01:39<00:00, 2645.09it/s]




.. GENERATED FROM PYTHON SOURCE LINES 209-220

Evaluating the Analog State Vector in Between Control Signal Samples
--------------------------------------------------------------------

If we wish to simulate the analog state vector trajectory between
control updates, this can be achieved using the Ts parameter of the
:py:class:`cbadc.simulator.StateSpaceSimulator`. Technically you can scale
:math:`T_s = T / \alpha` for any positive number :math:`\alpha`. For such a
scaling, the simulator will generate :math:`\alpha` more control signals per
unit of time. However, digital control is still restricted to only update
the control signals at multiples of :math:`T`.


.. GENERATED FROM PYTHON SOURCE LINES 220-278

.. code-block:: default


    # Set sampling time three orders of magnitude smaller than the control period
    Ts = T / 100.0
    # Instantiate a corresponding clock
    observation_clock = cbadc.analog_signal.Clock(Ts)

    # Simulate for 65536 control cycles.
    size = 1 << 16

    # Initialize a new digital control.
    new_digital_control = cbadc.digital_control.DigitalControl(clock, M)

    # Instantiate a new simulator with a sampling time.
    simulator = cbadc.simulator.AnalyticalSimulator(
        analog_system, new_digital_control, [analog_signal], observation_clock
    )

    # Create data containers to hold the resulting data.
    time_vector = np.arange(size) * Ts / T
    states = np.zeros((N, size))
    control_signals = np.zeros((M, size), dtype=np.int8)

    # Iterate through and store states and control_signals.
    simulator = cbadc.simulator.extended_simulation_result(simulator)
    for index in cbadc.utilities.show_status(range(size)):
        res = next(simulator)
        states[:, index] = res["analog_state"]
        control_signals[:, index] = res["control_signal"]

    # Plot all analog state evolutions.
    plt.figure()
    plt.title("Analog state vectors")
    for index in range(N):
        plt.plot(time_vector, states[index, :], label=f"$x_{index + 1}(t)$")
    plt.grid(visible=True, which="major", color="gray", alpha=0.6, lw=1.5)
    plt.xlabel("$t/T$")
    plt.xlim((0, 10))
    plt.legend()

    # reset figure size and plot individual results.
    plt.rcParams["figure.figsize"] = [6.40, 6.40 * 2]
    fig, ax = plt.subplots(N, 2)
    for index in range(N):
        color = next(ax[0, 0]._get_lines.prop_cycler)["color"]
        ax[index, 0].grid(visible=True, which="major", color="gray", alpha=0.6, lw=1.5)
        ax[index, 1].grid(visible=True, which="major", color="gray", alpha=0.6, lw=1.5)
        ax[index, 0].plot(time_vector, states[index, :], color=color)
        ax[index, 1].plot(time_vector, control_signals[index, :], "--", color=color)
        ax[index, 0].set_ylabel(f"$x_{index + 1}(t)$")
        ax[index, 1].set_ylabel(f"$s_{index + 1}(t)$")
        ax[index, 0].set_xlim((0, 15))
        ax[index, 1].set_xlim((0, 15))
        ax[index, 0].set_ylim((-1, 1))
    fig.suptitle("Analog state and control contribution evolution")
    ax[-1, 0].set_xlabel("$t / T$")
    ax[-1, 1].set_xlabel("$t / T$")
    fig.tight_layout()




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /tutorials/a_getting_started/images/sphx_glr_plot_b_simulate_a_control_bounded_adc_001.png
         :alt: Analog state vectors
         :srcset: /tutorials/a_getting_started/images/sphx_glr_plot_b_simulate_a_control_bounded_adc_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /tutorials/a_getting_started/images/sphx_glr_plot_b_simulate_a_control_bounded_adc_002.png
         :alt: Analog state and control contribution evolution
         :srcset: /tutorials/a_getting_started/images/sphx_glr_plot_b_simulate_a_control_bounded_adc_002.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

      0%|          | 0/65536 [00:00<?, ?it/s]      1%|          | 370/65536 [00:00<00:17, 3690.55it/s]      1%|1         | 740/65536 [00:00<00:17, 3691.85it/s]      2%|1         | 1112/65536 [00:00<00:17, 3701.30it/s]      2%|2         | 1486/65536 [00:00<00:17, 3712.98it/s]      3%|2         | 1859/65536 [00:00<00:17, 3716.85it/s]      3%|3         | 2234/65536 [00:00<00:16, 3725.53it/s]      4%|3         | 2614/65536 [00:00<00:16, 3749.73it/s]      5%|4         | 2991/65536 [00:00<00:16, 3754.53it/s]      5%|5         | 3367/65536 [00:00<00:16, 3751.83it/s]      6%|5         | 3743/65536 [00:01<00:16, 3743.37it/s]      6%|6         | 4121/65536 [00:01<00:16, 3753.41it/s]      7%|6         | 4497/65536 [00:01<00:16, 3749.92it/s]      7%|7         | 4873/65536 [00:01<00:16, 3752.34it/s]      8%|8         | 5250/65536 [00:01<00:16, 3757.27it/s]      9%|8         | 5626/65536 [00:01<00:15, 3755.30it/s]      9%|9         | 6002/65536 [00:01<00:15, 3755.57it/s]     10%|9         | 6378/65536 [00:01<00:15, 3749.51it/s]     10%|#         | 6753/65536 [00:01<00:15, 3740.52it/s]     11%|#         | 7128/65536 [00:01<00:15, 3731.49it/s]     11%|#1        | 7502/65536 [00:02<00:15, 3722.58it/s]     12%|#2        | 7875/65536 [00:02<00:15, 3718.19it/s]     13%|#2        | 8247/65536 [00:02<00:15, 3712.07it/s]     13%|#3        | 8625/65536 [00:02<00:15, 3731.53it/s]     14%|#3        | 9003/65536 [00:02<00:15, 3743.71it/s]     14%|#4        | 9382/65536 [00:02<00:14, 3755.53it/s]     15%|#4        | 9758/65536 [00:02<00:14, 3740.98it/s]     15%|#5        | 10133/65536 [00:02<00:14, 3739.52it/s]     16%|#6        | 10507/65536 [00:02<00:14, 3737.61it/s]     17%|#6        | 10881/65536 [00:02<00:14, 3729.71it/s]     17%|#7        | 11254/65536 [00:03<00:14, 3723.96it/s]     18%|#7        | 11627/65536 [00:03<00:14, 3721.71it/s]     18%|#8        | 12003/65536 [00:03<00:14, 3733.10it/s]     19%|#8        | 12377/65536 [00:03<00:14, 3730.44it/s]     19%|#9        | 12754/65536 [00:03<00:14, 3741.10it/s]     20%|##        | 13129/65536 [00:03<00:14, 3734.05it/s]     21%|##        | 13503/65536 [00:03<00:13, 3727.46it/s]     21%|##1       | 13876/65536 [00:03<00:13, 3723.00it/s]     22%|##1       | 14252/65536 [00:03<00:13, 3733.42it/s]     22%|##2       | 14631/65536 [00:03<00:13, 3749.99it/s]     23%|##2       | 15007/65536 [00:04<00:13, 3752.07it/s]     23%|##3       | 15383/65536 [00:04<00:13, 3742.03it/s]     24%|##4       | 15758/65536 [00:04<00:13, 3733.06it/s]     25%|##4       | 16132/65536 [00:04<00:13, 3723.52it/s]     25%|##5       | 16505/65536 [00:04<00:13, 3717.11it/s]     26%|##5       | 16877/65536 [00:04<00:13, 3712.57it/s]     26%|##6       | 17249/65536 [00:04<00:13, 3711.72it/s]     27%|##6       | 17622/65536 [00:04<00:12, 3715.54it/s]     27%|##7       | 17995/65536 [00:04<00:12, 3718.75it/s]     28%|##8       | 18368/65536 [00:04<00:12, 3719.41it/s]     29%|##8       | 18740/65536 [00:05<00:12, 3717.38it/s]     29%|##9       | 19112/65536 [00:05<00:12, 3715.56it/s]     30%|##9       | 19484/65536 [00:05<00:12, 3713.02it/s]     30%|###       | 19856/65536 [00:05<00:12, 3712.65it/s]     31%|###       | 20229/65536 [00:05<00:12, 3715.96it/s]     31%|###1      | 20601/65536 [00:05<00:12, 3716.35it/s]     32%|###2      | 20973/65536 [00:05<00:11, 3714.83it/s]     33%|###2      | 21346/65536 [00:05<00:11, 3716.59it/s]     33%|###3      | 21719/65536 [00:05<00:11, 3719.62it/s]     34%|###3      | 22091/65536 [00:05<00:11, 3719.57it/s]     34%|###4      | 22463/65536 [00:06<00:11, 3718.14it/s]     35%|###4      | 22836/65536 [00:06<00:11, 3718.75it/s]     35%|###5      | 23208/65536 [00:06<00:11, 3718.26it/s]     36%|###5      | 23580/65536 [00:06<00:11, 3716.43it/s]     37%|###6      | 23952/65536 [00:06<00:11, 3716.24it/s]     37%|###7      | 24324/65536 [00:06<00:11, 3715.53it/s]     38%|###7      | 24697/65536 [00:06<00:10, 3718.15it/s]     38%|###8      | 25069/65536 [00:06<00:10, 3717.78it/s]     39%|###8      | 25441/65536 [00:06<00:10, 3713.06it/s]     39%|###9      | 25814/65536 [00:06<00:10, 3715.76it/s]     40%|###9      | 26186/65536 [00:07<00:10, 3709.79it/s]     41%|####      | 26565/65536 [00:07<00:10, 3732.04it/s]     41%|####1     | 26943/65536 [00:07<00:10, 3743.58it/s]     42%|####1     | 27322/65536 [00:07<00:10, 3756.38it/s]     42%|####2     | 27701/65536 [00:07<00:10, 3766.03it/s]     43%|####2     | 28080/65536 [00:07<00:09, 3772.73it/s]     43%|####3     | 28460/65536 [00:07<00:09, 3777.93it/s]     44%|####4     | 28839/65536 [00:07<00:09, 3781.01it/s]     45%|####4     | 29219/65536 [00:07<00:09, 3784.92it/s]     45%|####5     | 29599/65536 [00:07<00:09, 3787.68it/s]     46%|####5     | 29978/65536 [00:08<00:09, 3787.13it/s]     46%|####6     | 30358/65536 [00:08<00:09, 3789.04it/s]     47%|####6     | 30738/65536 [00:08<00:09, 3791.59it/s]     47%|####7     | 31118/65536 [00:08<00:09, 3788.98it/s]     48%|####8     | 31498/65536 [00:08<00:08, 3790.43it/s]     49%|####8     | 31878/65536 [00:08<00:08, 3789.10it/s]     49%|####9     | 32257/65536 [00:08<00:08, 3788.22it/s]     50%|####9     | 32636/65536 [00:08<00:08, 3781.13it/s]     50%|#####     | 33015/65536 [00:08<00:08, 3779.92it/s]     51%|#####     | 33394/65536 [00:08<00:08, 3781.96it/s]     52%|#####1    | 33773/65536 [00:09<00:08, 3782.95it/s]     52%|#####2    | 34152/65536 [00:09<00:08, 3777.97it/s]     53%|#####2    | 34530/65536 [00:09<00:08, 3776.47it/s]     53%|#####3    | 34908/65536 [00:09<00:08, 3776.67it/s]     54%|#####3    | 35286/65536 [00:09<00:08, 3776.44it/s]     54%|#####4    | 35664/65536 [00:09<00:07, 3774.03it/s]     55%|#####4    | 36042/65536 [00:09<00:07, 3773.10it/s]     56%|#####5    | 36420/65536 [00:09<00:07, 3772.05it/s]     56%|#####6    | 36798/65536 [00:09<00:07, 3773.21it/s]     57%|#####6    | 37176/65536 [00:09<00:07, 3772.28it/s]     57%|#####7    | 37555/65536 [00:10<00:07, 3777.18it/s]     58%|#####7    | 37934/65536 [00:10<00:07, 3778.39it/s]     58%|#####8    | 38312/65536 [00:10<00:07, 3776.45it/s]     59%|#####9    | 38690/65536 [00:10<00:07, 3774.10it/s]     60%|#####9    | 39068/65536 [00:10<00:07, 3773.13it/s]     60%|######    | 39447/65536 [00:10<00:06, 3775.45it/s]     61%|######    | 39825/65536 [00:10<00:06, 3772.57it/s]     61%|######1   | 40203/65536 [00:10<00:06, 3770.95it/s]     62%|######1   | 40583/65536 [00:10<00:06, 3776.96it/s]     63%|######2   | 40961/65536 [00:10<00:06, 3773.48it/s]     63%|######3   | 41339/65536 [00:11<00:06, 3759.92it/s]     64%|######3   | 41717/65536 [00:11<00:06, 3763.38it/s]     64%|######4   | 42095/65536 [00:11<00:06, 3766.18it/s]     65%|######4   | 42473/65536 [00:11<00:06, 3769.07it/s]     65%|######5   | 42851/65536 [00:11<00:06, 3770.00it/s]     66%|######5   | 43230/65536 [00:11<00:05, 3774.97it/s]     67%|######6   | 43608/65536 [00:11<00:05, 3775.45it/s]     67%|######7   | 43988/65536 [00:11<00:05, 3781.52it/s]     68%|######7   | 44367/65536 [00:11<00:05, 3777.96it/s]     68%|######8   | 44746/65536 [00:11<00:05, 3781.06it/s]     69%|######8   | 45125/65536 [00:12<00:05, 3782.00it/s]     69%|######9   | 45504/65536 [00:12<00:05, 3779.59it/s]     70%|#######   | 45882/65536 [00:12<00:05, 3772.90it/s]     71%|#######   | 46260/65536 [00:12<00:05, 3762.41it/s]     71%|#######1  | 46637/65536 [00:12<00:05, 3743.22it/s]     72%|#######1  | 47012/65536 [00:12<00:04, 3731.75it/s]     72%|#######2  | 47386/65536 [00:12<00:04, 3729.35it/s]     73%|#######2  | 47759/65536 [00:12<00:04, 3724.69it/s]     73%|#######3  | 48132/65536 [00:12<00:04, 3725.89it/s]     74%|#######4  | 48505/65536 [00:12<00:04, 3720.97it/s]     75%|#######4  | 48878/65536 [00:13<00:04, 3713.81it/s]     75%|#######5  | 49250/65536 [00:13<00:04, 3712.92it/s]     76%|#######5  | 49622/65536 [00:13<00:04, 3710.05it/s]     76%|#######6  | 49994/65536 [00:13<00:04, 3711.58it/s]     77%|#######6  | 50366/65536 [00:13<00:04, 3711.93it/s]     77%|#######7  | 50738/65536 [00:13<00:03, 3705.60it/s]     78%|#######7  | 51110/65536 [00:13<00:03, 3707.17it/s]     79%|#######8  | 51481/65536 [00:13<00:03, 3707.13it/s]     79%|#######9  | 51856/65536 [00:13<00:03, 3718.63it/s]     80%|#######9  | 52235/65536 [00:13<00:03, 3738.73it/s]     80%|########  | 52614/65536 [00:14<00:03, 3751.73it/s]     81%|########  | 52991/65536 [00:14<00:03, 3754.66it/s]     81%|########1 | 53370/65536 [00:14<00:03, 3764.45it/s]     82%|########2 | 53747/65536 [00:14<00:03, 3766.03it/s]     83%|########2 | 54125/65536 [00:14<00:03, 3769.20it/s]     83%|########3 | 54504/65536 [00:14<00:02, 3775.07it/s]     84%|########3 | 54882/65536 [00:14<00:02, 3771.16it/s]     84%|########4 | 55260/65536 [00:14<00:02, 3759.26it/s]     85%|########4 | 55639/65536 [00:14<00:02, 3768.29it/s]     85%|########5 | 56018/65536 [00:14<00:02, 3773.91it/s]     86%|########6 | 56396/65536 [00:15<00:02, 3775.27it/s]     87%|########6 | 56774/65536 [00:15<00:02, 3759.74it/s]     87%|########7 | 57150/65536 [00:15<00:02, 3738.66it/s]     88%|########7 | 57524/65536 [00:15<00:02, 3688.08it/s]     88%|########8 | 57903/65536 [00:15<00:02, 3715.39it/s]     89%|########8 | 58278/65536 [00:15<00:01, 3724.27it/s]     89%|########9 | 58654/65536 [00:15<00:01, 3733.52it/s]     90%|######### | 59032/65536 [00:15<00:01, 3746.71it/s]     91%|######### | 59411/65536 [00:15<00:01, 3759.27it/s]     91%|#########1| 59787/65536 [00:15<00:01, 3754.18it/s]     92%|#########1| 60164/65536 [00:16<00:01, 3756.72it/s]     92%|#########2| 60542/65536 [00:16<00:01, 3762.24it/s]     93%|#########2| 60921/65536 [00:16<00:01, 3769.24it/s]     94%|#########3| 61298/65536 [00:16<00:01, 3768.63it/s]     94%|#########4| 61677/65536 [00:16<00:01, 3774.00it/s]     95%|#########4| 62056/65536 [00:16<00:00, 3777.47it/s]     95%|#########5| 62435/65536 [00:16<00:00, 3780.07it/s]     96%|#########5| 62814/65536 [00:16<00:00, 3765.15it/s]     96%|#########6| 63191/65536 [00:16<00:00, 3749.99it/s]     97%|#########6| 63567/65536 [00:16<00:00, 3736.61it/s]     98%|#########7| 63941/65536 [00:17<00:00, 3719.24it/s]     98%|#########8| 64313/65536 [00:17<00:00, 3702.32it/s]     99%|#########8| 64684/65536 [00:17<00:00, 3696.83it/s]     99%|#########9| 65062/65536 [00:17<00:00, 3718.80it/s]    100%|#########9| 65440/65536 [00:17<00:00, 3734.45it/s]    100%|##########| 65536/65536 [00:17<00:00, 3746.26it/s]




.. GENERATED FROM PYTHON SOURCE LINES 279-286

Analog State Statistics
------------------------------------------------------------------

As in the previous section, visualizing the analog state trajectory is a
good way of identifying problems and possible errors. Another way of making
sure that the analog states remain bounded is to estimate their
corresponding densities (assuming i.i.d samples).

.. GENERATED FROM PYTHON SOURCE LINES 286-307

.. code-block:: default


    # Compute L_2 norm of analog state vector.
    L_2_norm = np.linalg.norm(states, ord=2, axis=0)
    # Similarly, compute L_infty (largest absolute value) of the analog state
    # vector.
    L_infty_norm = np.linalg.norm(states, ord=np.inf, axis=0)

    # Estimate and plot densities using matplotlib tools.
    bins = 150
    plt.rcParams["figure.figsize"] = [6.40, 4.80]
    fig, ax = plt.subplots(2, sharex=True)
    ax[0].grid(visible=True, which="major", color="gray", alpha=0.6, lw=1.5)
    ax[1].grid(visible=True, which="major", color="gray", alpha=0.6, lw=1.5)
    ax[0].hist(L_2_norm, bins=bins, density=True)
    ax[1].hist(L_infty_norm, bins=bins, density=True, color="orange")
    plt.suptitle("Estimated probability densities")
    ax[0].set_xlabel("$\|\mathbf{x}(t)\|_2$")
    ax[1].set_xlabel("$\|\mathbf{x}(t)\|_\infty$")
    ax[0].set_ylabel("$p ( \| \mathbf{x}(t) \|_2 ) $")
    ax[1].set_ylabel("$p ( \| \mathbf{x}(t) \|_\infty )$")
    fig.tight_layout()



.. image-sg:: /tutorials/a_getting_started/images/sphx_glr_plot_b_simulate_a_control_bounded_adc_003.png
   :alt: Estimated probability densities
   :srcset: /tutorials/a_getting_started/images/sphx_glr_plot_b_simulate_a_control_bounded_adc_003.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 2 minutes  11.631 seconds)


.. _sphx_glr_download_tutorials_a_getting_started_plot_b_simulate_a_control_bounded_adc.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_b_simulate_a_control_bounded_adc.py <plot_b_simulate_a_control_bounded_adc.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_b_simulate_a_control_bounded_adc.ipynb <plot_b_simulate_a_control_bounded_adc.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
