
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "tutorials/a_getting_started/plot_b_simulate_a_control_bounded_adc.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_tutorials_a_getting_started_plot_b_simulate_a_control_bounded_adc.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_tutorials_a_getting_started_plot_b_simulate_a_control_bounded_adc.py:


Simulating a Control-Bounded ADC
================================

This example shows how to simulate the interactions between an analog system
and a digital control while the former is excited by an analog signal.

.. GENERATED FROM PYTHON SOURCE LINES 8-12

.. code-block:: default

    import matplotlib.pyplot as plt
    import cbadc
    import numpy as np








.. GENERATED FROM PYTHON SOURCE LINES 13-25

The Analog System
-----------------

.. image:: /images/chainOfIntegratorsGeneral.svg
   :width: 500
   :align: center
   :alt: The chain of integrators ADC.

First, we have to decide on an analog system. For this tutorial, we will
commit to a chain-of-integrators ADC,
see :py:class:`cbadc.analog_system.ChainOfIntegrators`, as our analog
system.

.. GENERATED FROM PYTHON SOURCE LINES 25-44

.. code-block:: default


    # We fix the number of analog states.
    N = 6
    # Set the amplification factor.
    beta = 6250.0
    rho = -1e-2
    kappa = -1.0
    # In this example, each nodes amplification and local feedback will be set
    # identically.
    betaVec = beta * np.ones(N)
    rhoVec = betaVec * rho
    kappaVec = kappa * beta * np.eye(N)

    # Instantiate a chain-of-integrators analog system.
    analog_system = cbadc.analog_system.ChainOfIntegrators(
        betaVec, rhoVec, kappaVec)
    # print the analog system such that we can very it being correctly initalized.
    print(analog_system)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    The analog system is parameterized as:
    A =
    [[ -62.5    0.     0.     0.     0.     0. ]
     [6250.   -62.5    0.     0.     0.     0. ]
     [   0.  6250.   -62.5    0.     0.     0. ]
     [   0.     0.  6250.   -62.5    0.     0. ]
     [   0.     0.     0.  6250.   -62.5    0. ]
     [   0.     0.     0.     0.  6250.   -62.5]],
    B =
    [[6250.]
     [   0.]
     [   0.]
     [   0.]
     [   0.]
     [   0.]],
    CT =
    [[1. 0. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0. 0.]
     [0. 0. 1. 0. 0. 0.]
     [0. 0. 0. 1. 0. 0.]
     [0. 0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 0. 1.]],
    Gamma =
    [[-6250.    -0.    -0.    -0.    -0.    -0.]
     [   -0. -6250.    -0.    -0.    -0.    -0.]
     [   -0.    -0. -6250.    -0.    -0.    -0.]
     [   -0.    -0.    -0. -6250.    -0.    -0.]
     [   -0.    -0.    -0.    -0. -6250.    -0.]
     [   -0.    -0.    -0.    -0.    -0. -6250.]],
    Gamma_tildeT =
    [[1. 0. 0. 0. 0. 0.]
     [0. 1. 0. 0. 0. 0.]
     [0. 0. 1. 0. 0. 0.]
     [0. 0. 0. 1. 0. 0.]
     [0. 0. 0. 0. 1. 0.]
     [0. 0. 0. 0. 0. 1.]], and D=[[0.]
     [0.]
     [0.]
     [0.]
     [0.]
     [0.]]




.. GENERATED FROM PYTHON SOURCE LINES 45-51

The Digital Control
-------------------

In addition to the analog system, our simulation will require us to specify a
digital control. For this tutorial, we will use
:py:class:`cbadc.digital_control.DigitalControl`.

.. GENERATED FROM PYTHON SOURCE LINES 51-64

.. code-block:: default


    # Set the time period which determines how often the digital control updates.
    T = 1.0 / (2 * beta)
    # Instantiate a corresponding clock.
    clock = cbadc.analog_signal.Clock(T)
    # Set the number of digital controls to be same as analog states.
    M = N
    # Initialize the digital control.
    digital_control = cbadc.digital_control.DigitalControl(clock, M)
    # print the digital control to verify proper initialization.
    print(digital_control)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Not yet implemented.
    ================================================================================

    The Digital Control is parameterized as:

    --------------------------------------------------------------------------------

    clock:
    Analog signal returns constant 0, i.e., maps t |-> 0.

    M:
    6
    ================================================================================





.. GENERATED FROM PYTHON SOURCE LINES 65-72

The Analog Signal
-----------------

The final and third component of the simulation is an analog signal.
For this tutorial, we will choose a
:py:class:`cbadc.analog_signal.Sinusoidal`. Again, this is one of several
possible choices.

.. GENERATED FROM PYTHON SOURCE LINES 72-89

.. code-block:: default


    # Set the peak amplitude.
    amplitude = 0.5
    # Choose the sinusoidal frequency via an oversampling ratio (OSR).
    OSR = 1 << 9
    frequency = 1.0 / (T * OSR)

    # We also specify a phase an offset these are hovewer optional.
    phase = np.pi / 3
    offset = 0.0

    # Instantiate the analog signal
    analog_signal = cbadc.analog_signal.Sinusoidal(
        amplitude, frequency, phase, offset)
    # print to ensure correct parametrization.
    print(analog_signal)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Not yet implemented.

    Sinusoidal parameterized as:
    amplitude = 0.5,
    frequency = 24.414062499999996,
    phase = 1.0471975511965976,
    and
    offset = 0.0





.. GENERATED FROM PYTHON SOURCE LINES 90-98

Simulating
-------------

Next, we set up the simulator. Here we use the
:py:class:`cbadc.simulator.StateSpaceSimulator` for simulating the
involved differential equations as outlined in
:py:class:`cbadc.analog_system.AnalogSystem`.


.. GENERATED FROM PYTHON SOURCE LINES 98-121

.. code-block:: default


    # Simulate for 2^18 control cycles.
    size = 1 << 18
    end_time = T * size

    # Instantiate the simulator.
    simulator = cbadc.simulator.Simulator(
        analog_system, digital_control, [analog_signal], t_stop=end_time
    )
    # Depending on your analog system the step above might take some time to
    # compute as it involves precomputing solutions to initial value problems.

    # Let's print the first 20 control decisions.
    index = 0
    for s in cbadc.utilities.show_status(simulator):
        if index > 19:
            break
        print(f"step:{index} -> s:{np.array(s)}")
        index += 1

    # To verify the simulation parametrization we can
    print(simulator)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Not yet implemented.
    0it [00:00, ?it/s]step:0 -> s:[False False False False False False]
    step:1 -> s:[ True False False False False False]
    step:2 -> s:[ True  True  True  True  True False]
    step:3 -> s:[False  True  True False False  True]
    step:4 -> s:[ True False False  True False False]
    step:5 -> s:[ True  True  True False  True  True]
    step:6 -> s:[ True  True False False False False]
    step:7 -> s:[False False  True  True  True  True]
    step:8 -> s:[ True  True False False False False]
    step:9 -> s:[ True False False  True  True  True]
    step:10 -> s:[False  True  True False False False]
    step:11 -> s:[ True False  True  True  True  True]
    step:12 -> s:[ True  True False False False  True]
    step:13 -> s:[ True  True  True  True  True False]
    step:14 -> s:[False False  True  True  True  True]
    step:15 -> s:[ True  True False False False False]
    step:16 -> s:[ True  True  True  True False False]
    step:17 -> s:[ True False False False  True  True]
    step:18 -> s:[False  True  True  True False False]
    step:19 -> s:[ True False  True False  True  True]
    20it [00:00, 4331.17it/s]
    <cbadc.simulator.wrapper.Simulator object at 0x7f64c071b760>




.. GENERATED FROM PYTHON SOURCE LINES 122-155

Tracking the Analog State Vector
--------------------------------

Clearly the output type of the generator simulator above is the sequence of
control signals s[k]. Sometimes we are interested in also monitoring the
internal states of analog system during simulation.

To this end we use the
:func:`cbadc.simulator.StateSpaceSimulator.state_vector` and an
:func:`cbadc.simulator.extended_simulation_result`.

Note that the :func:`cbadc.simulator.extended_simulation_result` is
defined like this

.. code-block:: python

  def extended_simulation_result(simulator):
      for control_signal in simulator:
          analog_state = simulator.state_vector()
          yield {
              'control_signal': np.array(control_signal),
              'analog_state': np.array(analog_state)
          }

So, in essence, we are creating a new generator from the old with an extended
output.

.. note:: The convenience function extended_simulation_result is one of many
          such convenience functions found in the
          :py:mod:`cbadc.simulator` module.

We can achieve this by appending yet another generator to the control signal
stream as:

.. GENERATED FROM PYTHON SOURCE LINES 155-167

.. code-block:: default


    # Repeating the steps above we now get for the following
    # ten control cycles.

    ext_simulator = cbadc.simulator.extended_simulation_result(simulator.simulator)
    for res in cbadc.utilities.show_status(ext_simulator):
        if index > 29:
            break
        print(
            f"step:{index} -> s:{res['control_signal']}, x:{res['analog_state']}")
        index += 1





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    0it [00:00, ?it/s]step:20 -> s:[ True  True  True False  True  True], x:[ 0.05159004  0.27221522  0.48310161 -0.13590083  0.27000779  0.33126423]
    step:21 -> s:[False False False  True False False], x:[-0.20564243 -0.26644966 -0.01150043  0.4921247  -0.13073697 -0.14761122]
    step:22 -> s:[ True  True  True  True  True  True], x:[0.53664362 0.31645391 0.48459546 0.09698695 0.50516476 0.45371626]
    step:23 -> s:[ True  True  True False False  True], x:[ 0.27841825  0.01924489  0.0723844  -0.25734534 -0.0276975   0.07894859]
    step:24 -> s:[ True False False  True  True False], x:[ 0.02213905 -0.40478456 -0.5177235   0.14020098  0.45438864 -0.32182567]
    step:25 -> s:[False  True False False False  True], x:[-0.2322404   0.04346129 -0.10102201 -0.5226916  -0.1509712   0.26781648]
    step:26 -> s:[ True False  True  True  True False], x:[ 0.51273777 -0.3852722   0.29733466  0.0366958   0.21935704 -0.22678314]
    step:27 -> s:[ True  True False False False  True], x:[ 0.257044    0.30723824 -0.21675873 -0.45674954 -0.37478535  0.24446714]
    step:28 -> s:[ True False  True  True  True False], x:[ 0.00313634 -0.1282895   0.33279546  0.08249758  0.02129093 -0.35467777]
    step:29 -> s:[False  True False False False  True], x:[-0.24903117  0.30965837 -0.11696502 -0.37213011 -0.54065927  0.02563708]
    10it [00:00, 2937.80it/s]




.. GENERATED FROM PYTHON SOURCE LINES 168-182

.. _default_simulation:

--------------------------------
Saving to File
--------------------------------

In general, simulating the analog system and digital control interaction
is a computationally much more intense procedure compared to the digital
estimation step. This is one reason, and there are more, why
you would want to store the intermediate control signal sequence to a file.

For this purpose use the
:func:`cbadc.utilities.control_signal_2_byte_stream` and
:func:`cbadc.utilities.write_byte_stream_to_file` functions.

.. GENERATED FROM PYTHON SOURCE LINES 182-204

.. code-block:: default


    # Instantiate a new simulator and control.
    simulator = cbadc.simulator.Simulator(
        analog_system, digital_control, [analog_signal], t_stop=end_time
    )

    # Construct byte stream.
    byte_stream = cbadc.utilities.control_signal_2_byte_stream(simulator, M)


    def print_next_10_bytes(stream):
        global index
        for byte in cbadc.utilities.show_status(stream, size):
            if index < 40:
                print(f"{index} -> {byte}")
                index += 1
            yield byte


    cbadc.utilities.write_byte_stream_to_file("sinusoidal_simulation.dat",
                                              print_next_10_bytes(byte_stream))





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Not yet implemented.
    0it [00:00, ?it/s]30 -> b'\r'
    31 -> b'\r'
    32 -> b'\r'
    33 -> b'\r'
    34 -> b'\r'
    35 -> b'\r'
    36 -> b'\r'
    37 -> b'\r'
    38 -> b'\r'
    39 -> b'\r'
      0%|          | 710/262144 [00:00<00:36, 7097.47it/s]      1%|          | 1420/262144 [00:00<00:37, 6969.62it/s]      1%|          | 2118/262144 [00:00<00:37, 6856.27it/s]      1%|1         | 2840/262144 [00:00<00:37, 6994.06it/s]      1%|1         | 3564/262144 [00:00<00:36, 7081.04it/s]      2%|1         | 4290/262144 [00:00<00:36, 7140.07it/s]      2%|1         | 5026/262144 [00:00<00:35, 7210.58it/s]      2%|2         | 5756/262144 [00:00<00:35, 7238.43it/s]      2%|2         | 6486/262144 [00:00<00:35, 7256.01it/s]      3%|2         | 7217/262144 [00:01<00:35, 7271.38it/s]      3%|3         | 7950/262144 [00:01<00:34, 7286.79it/s]      3%|3         | 8687/262144 [00:01<00:34, 7310.22it/s]      4%|3         | 9419/262144 [00:01<00:35, 7077.64it/s]      4%|3         | 10129/262144 [00:01<00:35, 7055.14it/s]      4%|4         | 10841/262144 [00:01<00:35, 7074.19it/s]      4%|4         | 11565/262144 [00:01<00:35, 7120.85it/s]      5%|4         | 12285/262144 [00:01<00:34, 7143.34it/s]      5%|4         | 13009/262144 [00:01<00:34, 7170.68it/s]      5%|5         | 13727/262144 [00:01<00:34, 7152.84it/s]      6%|5         | 14448/262144 [00:02<00:34, 7168.06it/s]      6%|5         | 15173/262144 [00:02<00:34, 7190.76it/s]      6%|6         | 15894/262144 [00:02<00:34, 7196.43it/s]      6%|6         | 16621/262144 [00:02<00:34, 7217.70it/s]      7%|6         | 17344/262144 [00:02<00:33, 7221.33it/s]      7%|6         | 18068/262144 [00:02<00:33, 7225.24it/s]      7%|7         | 18791/262144 [00:02<00:33, 7218.58it/s]      7%|7         | 19515/262144 [00:02<00:33, 7223.44it/s]      8%|7         | 20242/262144 [00:02<00:33, 7234.69it/s]      8%|7         | 20966/262144 [00:02<00:33, 7230.49it/s]      8%|8         | 21694/262144 [00:03<00:33, 7244.04it/s]      9%|8         | 22420/262144 [00:03<00:33, 7247.00it/s]      9%|8         | 23145/262144 [00:03<00:33, 7228.30it/s]      9%|9         | 23870/262144 [00:03<00:32, 7233.30it/s]      9%|9         | 24594/262144 [00:03<00:36, 6462.49it/s]     10%|9         | 25318/262144 [00:03<00:35, 6676.36it/s]     10%|9         | 26045/262144 [00:03<00:34, 6844.15it/s]     10%|#         | 26767/262144 [00:03<00:33, 6951.20it/s]     10%|#         | 27493/262144 [00:03<00:33, 7039.95it/s]     11%|#         | 28219/262144 [00:03<00:32, 7102.70it/s]     11%|#1        | 28949/262144 [00:04<00:32, 7159.15it/s]     11%|#1        | 29674/262144 [00:04<00:32, 7184.08it/s]     12%|#1        | 30403/262144 [00:04<00:32, 7215.22it/s]     12%|#1        | 31130/262144 [00:04<00:31, 7229.34it/s]     12%|#2        | 31858/262144 [00:04<00:31, 7242.65it/s]     12%|#2        | 32583/262144 [00:04<00:31, 7207.33it/s]     13%|#2        | 33305/262144 [00:04<00:31, 7206.72it/s]     13%|#2        | 34027/262144 [00:04<00:31, 7201.36it/s]     13%|#3        | 34750/262144 [00:04<00:31, 7209.49it/s]     14%|#3        | 35475/262144 [00:04<00:31, 7221.33it/s]     14%|#3        | 36201/262144 [00:05<00:31, 7230.81it/s]     14%|#4        | 36925/262144 [00:05<00:31, 7229.08it/s]     14%|#4        | 37648/262144 [00:05<00:31, 7128.85it/s]     15%|#4        | 38362/262144 [00:05<00:31, 7083.53it/s]     15%|#4        | 39085/262144 [00:05<00:31, 7126.02it/s]     15%|#5        | 39807/262144 [00:05<00:31, 7153.80it/s]     15%|#5        | 40533/262144 [00:05<00:30, 7184.69it/s]     16%|#5        | 41258/262144 [00:05<00:30, 7202.57it/s]     16%|#6        | 41981/262144 [00:05<00:30, 7210.47it/s]     16%|#6        | 42705/262144 [00:05<00:30, 7217.62it/s]     17%|#6        | 43429/262144 [00:06<00:30, 7221.99it/s]     17%|#6        | 44152/262144 [00:06<00:31, 6827.34it/s]     17%|#7        | 44840/262144 [00:06<00:33, 6537.90it/s]     17%|#7        | 45562/262144 [00:06<00:32, 6728.78it/s]     18%|#7        | 46283/262144 [00:06<00:31, 6866.51it/s]     18%|#7        | 46974/262144 [00:06<00:32, 6687.02it/s]     18%|#8        | 47691/262144 [00:06<00:31, 6825.61it/s]     18%|#8        | 48415/262144 [00:06<00:30, 6946.17it/s]     19%|#8        | 49140/262144 [00:06<00:30, 7033.04it/s]     19%|#9        | 49867/262144 [00:07<00:29, 7101.32it/s]     19%|#9        | 50598/262144 [00:07<00:29, 7161.25it/s]     20%|#9        | 51324/262144 [00:07<00:29, 7187.69it/s]     20%|#9        | 52052/262144 [00:07<00:29, 7214.92it/s]     20%|##        | 52777/262144 [00:07<00:28, 7224.16it/s]     20%|##        | 53505/262144 [00:07<00:28, 7239.87it/s]     21%|##        | 54230/262144 [00:07<00:28, 7237.51it/s]     21%|##        | 54954/262144 [00:07<00:28, 7234.24it/s]     21%|##1       | 55679/262144 [00:07<00:28, 7236.79it/s]     22%|##1       | 56407/262144 [00:07<00:28, 7247.19it/s]     22%|##1       | 57132/262144 [00:08<00:28, 7239.95it/s]     22%|##2       | 57857/262144 [00:08<00:28, 7234.92it/s]     22%|##2       | 58584/262144 [00:08<00:28, 7245.10it/s]     23%|##2       | 59312/262144 [00:08<00:27, 7253.14it/s]     23%|##2       | 60040/262144 [00:08<00:27, 7260.09it/s]     23%|##3       | 60769/262144 [00:08<00:27, 7267.90it/s]     23%|##3       | 61496/262144 [00:08<00:27, 7242.49it/s]     24%|##3       | 62224/262144 [00:08<00:27, 7253.63it/s]     24%|##4       | 62951/262144 [00:08<00:27, 7256.02it/s]     24%|##4       | 63678/262144 [00:08<00:27, 7259.61it/s]     25%|##4       | 64404/262144 [00:09<00:30, 6479.10it/s]     25%|##4       | 65129/262144 [00:09<00:29, 6690.14it/s]     25%|##5       | 65852/262144 [00:09<00:28, 6841.57it/s]     25%|##5       | 66578/262144 [00:09<00:28, 6961.17it/s]     26%|##5       | 67299/262144 [00:09<00:27, 7032.80it/s]     26%|##5       | 68022/262144 [00:09<00:27, 7089.29it/s]     26%|##6       | 68747/262144 [00:09<00:27, 7136.05it/s]     27%|##6       | 69473/262144 [00:09<00:26, 7170.44it/s]     27%|##6       | 70196/262144 [00:09<00:26, 7187.62it/s]     27%|##7       | 70922/262144 [00:09<00:26, 7208.38it/s]     27%|##7       | 71648/262144 [00:10<00:26, 7223.13it/s]     28%|##7       | 72372/262144 [00:10<00:26, 7227.90it/s]     28%|##7       | 73096/262144 [00:10<00:26, 7227.03it/s]     28%|##8       | 73820/262144 [00:10<00:26, 7193.21it/s]     28%|##8       | 74542/262144 [00:10<00:26, 7200.12it/s]     29%|##8       | 75263/262144 [00:10<00:26, 7160.39it/s]     29%|##8       | 75984/262144 [00:10<00:25, 7174.61it/s]     29%|##9       | 76702/262144 [00:10<00:25, 7173.94it/s]     30%|##9       | 77427/262144 [00:10<00:25, 7195.89it/s]     30%|##9       | 78153/262144 [00:10<00:25, 7213.29it/s]     30%|###       | 78878/262144 [00:11<00:25, 7223.13it/s]     30%|###       | 79601/262144 [00:11<00:25, 7224.91it/s]     31%|###       | 80328/262144 [00:11<00:25, 7235.99it/s]     31%|###       | 81052/262144 [00:11<00:25, 7216.78it/s]     31%|###1      | 81779/262144 [00:11<00:24, 7232.46it/s]     31%|###1      | 82503/262144 [00:11<00:24, 7225.71it/s]     32%|###1      | 83233/262144 [00:11<00:24, 7247.35it/s]     32%|###2      | 83958/262144 [00:11<00:24, 7245.23it/s]     32%|###2      | 84683/262144 [00:11<00:27, 6410.87it/s]     33%|###2      | 85405/262144 [00:12<00:26, 6632.42it/s]     33%|###2      | 86127/262144 [00:12<00:25, 6796.98it/s]     33%|###3      | 86844/262144 [00:12<00:25, 6902.94it/s]     33%|###3      | 87563/262144 [00:12<00:24, 6983.58it/s]     34%|###3      | 88284/262144 [00:12<00:24, 7048.23it/s]     34%|###3      | 89007/262144 [00:12<00:24, 7100.54it/s]     34%|###4      | 89726/262144 [00:12<00:24, 7124.11it/s]     35%|###4      | 90445/262144 [00:12<00:24, 7143.01it/s]     35%|###4      | 91166/262144 [00:12<00:23, 7162.73it/s]     35%|###5      | 91890/262144 [00:12<00:23, 7183.15it/s]     35%|###5      | 92613/262144 [00:13<00:23, 7194.44it/s]     36%|###5      | 93333/262144 [00:13<00:23, 7194.57it/s]     36%|###5      | 94054/262144 [00:13<00:23, 7197.31it/s]     36%|###6      | 94778/262144 [00:13<00:23, 7209.66it/s]     36%|###6      | 95500/262144 [00:13<00:23, 7209.69it/s]     37%|###6      | 96225/262144 [00:13<00:22, 7221.52it/s]     37%|###6      | 96948/262144 [00:13<00:22, 7205.06it/s]     37%|###7      | 97673/262144 [00:13<00:22, 7216.24it/s]     38%|###7      | 98395/262144 [00:13<00:22, 7202.26it/s]     38%|###7      | 99118/262144 [00:13<00:22, 7207.62it/s]     38%|###8      | 99839/262144 [00:14<00:22, 7199.51it/s]     38%|###8      | 100564/262144 [00:14<00:22, 7212.64it/s]     39%|###8      | 101288/262144 [00:14<00:22, 7220.09it/s]     39%|###8      | 102015/262144 [00:14<00:22, 7232.92it/s]     39%|###9      | 102739/262144 [00:14<00:22, 7221.36it/s]     39%|###9      | 103462/262144 [00:14<00:21, 7214.88it/s]     40%|###9      | 104184/262144 [00:14<00:21, 7201.31it/s]     40%|####      | 104905/262144 [00:14<00:24, 6446.01it/s]     40%|####      | 105629/262144 [00:14<00:23, 6665.03it/s]     41%|####      | 106351/262144 [00:14<00:22, 6819.97it/s]     41%|####      | 107078/262144 [00:15<00:22, 6946.90it/s]     41%|####1     | 107803/262144 [00:15<00:21, 7034.11it/s]     41%|####1     | 108521/262144 [00:15<00:21, 7075.63it/s]     42%|####1     | 109233/262144 [00:15<00:21, 7034.87it/s]     42%|####1     | 109958/262144 [00:15<00:21, 7096.13it/s]     42%|####2     | 110670/262144 [00:15<00:21, 7097.83it/s]     42%|####2     | 111389/262144 [00:15<00:21, 7123.85it/s]     43%|####2     | 112113/262144 [00:15<00:20, 7157.16it/s]     43%|####3     | 112838/262144 [00:15<00:20, 7182.79it/s]     43%|####3     | 113562/262144 [00:15<00:20, 7198.46it/s]     44%|####3     | 114286/262144 [00:16<00:20, 7209.45it/s]     44%|####3     | 115011/262144 [00:16<00:20, 7218.57it/s]     44%|####4     | 115739/262144 [00:16<00:20, 7234.65it/s]     44%|####4     | 116463/262144 [00:16<00:20, 7210.85it/s]     45%|####4     | 117185/262144 [00:16<00:20, 7210.09it/s]     45%|####4     | 117907/262144 [00:16<00:19, 7213.00it/s]     45%|####5     | 118631/262144 [00:16<00:19, 7218.65it/s]     46%|####5     | 119353/262144 [00:16<00:19, 7214.75it/s]     46%|####5     | 120075/262144 [00:16<00:19, 7208.56it/s]     46%|####6     | 120798/262144 [00:16<00:19, 7214.52it/s]     46%|####6     | 121520/262144 [00:17<00:20, 6978.75it/s]     47%|####6     | 122228/262144 [00:17<00:19, 7006.25it/s]     47%|####6     | 122958/262144 [00:17<00:19, 7091.31it/s]     47%|####7     | 123684/262144 [00:17<00:19, 7140.58it/s]     47%|####7     | 124399/262144 [00:17<00:20, 6683.32it/s]     48%|####7     | 125074/262144 [00:17<00:20, 6536.27it/s]     48%|####7     | 125805/262144 [00:17<00:20, 6753.26it/s]     48%|####8     | 126532/262144 [00:17<00:19, 6900.91it/s]     49%|####8     | 127255/262144 [00:17<00:19, 6995.65it/s]     49%|####8     | 127976/262144 [00:18<00:19, 7056.63it/s]     49%|####9     | 128699/262144 [00:18<00:18, 7106.12it/s]     49%|####9     | 129422/262144 [00:18<00:18, 7142.00it/s]     50%|####9     | 130138/262144 [00:18<00:18, 7146.65it/s]     50%|####9     | 130857/262144 [00:18<00:18, 7158.78it/s]     50%|#####     | 131579/262144 [00:18<00:18, 7174.97it/s]     50%|#####     | 132297/262144 [00:18<00:18, 7175.80it/s]     51%|#####     | 133016/262144 [00:18<00:17, 7179.31it/s]     51%|#####1    | 133739/262144 [00:18<00:17, 7194.02it/s]     51%|#####1    | 134463/262144 [00:18<00:17, 7205.25it/s]     52%|#####1    | 135184/262144 [00:19<00:17, 7205.12it/s]     52%|#####1    | 135909/262144 [00:19<00:17, 7216.57it/s]     52%|#####2    | 136634/262144 [00:19<00:17, 7224.71it/s]     52%|#####2    | 137359/262144 [00:19<00:17, 7231.71it/s]     53%|#####2    | 138084/262144 [00:19<00:17, 7234.70it/s]     53%|#####2    | 138812/262144 [00:19<00:17, 7245.55it/s]     53%|#####3    | 139537/262144 [00:19<00:16, 7240.19it/s]     54%|#####3    | 140262/262144 [00:19<00:16, 7232.39it/s]     54%|#####3    | 140986/262144 [00:19<00:16, 7172.02it/s]     54%|#####4    | 141704/262144 [00:19<00:16, 7154.36it/s]     54%|#####4    | 142424/262144 [00:20<00:16, 7165.63it/s]     55%|#####4    | 143148/262144 [00:20<00:16, 7186.57it/s]     55%|#####4    | 143871/262144 [00:20<00:16, 7196.62it/s]     55%|#####5    | 144591/262144 [00:20<00:18, 6427.01it/s]     55%|#####5    | 145308/262144 [00:20<00:17, 6630.52it/s]     56%|#####5    | 146020/262144 [00:20<00:17, 6767.84it/s]     56%|#####5    | 146707/262144 [00:20<00:16, 6791.36it/s]     56%|#####6    | 147425/262144 [00:20<00:16, 6904.31it/s]     57%|#####6    | 148145/262144 [00:20<00:16, 6990.10it/s]     57%|#####6    | 148870/262144 [00:20<00:16, 7065.82it/s]     57%|#####7    | 149596/262144 [00:21<00:15, 7121.50it/s]     57%|#####7    | 150320/262144 [00:21<00:15, 7154.94it/s]     58%|#####7    | 151043/262144 [00:21<00:15, 7176.59it/s]     58%|#####7    | 151762/262144 [00:21<00:15, 7178.54it/s]     58%|#####8    | 152481/262144 [00:21<00:15, 7172.32it/s]     58%|#####8    | 153206/262144 [00:21<00:15, 7194.56it/s]     59%|#####8    | 153930/262144 [00:21<00:15, 7207.00it/s]     59%|#####8    | 154653/262144 [00:21<00:14, 7212.74it/s]     59%|#####9    | 155375/262144 [00:21<00:15, 7013.58it/s]     60%|#####9    | 156088/262144 [00:21<00:15, 7047.22it/s]     60%|#####9    | 156808/262144 [00:22<00:14, 7090.05it/s]     60%|######    | 157525/262144 [00:22<00:14, 7111.79it/s]     60%|######    | 158251/262144 [00:22<00:14, 7154.41it/s]     61%|######    | 158967/262144 [00:22<00:14, 6932.30it/s]     61%|######    | 159689/262144 [00:22<00:14, 7014.89it/s]     61%|######1   | 160410/262144 [00:22<00:14, 7071.61it/s]     61%|######1   | 161136/262144 [00:22<00:14, 7126.99it/s]     62%|######1   | 161859/262144 [00:22<00:14, 7156.60it/s]     62%|######2   | 162577/262144 [00:22<00:13, 7163.34it/s]     62%|######2   | 163301/262144 [00:22<00:13, 7183.35it/s]     63%|######2   | 164026/262144 [00:23<00:13, 7203.09it/s]     63%|######2   | 164747/262144 [00:23<00:15, 6437.34it/s]     63%|######3   | 165473/262144 [00:23<00:14, 6663.37it/s]     63%|######3   | 166198/262144 [00:23<00:14, 6827.28it/s]     64%|######3   | 166923/262144 [00:23<00:13, 6947.12it/s]     64%|######3   | 167646/262144 [00:23<00:13, 7029.30it/s]     64%|######4   | 168372/262144 [00:23<00:13, 7096.07it/s]     65%|######4   | 169096/262144 [00:23<00:13, 7135.81it/s]     65%|######4   | 169823/262144 [00:23<00:12, 7173.46it/s]     65%|######5   | 170549/262144 [00:24<00:12, 7196.44it/s]     65%|######5   | 171277/262144 [00:24<00:12, 7220.10it/s]     66%|######5   | 172001/262144 [00:24<00:12, 7225.72it/s]     66%|######5   | 172725/262144 [00:24<00:12, 7219.75it/s]     66%|######6   | 173448/262144 [00:24<00:12, 7211.93it/s]     66%|######6   | 174173/262144 [00:24<00:12, 7220.63it/s]     67%|######6   | 174898/262144 [00:24<00:12, 7226.46it/s]     67%|######6   | 175622/262144 [00:24<00:11, 7229.28it/s]     67%|######7   | 176346/262144 [00:24<00:11, 7231.16it/s]     68%|######7   | 177070/262144 [00:24<00:11, 7232.95it/s]     68%|######7   | 177794/262144 [00:25<00:11, 7232.14it/s]     68%|######8   | 178518/262144 [00:25<00:11, 7231.09it/s]     68%|######8   | 179242/262144 [00:25<00:11, 7232.52it/s]     69%|######8   | 179966/262144 [00:25<00:11, 7172.14it/s]     69%|######8   | 180686/262144 [00:25<00:11, 7178.54it/s]     69%|######9   | 181409/262144 [00:25<00:11, 7188.44it/s]     69%|######9   | 182128/262144 [00:25<00:11, 7167.24it/s]     70%|######9   | 182854/262144 [00:25<00:11, 7192.34it/s]     70%|#######   | 183575/262144 [00:25<00:10, 7193.59it/s]     70%|#######   | 184297/262144 [00:25<00:10, 7200.70it/s]     71%|#######   | 185018/262144 [00:26<00:11, 6441.79it/s]     71%|#######   | 185743/262144 [00:26<00:11, 6663.41it/s]     71%|#######1  | 186463/262144 [00:26<00:11, 6815.28it/s]     71%|#######1  | 187174/262144 [00:26<00:10, 6898.66it/s]     72%|#######1  | 187889/262144 [00:26<00:10, 6970.66it/s]     72%|#######1  | 188604/262144 [00:26<00:10, 7021.21it/s]     72%|#######2  | 189320/262144 [00:26<00:10, 7059.31it/s]     72%|#######2  | 190039/262144 [00:26<00:10, 7095.85it/s]     73%|#######2  | 190758/262144 [00:26<00:10, 7122.15it/s]     73%|#######3  | 191476/262144 [00:26<00:09, 7137.94it/s]     73%|#######3  | 192193/262144 [00:27<00:09, 7146.90it/s]     74%|#######3  | 192910/262144 [00:27<00:09, 7151.17it/s]     74%|#######3  | 193627/262144 [00:27<00:09, 7154.15it/s]     74%|#######4  | 194343/262144 [00:27<00:09, 7141.73it/s]     74%|#######4  | 195059/262144 [00:27<00:09, 7147.12it/s]     75%|#######4  | 195774/262144 [00:27<00:09, 6903.08it/s]     75%|#######4  | 196477/262144 [00:27<00:09, 6939.73it/s]     75%|#######5  | 197196/262144 [00:27<00:09, 7011.99it/s]     76%|#######5  | 197919/262144 [00:27<00:09, 7073.44it/s]     76%|#######5  | 198641/262144 [00:27<00:08, 7114.15it/s]     76%|#######6  | 199362/262144 [00:28<00:08, 7141.32it/s]     76%|#######6  | 200084/262144 [00:28<00:08, 7162.59it/s]     77%|#######6  | 200805/262144 [00:28<00:08, 7175.12it/s]     77%|#######6  | 201528/262144 [00:28<00:08, 7188.75it/s]     77%|#######7  | 202248/262144 [00:28<00:08, 7189.19it/s]     77%|#######7  | 202968/262144 [00:28<00:08, 7184.07it/s]     78%|#######7  | 203687/262144 [00:28<00:08, 7177.15it/s]     78%|#######7  | 204405/262144 [00:28<00:08, 6951.17it/s]     78%|#######8  | 205102/262144 [00:28<00:08, 6471.12it/s]     79%|#######8  | 205818/262144 [00:29<00:08, 6662.76it/s]     79%|#######8  | 206541/262144 [00:29<00:08, 6823.91it/s]     79%|#######9  | 207264/262144 [00:29<00:07, 6940.13it/s]     79%|#######9  | 207985/262144 [00:29<00:07, 7017.35it/s]     80%|#######9  | 208707/262144 [00:29<00:07, 7076.53it/s]     80%|#######9  | 209427/262144 [00:29<00:07, 7111.76it/s]     80%|########  | 210148/262144 [00:29<00:07, 7138.31it/s]     80%|########  | 210867/262144 [00:29<00:07, 7152.42it/s]     81%|########  | 211586/262144 [00:29<00:07, 7161.02it/s]     81%|########  | 212307/262144 [00:29<00:06, 7173.43it/s]     81%|########1 | 213029/262144 [00:30<00:06, 7186.01it/s]     82%|########1 | 213750/262144 [00:30<00:06, 7190.39it/s]     82%|########1 | 214470/262144 [00:30<00:06, 7189.43it/s]     82%|########2 | 215190/262144 [00:30<00:06, 7152.54it/s]     82%|########2 | 215906/262144 [00:30<00:06, 7142.30it/s]     83%|########2 | 216624/262144 [00:30<00:06, 7152.82it/s]     83%|########2 | 217341/262144 [00:30<00:06, 7155.72it/s]     83%|########3 | 218062/262144 [00:30<00:06, 7171.11it/s]     83%|########3 | 218782/262144 [00:30<00:06, 7179.22it/s]     84%|########3 | 219503/262144 [00:30<00:05, 7185.64it/s]     84%|########4 | 220222/262144 [00:31<00:05, 7184.69it/s]     84%|########4 | 220943/262144 [00:31<00:05, 7191.83it/s]     85%|########4 | 221665/262144 [00:31<00:05, 7197.44it/s]     85%|########4 | 222385/262144 [00:31<00:05, 7193.84it/s]     85%|########5 | 223105/262144 [00:31<00:05, 7185.53it/s]     85%|########5 | 223824/262144 [00:31<00:05, 7177.65it/s]     86%|########5 | 224542/262144 [00:31<00:05, 6687.50it/s]     86%|########5 | 225218/262144 [00:31<00:05, 6495.34it/s]     86%|########6 | 225873/262144 [00:31<00:05, 6500.50it/s]     86%|########6 | 226589/262144 [00:31<00:05, 6686.87it/s]     87%|########6 | 227310/262144 [00:32<00:05, 6838.98it/s]     87%|########6 | 228029/262144 [00:32<00:04, 6940.28it/s]     87%|########7 | 228748/262144 [00:32<00:04, 7013.15it/s]     88%|########7 | 229469/262144 [00:32<00:04, 7070.12it/s]     88%|########7 | 230190/262144 [00:32<00:04, 7111.43it/s]     88%|########8 | 230909/262144 [00:32<00:04, 7133.95it/s]     88%|########8 | 231636/262144 [00:32<00:04, 7173.18it/s]     89%|########8 | 232363/262144 [00:32<00:04, 7200.03it/s]     89%|########8 | 233084/262144 [00:32<00:04, 7044.90it/s]     89%|########9 | 233799/262144 [00:32<00:04, 7075.71it/s]     89%|########9 | 234518/262144 [00:33<00:03, 7107.72it/s]     90%|########9 | 235237/262144 [00:33<00:03, 7129.66it/s]     90%|######### | 235955/262144 [00:33<00:03, 7143.80it/s]     90%|######### | 236675/262144 [00:33<00:03, 7159.67it/s]     91%|######### | 237394/262144 [00:33<00:03, 7167.53it/s]     91%|######### | 238111/262144 [00:33<00:03, 7163.22it/s]     91%|#########1| 238833/262144 [00:33<00:03, 7177.24it/s]     91%|#########1| 239555/262144 [00:33<00:03, 7187.63it/s]     92%|#########1| 240274/262144 [00:33<00:03, 7187.73it/s]     92%|#########1| 240994/262144 [00:33<00:02, 7190.81it/s]     92%|#########2| 241720/262144 [00:34<00:02, 7211.03it/s]     92%|#########2| 242442/262144 [00:34<00:02, 7209.81it/s]     93%|#########2| 243165/262144 [00:34<00:02, 7213.59it/s]     93%|#########3| 243887/262144 [00:34<00:02, 7208.49it/s]     93%|#########3| 244608/262144 [00:34<00:02, 6559.28it/s]     94%|#########3| 245278/262144 [00:34<00:02, 6597.68it/s]     94%|#########3| 246001/262144 [00:34<00:02, 6777.40it/s]     94%|#########4| 246722/262144 [00:34<00:02, 6902.38it/s]     94%|#########4| 247442/262144 [00:34<00:02, 6987.41it/s]     95%|#########4| 248162/262144 [00:35<00:01, 7049.18it/s]     95%|#########4| 248881/262144 [00:35<00:01, 7089.07it/s]     95%|#########5| 249603/262144 [00:35<00:01, 7125.93it/s]     95%|#########5| 250317/262144 [00:35<00:01, 7124.02it/s]     96%|#########5| 251032/262144 [00:35<00:01, 7129.77it/s]     96%|#########6| 251756/262144 [00:35<00:01, 7160.73it/s]     96%|#########6| 252476/262144 [00:35<00:01, 7172.36it/s]     97%|#########6| 253199/262144 [00:35<00:01, 7186.83it/s]     97%|#########6| 253920/262144 [00:35<00:01, 7191.98it/s]     97%|#########7| 254640/262144 [00:35<00:01, 7191.20it/s]     97%|#########7| 255360/262144 [00:36<00:00, 7189.58it/s]     98%|#########7| 256082/262144 [00:36<00:00, 7195.81it/s]     98%|#########7| 256802/262144 [00:36<00:00, 7196.14it/s]     98%|#########8| 257522/262144 [00:36<00:00, 7187.74it/s]     99%|#########8| 258241/262144 [00:36<00:00, 7164.22it/s]     99%|#########8| 258959/262144 [00:36<00:00, 7166.87it/s]     99%|#########9| 259676/262144 [00:36<00:00, 7138.80it/s]     99%|#########9| 260394/262144 [00:36<00:00, 7148.14it/s]    100%|#########9| 261113/262144 [00:36<00:00, 7160.52it/s]    100%|#########9| 261832/262144 [00:36<00:00, 7166.78it/s]    100%|#########9| 262143/262144 [00:36<00:00, 7094.80it/s]




.. GENERATED FROM PYTHON SOURCE LINES 205-216

Evaluating the Analog State Vector in Between Control Signal Samples
--------------------------------------------------------------------

If we wish to simulate the analog state vector trajectory between
control updates, this can be achieved using the Ts parameter of the
:py:class:`cbadc.simulator.StateSpaceSimulator`. Technically you can scale
:math:`T_s = T / \alpha` for any positive number :math:`\alpha`. For such a
scaling, the simulator will generate :math:`\alpha` more control signals per
unit of time. However, digital control is still restricted to only update
the control signals at multiples of :math:`T`.


.. GENERATED FROM PYTHON SOURCE LINES 216-275

.. code-block:: default


    # Set sampling time three orders of magnitude smaller than the control period
    Ts = T / 100.0
    # Instantiate a corresponding clock
    observation_clock = cbadc.analog_signal.Clock(Ts)

    # Simulate for 65536 control cycles.
    size = 1 << 16

    # Initialize a new digital control.
    new_digital_control = cbadc.digital_control.DigitalControl(clock, M)

    # Instantiate a new simulator with a sampling time.
    simulator = cbadc.simulator.AnalyticalSimulator(
        analog_system, new_digital_control, [analog_signal], observation_clock
    )

    # Create data containers to hold the resulting data.
    time_vector = np.arange(size) * Ts / T
    states = np.zeros((N, size))
    control_signals = np.zeros((M, size), dtype=np.int8)

    # Iterate through and store states and control_signals.
    simulator = cbadc.simulator.extended_simulation_result(simulator)
    for index in cbadc.utilities.show_status(range(size)):
        res = next(simulator)
        states[:, index] = res["analog_state"]
        control_signals[:, index] = res["control_signal"]

    # Plot all analog state evolutions.
    plt.figure()
    plt.title("Analog state vectors")
    for index in range(N):
        plt.plot(time_vector, states[index, :], label=f"$x_{index + 1}(t)$")
    plt.grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    plt.xlabel("$t/T$")
    plt.xlim((0, 10))
    plt.legend()

    # reset figure size and plot individual results.
    plt.rcParams["figure.figsize"] = [6.40, 6.40 * 2]
    fig, ax = plt.subplots(N, 2)
    for index in range(N):
        color = next(ax[0, 0]._get_lines.prop_cycler)["color"]
        ax[index, 0].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
        ax[index, 1].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
        ax[index, 0].plot(time_vector, states[index, :], color=color)
        ax[index, 1].plot(time_vector, control_signals[index, :],
                          "--", color=color)
        ax[index, 0].set_ylabel(f"$x_{index + 1}(t)$")
        ax[index, 1].set_ylabel(f"$s_{index + 1}(t)$")
        ax[index, 0].set_xlim((0, 15))
        ax[index, 1].set_xlim((0, 15))
        ax[index, 0].set_ylim((-1, 1))
    fig.suptitle("Analog state and control contribution evolution")
    ax[-1, 0].set_xlabel("$t / T$")
    ax[-1, 1].set_xlabel("$t / T$")
    fig.tight_layout()




.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /tutorials/a_getting_started/images/sphx_glr_plot_b_simulate_a_control_bounded_adc_001.png
         :alt: Analog state vectors
         :srcset: /tutorials/a_getting_started/images/sphx_glr_plot_b_simulate_a_control_bounded_adc_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /tutorials/a_getting_started/images/sphx_glr_plot_b_simulate_a_control_bounded_adc_002.png
         :alt: Analog state and control contribution evolution
         :srcset: /tutorials/a_getting_started/images/sphx_glr_plot_b_simulate_a_control_bounded_adc_002.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Not yet implemented.
      0%|          | 0/65536 [00:00<?, ?it/s]      1%|1         | 778/65536 [00:00<00:08, 7778.97it/s]      2%|2         | 1570/65536 [00:00<00:08, 7860.33it/s]      4%|3         | 2366/65536 [00:00<00:07, 7902.58it/s]      5%|4         | 3164/65536 [00:00<00:07, 7930.58it/s]      6%|6         | 3958/65536 [00:00<00:08, 7206.93it/s]      7%|7         | 4689/65536 [00:00<00:08, 7017.46it/s]      8%|8         | 5487/65536 [00:00<00:08, 7310.23it/s]     10%|9         | 6284/65536 [00:00<00:07, 7508.41it/s]     11%|#         | 7073/65536 [00:00<00:07, 7623.53it/s]     12%|#1        | 7862/65536 [00:01<00:07, 7703.13it/s]     13%|#3        | 8652/65536 [00:01<00:07, 7760.10it/s]     14%|#4        | 9441/65536 [00:01<00:07, 7797.16it/s]     16%|#5        | 10231/65536 [00:01<00:07, 7827.39it/s]     17%|#6        | 11021/65536 [00:01<00:06, 7848.97it/s]     18%|#8        | 11807/65536 [00:01<00:06, 7813.47it/s]     19%|#9        | 12599/65536 [00:01<00:06, 7844.95it/s]     20%|##        | 13385/65536 [00:01<00:06, 7846.70it/s]     22%|##1       | 14178/65536 [00:01<00:06, 7868.74it/s]     23%|##2       | 14966/65536 [00:01<00:06, 7865.86it/s]     24%|##4       | 15760/65536 [00:02<00:06, 7887.92it/s]     25%|##5       | 16550/65536 [00:02<00:06, 7890.78it/s]     26%|##6       | 17340/65536 [00:02<00:06, 7886.46it/s]     28%|##7       | 18130/65536 [00:02<00:06, 7887.54it/s]     29%|##8       | 18919/65536 [00:02<00:06, 7526.72it/s]     30%|###       | 19676/65536 [00:02<00:06, 6863.40it/s]     31%|###1      | 20464/65536 [00:02<00:06, 7141.37it/s]     32%|###2      | 21256/65536 [00:02<00:06, 7358.34it/s]     34%|###3      | 22047/65536 [00:02<00:05, 7514.82it/s]     35%|###4      | 22840/65536 [00:02<00:05, 7632.74it/s]     36%|###6      | 23630/65536 [00:03<00:05, 7710.15it/s]     37%|###7      | 24414/65536 [00:03<00:05, 7746.34it/s]     38%|###8      | 25198/65536 [00:03<00:05, 7773.81it/s]     40%|###9      | 25990/65536 [00:03<00:05, 7814.48it/s]     41%|####      | 26781/65536 [00:03<00:04, 7840.80it/s]     42%|####2     | 27572/65536 [00:03<00:04, 7861.22it/s]     43%|####3     | 28362/65536 [00:03<00:04, 7871.58it/s]     44%|####4     | 29153/65536 [00:03<00:04, 7882.60it/s]     46%|####5     | 29945/65536 [00:03<00:04, 7892.14it/s]     47%|####6     | 30735/65536 [00:03<00:04, 7890.00it/s]     48%|####8     | 31527/65536 [00:04<00:04, 7896.69it/s]     49%|####9     | 32319/65536 [00:04<00:04, 7903.04it/s]     51%|#####     | 33110/65536 [00:04<00:04, 7904.96it/s]     52%|#####1    | 33901/65536 [00:04<00:04, 7746.66it/s]     53%|#####2    | 34677/65536 [00:04<00:04, 6938.81it/s]     54%|#####4    | 35461/65536 [00:04<00:04, 7183.61it/s]     55%|#####5    | 36251/65536 [00:04<00:03, 7385.04it/s]     57%|#####6    | 37041/65536 [00:04<00:03, 7532.43it/s]     58%|#####7    | 37823/65536 [00:04<00:03, 7614.64it/s]     59%|#####8    | 38609/65536 [00:05<00:03, 7683.92it/s]     60%|######    | 39401/65536 [00:05<00:03, 7752.49it/s]     61%|######1   | 40191/65536 [00:05<00:03, 7796.18it/s]     63%|######2   | 40983/65536 [00:05<00:03, 7830.70it/s]     64%|######3   | 41774/65536 [00:05<00:03, 7853.72it/s]     65%|######4   | 42561/65536 [00:05<00:02, 7856.85it/s]     66%|######6   | 43352/65536 [00:05<00:02, 7872.17it/s]     67%|######7   | 44144/65536 [00:05<00:02, 7885.35it/s]     69%|######8   | 44936/65536 [00:05<00:02, 7893.20it/s]     70%|######9   | 45726/65536 [00:05<00:02, 7883.36it/s]     71%|#######   | 46515/65536 [00:06<00:02, 7883.18it/s]     72%|#######2  | 47308/65536 [00:06<00:02, 7896.67it/s]     73%|#######3  | 48098/65536 [00:06<00:02, 7892.54it/s]     75%|#######4  | 48890/65536 [00:06<00:02, 7900.37it/s]     76%|#######5  | 49681/65536 [00:06<00:02, 6944.09it/s]     77%|#######7  | 50470/65536 [00:06<00:02, 7202.35it/s]     78%|#######8  | 51262/65536 [00:06<00:01, 7402.01it/s]     79%|#######9  | 52057/65536 [00:06<00:01, 7556.57it/s]     81%|########  | 52853/65536 [00:06<00:01, 7672.39it/s]     82%|########1 | 53649/65536 [00:06<00:01, 7755.17it/s]     83%|########3 | 54442/65536 [00:07<00:01, 7804.98it/s]     84%|########4 | 55240/65536 [00:07<00:01, 7854.09it/s]     85%|########5 | 56032/65536 [00:07<00:01, 7871.75it/s]     87%|########6 | 56830/65536 [00:07<00:01, 7902.24it/s]     88%|########7 | 57626/65536 [00:07<00:00, 7916.97it/s]     89%|########9 | 58419/65536 [00:07<00:00, 7920.51it/s]     90%|######### | 59212/65536 [00:07<00:00, 7910.82it/s]     92%|#########1| 60004/65536 [00:07<00:00, 7909.42it/s]     93%|#########2| 60797/65536 [00:07<00:00, 7913.11it/s]     94%|#########3| 61589/65536 [00:07<00:00, 7914.50it/s]     95%|#########5| 62381/65536 [00:08<00:00, 7905.09it/s]     96%|#########6| 63172/65536 [00:08<00:00, 7871.68it/s]     98%|#########7| 63960/65536 [00:08<00:00, 7856.40it/s]     99%|#########8| 64750/65536 [00:08<00:00, 7866.88it/s]    100%|##########| 65536/65536 [00:08<00:00, 7718.07it/s]
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:250: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      plt.grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:260: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[index, 0].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:261: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[index, 1].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:260: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[index, 0].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:261: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[index, 1].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:260: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[index, 0].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:261: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[index, 1].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:260: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[index, 0].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:261: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[index, 1].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:260: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[index, 0].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:261: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[index, 1].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:260: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[index, 0].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:261: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[index, 1].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)




.. GENERATED FROM PYTHON SOURCE LINES 276-283

Analog State Statistics
------------------------------------------------------------------

As in the previous section, visualizing the analog state trajectory is a
good way of identifying problems and possible errors. Another way of making
sure that the analog states remain bounded is to estimate their
corresponding densities (assuming i.i.d samples).

.. GENERATED FROM PYTHON SOURCE LINES 283-304

.. code-block:: default


    # Compute L_2 norm of analog state vector.
    L_2_norm = np.linalg.norm(states, ord=2, axis=0)
    # Similarly, compute L_infty (largest absolute value) of the analog state
    # vector.
    L_infty_norm = np.linalg.norm(states, ord=np.inf, axis=0)

    # Estimate and plot densities using matplotlib tools.
    bins = 150
    plt.rcParams["figure.figsize"] = [6.40, 4.80]
    fig, ax = plt.subplots(2, sharex=True)
    ax[0].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    ax[1].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    ax[0].hist(L_2_norm, bins=bins, density=True)
    ax[1].hist(L_infty_norm, bins=bins, density=True, color="orange")
    plt.suptitle("Estimated probability densities")
    ax[0].set_xlabel("$\|\mathbf{x}(t)\|_2$")
    ax[1].set_xlabel("$\|\mathbf{x}(t)\|_\infty$")
    ax[0].set_ylabel("$p ( \| \mathbf{x}(t) \|_2 ) $")
    ax[1].set_ylabel("$p ( \| \mathbf{x}(t) \|_\infty )$")
    fig.tight_layout()



.. image-sg:: /tutorials/a_getting_started/images/sphx_glr_plot_b_simulate_a_control_bounded_adc_003.png
   :alt: Estimated probability densities
   :srcset: /tutorials/a_getting_started/images/sphx_glr_plot_b_simulate_a_control_bounded_adc_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:294: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[0].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)
    /drives1/PhD/cbadc/docs/code_examples/a_getting_started/plot_b_simulate_a_control_bounded_adc.py:295: MatplotlibDeprecationWarning: The 'b' parameter of grid() has been renamed 'visible' since Matplotlib 3.5; support for the old name will be dropped two minor releases later.
      ax[1].grid(b=True, which="major", color="gray", alpha=0.6, lw=1.5)





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 2 minutes  43.539 seconds)


.. _sphx_glr_download_tutorials_a_getting_started_plot_b_simulate_a_control_bounded_adc.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_b_simulate_a_control_bounded_adc.py <plot_b_simulate_a_control_bounded_adc.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_b_simulate_a_control_bounded_adc.ipynb <plot_b_simulate_a_control_bounded_adc.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
